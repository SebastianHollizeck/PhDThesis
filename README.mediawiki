= Development of new methods for accurate estimation of tumour heterogeneity =

</span>

<div class="savequote">

“Begin at the beginning,“ the King said, very gravely, “and go on till you come to the end: then stop.“


</div>
<span id="ch:intro"></span>
= Introduction =

This first introduction chapter contains all the necessary background information as well as an overview for the work discussed in this thesis. It summarised basic biological properties of DNA and cell biology as well as the respective technologies to read, analyse and measure these biological concepts and then how to evaluate the output of these methods. [[#intro-sec:DNA|Section ]][[#intro-sec:DNA|1.1]] delineates the role DNA plays for the cell and then [[#intro-sec:ctDNA|section ]][[#intro-sec:ctDNA|1.2]] shows how these standards are changed in the tumour and cell free context. [[#intro-sec:sequencing|Section ]][[#intro-sec:sequencing|1.3]] introduces the current technologies used to measure and detect DNA and its variations. With [[#intro-sec:analysis|section ]][[#intro-sec:analysis|1.4]] covering the computational analysis methods to read out changes in the DNA. Then [[#intro-sec:lungcancer|section ]][[#intro-sec:lungcancer|3.1.1]] relates how these changes lead to cancer and what we can learn from them. The introduction concludes with [[#intro-sec:overview|section ]][[#intro-sec:overview|1.6]] as an overview over the thesis aims and my work in addressing them in the following chapters.

<span id="intro-sec:DNA"></span>
== DNA as a information storage unit ==

Overview of DNA structure and the nucleobases, which form DNA strands. Nucleotides are split into Purines and Pyrimidines by the structure of the nitrogen ring; complementary pairing of bases is shown as shapes of the bases as well as with 2D structures; Hyrdogen (H) bonds are shown as dotted lines; Phosphates are shown as P; 3’ and 5’ ends are defined by the internal number of the carbon atom of the sugar which is exposed; Adapted from “DNA structure“ by [https://biorender.com <code>BioRender.com</code>] (2021) Retrieved from [https://app.biorender.com/biorender-templates <code>https://app.biorender.com/biorender-templates</code>]

It is a widely accepted fact, that Deoxyribonucleic acid (DNA) serves as the long term information storage molecule of our cells. This information is protected and allows correction of simple errors through its double helix structure <span class="citation" cites="Watson1953 Liang1998">(Watson and Crick 1953; Liang et al. 1998)</span>. The nucleotides, which consist of a deoxyribose sugar (hence the name), a phosphate group and the nitrogenous base, are joined together by phosphate groups. Even though there are six common naturally occurring nitrogenous bases: Adenine (A), Thymine (T), Guanine (G), Cytosine (C), Uracil (U) and nicotinamide, only the first four are used to encode the genetic information into DNA. Each of the strands mirrors the other, so that an adenine will be paired up with a thymine forming two hydrogen bonds. Similarly, cytosine will pair with guanine forming an even stronger bond with three hydrogen bonds. While other pairings which do not follow those rules are chemically possible, they are mostly observed in ribonucleic acid (RNA) <span class="citation" cites="Sinden1994">(Sinden 1994)</span>. These very strict bonding rules enable the DNA to be similar to a hard drive with backup on a computer. And as only one strand contains all the information, the DNA polymerase enzyme does only need access to one strand, which allows parallel replication during cell division, but also error corrections, by proof reading the newly synthesised strand with the template. In order to be able to distinguish the two strands, they were assigned the names 3’ and 5’ depending on the numbering of the carbon atom in the sugar, which is exposed ([[#fig:DNAstructure|[fig:DNAstructure]]]).

The entirety of the DNA encoding the organism is commonly called “the genome“ with all genes, which consist of introns and exons are called exome. Unicellular organisms usually only have a very small amount of introns, which to current knowledge only provide limited information and are only responsible for structure. In vertebrates introns as well as intergeneic DNA (the DNA between genes) contribute most of the DNA in the genome. For example in humans, only [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%201%5C%25|class=math inline|1\%]] of the genetic material is considered to be exonic, whereas introns contribute [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Capprox%2024%5C%25|class=math inline|\approx 24\%]] and the rest is intergeneic ([[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Capprox%2075%5C%25|class=math inline|\approx 75\%]])<span class="citation" cites="Venter2001">(Venter et al. 2001)</span>.

Structural overview of the metaphase condensed chromosome: DNA is first wrapped around Histones to form nucleosome, which then associate with each other to form the chromatin fiber, which in the metaphase of the cell cycle is condensed even more into the X-shaped chromosome

The DNA in eukaryotes however is not free floating around in the nucleus of a cell, but rather in most eukrayotic organisms, it is highly condensed and structured, first wrapped around nucleosomes like thread on a spool, then organised around histones, into either open (accessible) or closed chromatin, which then can be even further condensed into chromosomes, which have a X-like shape, with two shorter and two longer arms ([[#fig:chromsomestructure|[fig:chromsomestructure]]]). This allows some DNA to be accessible where the use of other areas can be restricted<span class="citation" cites="Hammond2017">(Hammond et al. 2017)</span>. Through this restriction, the availability of certain genes, which are the sections of the DNA, which encode for short term storage molecules like RNA. This restriction plays an important role in cell fate and cell viability. Ultimately, all information stored to create a new highly complex organism is stored in just the DNA of one cell. Whichever parts are used and how they are used decides the function and the identity of the cell<span class="citation" cites="Bonev2016">(Bonev and Cavalli 2016)</span>.

<span id="intro-sec:ploidy"></span>
=== Ploidy - it is good to have a backup, if you do it right ===

Similar to the already discussed RAID-like setup of the DNA in two strands, another concept of data security, a spatial different storage is also implemented. Most eukaryotic organisms have at least two of each chromosome (diploid) with some species reaching up to septaploid<span class="citation" cites="Tateoka1975">(Tateoka 1975)</span>. However, this concept is not the only reason for the ploidy of somatic cells. For sexually reproducing organisms, at least a diploid set of chromosomes is necessary to enable information to be joined from both parents. Germline cells (sperm and egg) are generally monoploid, such that the resulting cell will be diploid, but the ploidy of the somatic cells is not as uniform within a species, where it can vary between organisms based on gender or rank <span class="citation" cites="Trivers1976">(Trivers and Hare 1976)</span>. In most organisms, a change in ploidy is fatal <span class="citation" cites="Otto2007">(Otto 2007)</span> and only partial ploidy changes like extra copies of chromosome 17 <span class="citation" cites="Gottlieb1962">(Gottlieb et al. 1962)</span>, chromosome 18 <span class="citation" cites="Cereda2012">(Cereda and Carey 2012)</span> and chromosome 21 <span class="citation" cites="Hulten2008">(Hultén et al. 2008)</span> are tolerated. These syndroms can occur when the is an uneven split of chromosomes during cell division. The additional advantage, apart from sexual reproduction, is that a second almost identical copy of a chromosome allows repair of DNA, even when both strands are damaged, for example in a double strand break. In this case, the information from the sister chromosome will be used, by first cutting the double strand break ends to have an overhang (resection). This overhang will then merge with the sister chromosome’s mirrored strand. In this state, the two chromosomes are fused together in a Holliday junction, which allows the missing part from the resection and the double strand break to be synthesised <span class="citation" cites="Lilley2000">(Lilley 2000)</span>. During this process, which is part of the homology directed repair (HDR) machinery, the sister chromosomes exchange parts of their DNA, when resolving the Holliday junction. As these stretches of DNA do not need to be 100% identical, this plays an important role in evolution and diversity <span class="citation" cites="Hanage2006 Kong2013">(Hanage, Fraser, and Spratt 2006; Kong et al. 2013)</span>.

Individual chromosomes occupy a subspace in the nucleus called chromosome territories. Chromosome territories can be further partitioned to distinct A and B compartments, which are enriched for active and repressed chromatin, respectively. Genomic regions within topologically associating domains (TADs) display increased interactions, while their interactions with neighbouring regions outside the TADs are rather limited.

Even though this X-like structure is the most commonly used and known structure, the DNAs 3D structure is usually very different and only takes this shape for the very short time of the cell cycle. Most of the time, the chromosomes are unravelled into something resembling a ball of yarn, where the “open“ chromatin regions are on the outside and the “closed“ regions are “hidden“ in the inside and each chromosome establishes its own “territory“ inside the nucleus ([[#fig:chromosometerretories|[fig:chromosometerretories]]]). This structure allows another DNA cross over with non-sister chromsomes, which is called a chiasma.

<span id="intro-sec:mutations"></span>
=== Phantastical mutations and where to find them ===

However even though the DNA is highly stable, and error correction methods are constantly working to not introduce any changes in the DNA, the source of evolution and adaptation of species is sourced in a steady mutation rate <span class="citation" cites="Darwin2010 Sprouffske2018">(Darwin 2010; Sprouffske et al. 2018)</span>. These changes in normal tissue are mostly irrelevant to the organism as a whole and will not be passed on to the next generation. These changes are known as somatic mutations. This type of mutation accumulates in a cell linearly over the course of the lifespan of the cell and is not bound to just cell divisions<span class="citation" cites="Alexandrov2015 Moore2021">(Ludmil B. Alexandrov et al. 2015; Moore et al. 2021)</span>. In contrast, if one of those mutations occurs in the germline cell, e.g. sperm or egg producing cells, these mutations will be propagated to all offspring and be present in all cells of that organism and in term all its offspring. These mutations are called germline mutations. These mutations are also called germline variants, as they establish in the population and represent a variation of the organism. Mutations can also be classified depending on either their size, ranging from single nucleotide polymorphisms (SNPs) over small insertions or deletions (InDels) to large structural changes, like the deletion of parts of or even a whole chromosome arm. Like previously described with ploidy changes, usually smaller changes have less impact on the overall fitness of the organism, however even SNPs can lead to changes which are not compatible with life<span class="citation" cites="Shamseldin2015 Frey2021">(Shamseldin et al. 2015; Frey et al. 2021)</span>.

<span id="intro-sec:ctDNA"></span>
== Cell free DNA is more than just bits and pieces ==

When a cell from a multicellular organism dies, through which ever method, there will be numerous enzymes involved, which clear the debris and recycle material. This means that proteases digest proteins into amino acids, which will later be used for either building new proteins or possibly even digested further for energy production. The same happens with the DNA in the cell. However, as discussed in the previous section [[#intro-sec:DNA|1.1]] the DNA is wrapped around histones and organised in structures called nuclesomes. These protect the DNA from being cut by DNAases by hindering the access to the DNA, similar to how they stopped the access for transcription into RNA. This then in turn leads to the DNA being cut into pieces mainly in the length of 167 base pairs (bp). These DNA fragments, which are called cell free DNA (cfDNA), can then be detected in bodily fluids, like blood or even stool. By analysing these fragments, non invasive tests for prenatal care have been possible, as the DNA of the foetus is detectable in the mother’s blood <span class="citation" cites="Dan2012 Nicolaides2013">(Dan et al. 2012; Nicolaides et al. 2013)</span>. Similar to the process, a cancer also sheds DNA, titled circulating tumour DNA (ctDNA), when its cells die, either through intervention of the immune system or through other forcefull processes. These ctDNA fragments can also be analysed and molecular properties measured, without even knowing the exact location of the tumour. As a blood test can be routinely performed in the clinic or even a general practitioner, the monitoring of cancer progression is significantly easier and safer than through other measures. Of course, it is, similar to the prenatal test, only a proxy for the cells which are still alive, as these have not shed their DNA. Additionally, the amount of shedded DNA is highly variable between tumours, with a general higher amount for later stages, so that sometimes there is almost no ctDNA present, even though the cancer is fairly advanced <span class="citation" cites="Diehl2008 Schwarzenbach2011">(Diehl et al. 2008; Schwarzenbach, Hoon, and Pantel 2011)</span>.

<span id="intro-sec:sequencing"></span>
== DNA sequencing - when is next generation sequencing the current generation? ==

As we know the building blocks, that make DNA as well as the process and the enzymes responsible, we can synthesise DNA in vitro. By chemically modifying the nucleotides supplied to the synthesis process, the sequence of the copied strand can be analysed. The first method to make use of this used the lambda phage to fuse known ends for the primers needed for the reaction to the piece of DNA and supplied labelled nucleotides <span class="citation" cites="Padmanabhan1974">(Padmanabhan, Jay, and Wu 1974)</span>. This method was then superseded by &quot;Sanger sequencing&quot; after Frederick Sanger who with colleagues published this method in 1977, by adding '''di'''deoxynucleotides in a low concentration, the polymerase chain reaction would terminate trying to integrate these nucleotides and by labelling them radioactively or florescently, a gel can be used to determine the sequence of a piece of DNA <span class="citation" cites="Sanger1975 Sanger1977">(Sanger and Coulson 1975; Sanger, Nicklen, and Coulson 1977)</span>, which made the method better suited for larger scale projects.

However, this method has multiple issues for modern research questions. Mostly, that it is fairly labour and time consuming to analyse multiple pieces of DNA at the same time, and it is very challenging to sequence all the DNA of an organism. The human genome project, which was started in 1990 used machines which automated the Sanger sequencing procedure and it still took hundreds of researchers 13 years to complete the DNA sequence of just one human <span class="citation" cites="Lander2001 Venter2001">(Lander et al. 2001; Venter et al. 2001)</span>. Even though this was a very long project, it laid the ground work for the usage of the current sequencing technologies.

<span id="intro-sec:libraryprep"></span>
=== Library preparation - what we learned from using phages ===

[[File:Figures/LibraryPreparation.png|thumb|none|alt=Adapter ligation during library preparation. The adapters are added to the DNA insert during library preparation. A. The DNA insert is prepared by adding an A-tail and phosphorylation. B. The adapter complex which includes the P5/P7 flow cell binding adapter is added to the DNA insert. C. The DNA insert is ready for sequencing. D. The DNA insert binds to the flow cell for sequencing. Primers bind to the DNA insert to generate reads;<br />
Figure adapted from [https://sapac.support.illumina.com/bulletins/2020/12/how-short-inserts-affect-sequencing-performance.html &quot;How short inserts affect sequencing performance&quot;]<span class="citation" cites="Illumina2020">(Illumina 2020)</span>|Adapter ligation during library preparation. The adapters are added to the DNA insert during library preparation. A. The DNA insert is prepared by adding an A-tail and phosphorylation. B. The adapter complex which includes the P5/P7 flow cell binding adapter is added to the DNA insert. C. The DNA insert is ready for sequencing. D. The DNA insert binds to the flow cell for sequencing. Primers bind to the DNA insert to generate reads;<br />
Figure adapted from [https://sapac.support.illumina.com/bulletins/2020/12/how-short-inserts-affect-sequencing-performance.html &quot;How short inserts affect sequencing performance&quot;]<span class="citation" cites="Illumina2020">(Illumina 2020)</span>]]

Library preparation is the name of the preprocessing step, which is done before it is sequenced with the current technologies. The first step to sequence DNA is to obtain the DNA, which is done by lysing the cells of interest, which disrupts the cell membrane and therefore spills all its contents. The then spilled DNA is fragmented into smaller pieces, by either restriction enzymes or sonication, to have a size of about between 200-800bp. These steps are not necessary when preparing sequencing of ctDNA, as discussed in [[#intro-sec:ctDNA|[intro-sec:ctDNA]]], the DNA is unbound and already digested into short fragments. Once the DNA is ready, it is phosphorelated and an A-tail is added, before the adapter complex is ligated. This enabled the DNA to bind to the flow cell which is covered with the reverse complement of the adapter ([[#fig:libraryprep|[fig:libraryprep]]]).

<span id="intro-sec:ngs"></span>
=== Next generation sequencing ===

[[File:Figures/SequencingBySynthesis.jpg|thumb|none|alt=The Illumina sequencing-by-synthesis approach. Cluster strands created by bridge amplification are primed and all four fluorescently labeled, 3’-OH blocked nucleotides are added to the flow cell with DNA polymerase. The cluster strands are extended by one nucleotide. Following the incorporation step, the unused nucleotides and DNA polymerase molecules are washed away, a scan buffer is added to the flow cell, and the optics system scans each lane of the flow cell by imaging units called tiles. Once imaging is completed, chemicals that effect cleavage of the fluorescent labels and the 3’-OH blocking groups are added to the flow cell, which prepares the cluster strands for another round of fluorescent nucleotide incorporation; Figure adapted from <span class="citation" cites="Mardis2008">Mardis (2008)</span><span class="citation" cites="Mardis2008">(Mardis 2008)</span>|The Illumina sequencing-by-synthesis approach. Cluster strands created by bridge amplification are primed and all four fluorescently labeled, 3’-OH blocked nucleotides are added to the flow cell with DNA polymerase. The cluster strands are extended by one nucleotide. Following the incorporation step, the unused nucleotides and DNA polymerase molecules are washed away, a scan buffer is added to the flow cell, and the optics system scans each lane of the flow cell by imaging units called tiles. Once imaging is completed, chemicals that effect cleavage of the fluorescent labels and the 3’-OH blocking groups are added to the flow cell, which prepares the cluster strands for another round of fluorescent nucleotide incorporation; Figure adapted from <span class="citation" cites="Mardis2008">Mardis (2008)</span><span class="citation" cites="Mardis2008">(Mardis 2008)</span>]]

Next generation sequencing (NGS)is the coined term for basically any standard high-throughput sequencing performed, which includes exome, genome, transcriptome, protein-dna interactions (ChIP) and other epigenome studies. The term NGS is still widely used, even though it has been more than 10 years since the first NGS approach was commercially available. While in the beginning of next generation sequencing there were multiple approaches, the current lion share (80% of sequencing data) of protocols use the Illumina short read sequencing by synthesis approach ([[#fig:sequencingbysynthesis|[fig:sequencingbysynthesis]]])<span class="citation" cites="Mardis2008 Straiton2019">(Mardis 2008; Straiton et al. 2019)</span>, which is based on the concept of alternating integration of florescently labelled nucleotides and imaging with a microscope ([[#fig:sequencingbysynthesis|[fig:sequencingbysynthesis]]]) as well as multiplexing, where a DNA fragment is ligated to an index, which allow to sequence multiple samples at once <span class="citation" cites="Church1984 Church1988">(G. M. Church and Gilbert 1984; G. Church and Kieffer-Higgins 1988)</span> as it is shown in [[#fig:libraryprep|[fig:libraryprep]]]. This method allows highly accurate determination of the sequence of a DNA fragment and depending on the flow cell and sequencing machine allows to sequence a whole genome in just 24h.

<span id="intro-sec:lrs"></span>
=== Long read sequencing - the &quot;third&quot; generation sequencing ===

By now, multiple methods which broke free of the size limitations of NGS exist, which are commonly referred to as long read sequencing. Most of the current methods trade the very high accuracy of the second generation NGS methods for the capability of sequencing huge continuous strands of DNA (current record 2.3 Million bp <span class="citation" cites="Payne2018">(Payne et al. 2018)</span>) with normal library preparation ranging between 10-30 Kbp. These methods are expected to revolutionise our understanding of the highly repetitive elements that exist in the genome, such as the centromeres of chromosomes. Methods such as the direct molecule sequencing approach by Oxford Nanopore are even able to distinguish post transcriptional modifications on RNA<span class="citation" cites="Pratanwanich2021">(Pratanwanich et al. 2021)</span>. So far, these methods however are still very expensive and as this work is dealing with ctDNA, which is highly fragmented, these methods offer only limited advantages over the short read sequencing, while being much more expensive.

<span id="intro-sec:analysis"></span>
== DNA analysis - what to do with the sequence ==

The types of analysis that can be done with the output from the sequencing machine stretches far, however, all methods need to first infer the location in the genome, the sequenced piece of DNA originated from. As the current methods randomly fragment the DNA ([[#intro-sec:libraryprep|[intro-sec:libraryprep]]]), the genomic location information is completely lost. This process is referred to as mapping.

<span id="intro-sec:mapping"></span>
=== Mapping - Ey man, where is my genomic location? ===

In this process, the fragments of DNA, which were sequenced, are assigned a genomic coordinate on the reference genome. This is only possible, due to the fact, that we have a resolved genome sequences ([[#intro-sec:sequencing|[intro-sec:sequencing]]]) for a high number of species. The location a sequenced piece of DNA fits to the reference genome might be unique, but it could also fit to multiple locations, due to highly repetitive regions or due to the existence of pseudo genes with almost 100% identify. In addition to this, the reference genome might not accurately reflect the genome of the organism that has been sequenced. Each mapping position is therefore assigned a quality score, which reflects how likely it is the actual position of the sequence. As Illumina sequencers have the ability to sequence both ends of the DNA fragment, the position of the ends (read 1 and read 2) to each other can also be used to infer the quality, as they should be within a reasonable distance to each other ([[#fig:libraryprep|[fig:libraryprep]]])

As this process is time-consuming and the exact location of the fragment might not be as important, there exists a subset of tools called pseudo-mapper, which are based on [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20k|class=math inline|k]]-mers, which are predefined DNA sequences of length [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20k|class=math inline|k]], which help to identify certain regions of interest. These tools are especially common for RNAseq, where the exact location of a read does not matter, only that the read is within a gene <span class="citation" cites="Bray2016 Patro2017">(Bray et al. 2016; Patro et al. 2017)</span>, but also for methods that estimate similarity between sequences (DNA, RNA or protein) <span class="citation" cites="Ondov2016 Luczak2017">(Ondov et al. 2016; Luczak, James, and Girgis 2017)</span>.

For this work however, the exact position of reads is crucial, so only real mapping methods like BWA <span class="citation" cites="Li2013">(Heng Li 2013)</span> or Bowtie 2 <span class="citation" cites="Langmead2018">(Langmead et al. 2018)</span>, which are optimised for short reads from Illumina systems, provide the necessary functions.

<span id="intro-sec:variantcalling"></span>
=== Variant calling - spot the difference ===

As intra-species genetic variation is intended for adaptation and evolution, there will be places where the DNA sequence of the subject will differ from the sequence of the reference (see [[#intro-sec:mutations|[intro-sec:mutations]]]). These variants give insight into medical background as well as treatment options for patients and can even be used to guide family planning. Depending on the type of variation that is of interest, a different set of computational methods are needed, as germline and somatic variants have different properties.

<span id="intro-sec:germlinecalling"></span>
=== Germline variant calling - the cards you have been dealt at birth ===

The most common source of DNA used for germline variant analysis is the mono nuclear layer from the blood of the subject, but really almost any cell can be used for this process, as all cells in the organism will share all germline variants ([[#intro-sec:mutations|[intro-sec:mutations]]]). The only important input on top of the DNA sequence from the sequencer are the reference genome of the organism, as all variant nomenclature is based on the reference and the ploidy of the organism ([[#intro-sec:ploidy|[intro-sec:ploidy]]]). The ploidy is key to infer, at which ranges of allele frequency a variant can biologically occur. For example in a human diploid genome, germline variants can occur either in one or both chromosomes, which mean we assume reads should show an allele frequency of around 50% and 100%, where the hexaploid commercial wheat <span class="citation" cites="Mayer2014">(Mayer et al. 2014)</span> allele frequency for variants would be 16%, 33%, 50%, 66%, 0.83% and 100%. Due to the random sampling and possible sequencing errors, the observed allele frequencies will differ from the theoretical values. Most state of the art germline variant calling method will also use haplotype reconstructions through de-Bruijn graphs, which features a remapping of reads in relation to each other <span class="citation" cites="Garrison2012 Lai2016 Kim2018 Benjamin2019 Cooke2021">(Garrison and Marth 2012; Lai et al. 2016; Kim et al. 2018; Benjamin et al. 2019; Cooke, Wedge, and Lunter 2021)</span> where the original mapping location assigned by the aligner ([[#intro-sec:mapping|[intro-sec:mapping]]]) is only used as a guideline. This allows to resolve even complex haplotypes of the sample by not restricting the method to the linear setup of the reference genome.

<span id="intro-sec:somaticcalling"></span>
=== Somatic variant calling - life is ever-changing ===

In contrast to germline variant calling, somatic variant calling methods cannot rely on allele frequency, as not all cells sequenced are expected to have the change in nucleotide. The allele frequency is instead a measure of the sub clonal size. A subclone is here defined as the set of cells, which were derived from the cell, which originally acquired the somatic mutation. Depending on the selective advantage, just random drift and also the time point when the variant was introduced, these clones can be very variable in size and therefore their contribution to the DNA in the sequencing. As not all cells have the variants, the selection of the tissue for library preparation is very important, unlike for germline calling. The main use of somatic variant calling is the genetic diagnosis and research of cancer samples, where the main question is, which changes are present in the tumour, which lead to the disease.

The ideal scenario for tumour somatic variant calling is when a biopsy of the tumour as well as a normal sample of the patient is available. In most clinical cases, this will be the diagnostic biopsy as well as the mono nuclear layer from blood, just like for germline calling ([[#intro-sec:germlinecalling|[intro-sec:germlinecalling]]]). This needs to be adjusted depending on the type of malignancy, because if the tumour is a leukemia, the mono nuclear layer of the blood might contain tumour cells, but for solid tumours, the blood is a routine, minimally invasive option. These two samples are then analysed together and only changes that are only in the somatic tumour sample and not in the normal sample are reported. Even though this concept sounds simple, there are some pitfalls <span class="citation" cites="GATKTeam2021a">(GATK Team 2021b)</span>. First, there might be some tumour contamination in the normal sample, which needs to be adjusted for <span class="citation" cites="Kim2018 TaylorWeiner2018">(Kim et al. 2018; Taylor-Weiner et al. 2018)</span>. Second, there might be normal “contamination“ in the tumour sample, this means that not all cells in the tumour sample are actually tumour. This means that the signal of the tumour changes is reduced and harder to find.

All of these issues are amplified in the case, when there is no “normal“ sample available, either because the patient didnt consent, due to other medical issues, or because for diagnostic tests there usually is no need for a germline sample. In this case, there is the option for “tumour only“ variant calling, which requires a database of germline variants in the population, to distinguish between somatic and germline variants, as the variant calling is very similar to just germline variant calling ([[#intro-sec:germlinecalling|[intro-sec:germlinecalling]]]) without the restriction of the ploidy. However, even with an extensive database like gnomAD <span class="citation" cites="Karczewski2020">(Karczewski et al. 2020)</span> it is unlikely to be able to remove all germline variants from the analysis and as there is no direct comparison, the precision of the “tumour only“ method is significantly lower <span class="citation" cites="Karimnezhad2020">(Karimnezhad et al. 2020)</span>.

<span id="intro-sec:cancer"></span>
== Cancer ==

For a long time in human history, the origin of cancer as a disease was a mystery and a multitude of theories, starting in ancient Egypt, were developed. These theories ranged from a curse to chemical imbalance over parasites to trauma. In this section I will outline both the history of cancer as a disease and the treatments starting with ancient times leading up right until the current times. While the first steps are very wide, because the biology itself was not understood, it is quite curious how often people with more knowledge came to worse conclusions and theories, than were already known thousands of years ago.

Around 3000BC the Egyptians describe the bulging tumour of the breast as an incurable disease<span class="citation" cites="Breasted1930">(Breasted 1930)</span>, even then they already had some ointments, which were used, including resection, cauterisation and salting of the affected areas, all of which were still used up until the 19[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5E%7Bth%7D|class=math inline|^{th}]] century <span class="citation" cites="Hajdu2004">(Steven I. Hajdu 2004)</span>. This papyrus document is considered the oldest evidence of cancer in humanity.

When the ancient Greeks laid the foundation for modern medicine with Hippocrates, the first hypothesis about natural causes of cancers was formulated and the terms “cancer“ and “carcinoma“ were coined. The abundance and accumulation of “black bile“ in the body was thought to be the cause of the cancers. However, the treatment was still the same as before, with resection and lotions <span class="citation" cites="Chadwick1950">(Chadwick and Mann 1950)</span>.

Following Hippocrates, the Roman physician Celsus progressed the understanding of cancers significantly, by describing metastatic relapse of treated breast cancer in neighbouring armpits and even the spread to distant organs. He also was aware, that the outcome of patients was better, if the tumours were removed early and aggressively <span class="citation" cites="Celsus1939">(Celsus 1939)</span>.

With the destruction of the western Roman Empire, the Middle East became well known for their strong advances towards modern medicine and the court physician to the Emperor of Constantinople Aetius had success with the first total mastectomy and generally was an advocate of the total excision of tumours <span class="citation" cites="Browne2012">(Browne 2012)</span>.

Sadly, while both the understanding of cancer and the treatment were steadily improving, the Pope prohibited bloodshed as well as surgeries and therefore lead to a slow-down of advances, especially because autopsies were also forbidden a hundred years later in 1305. However, there were still illegal experiments conducted and the general classification which is still used up to date was started, by Henri de Mondeville, who started classifying tumours by their anatomical site<span class="citation" cites="Pilcher1895">(Pilcher 1895)</span>.

After the end of the “dark ages“, the wide availability of older medical works from both Greek and Roman due to the book print invention, led to the re-emergence of the use of chemical ointments and lotions on cancer lesions. With Paracelsus promoting the usage of chemicals, which he himself warns are poisonous in the wrong concentration, for the treatment of cancer, he laid the ground-work for the modern Chemotherapy <span class="citation" cites="PHT1562">(Paracelsus (Bombastus von Hohenheim TPA) 1562)</span>.

As the dissection of corpses was no longer banned by the church, more and more cases of “hidden“ causes of death were found post mortem, which were often cancers on internal organs, like the brain but also the detection of malignant and benign tumours was a major breakthrough. This lead to the understanding, that benign tumours might turn malignant after some time and many physicians suggested removal of the benign growths <span class="citation" cites="Severino1632">(Severino 1632)</span>.

Due to genetic disposition of cancer, especially breast cancer, two independent physicians (Zacutus Lusitani and Nicholas Tulp) came to the conclusion, that cancer is contagious and proposed isolation of patients <span class="citation" cites="Lusitani1649 Tulpii1652">(Lusitani 1649; Tulpii 1652)</span> which shows, that while the treatment of cancer was improving steadily, but the origin of the disease was still a mystery. It took until 1700 when <span class="citation" cites="DeshaiesGendron1701">Deshaies-Gendron (1701)</span> described cancer as a transformation of a normal body part, which continues to grow without control and while he was aware of metastatic disease, he suggested no treatment, as he did not believe cancer to be curable with drugs <span class="citation" cites="DeshaiesGendron1701">(Deshaies-Gendron 1701)</span>.

Another ground-breaking work published in the same year was the collection of almost three thousand autopsy reports and their clinical history, which contain a number of detailed cancer cases including: brain, head and neck, lung, breast, esophagus, stomach, colon, liver, pancreas, kidney, uterus, cervix, bladder, and prostate. Many of the terms used by Theophilus Boneti to describe the cases are still in use and the work itself was the first step toward tumour pathology <span class="citation" cites="Hajdu2010a">(Steven I. Hajdu 2010a)</span>

However, it took almost 150 years after the theory of cancer being contagious for <span class="citation" cites="Nooth1804">Nooth (1804)</span> to conduct experiments trying to infect himself with cancer pieces resected from another person, which proved that cancers generally are not infectious.

With the invention and consequently common use of the microscope in the pathology, more and more causes of deaths were identified as caused by cancer. An example is the connection of a chronic cough to lung cancer and swollen joints with sarcoma <span class="citation" cites="Etmueller2018">(Etmüller 2018)</span>.

After more and more autopsies of cancer patients, surgeons like <span class="citation" cites="Heister1747">Heister (1747)</span> found that breast cancer resection needs to include the breast, the axillary lymph node and the pectoralis major muscle which got to be known as the Halsted radical mastectomy and was the standard of care for a long time.

While the treatment of cancers (mostly surgical) was getting more and more advanced, but the origin and cause of cancer in patients was still very much debated. As there are a manifold of causes as we now know, it is maybe not surprising that it took longer, but by the middle of the 18[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5E%7Bth%7D|class=math inline|^{th}]] century chronic inflammation as a cause of cancer initiation was hypothesised <span class="citation" cites="Hajdu2010b">(Steven I. Hajdu 2010b)</span>.

The next big step was taken, when in 1838 the concepts of cells as fundamental building blocks of organisms was published. In the following years, many cancers were dissected and microscopically analysed. This revealed that tumour cells look vastly different from normal cells, and it was thought that they morphological features could serve to identify their fate <span class="citation" cites="Mueller1838">(Müller 1838)</span> and became known for defining the cellular origin of benign and malignant tumours. And while he described the tumours as a collection of abnormal cells with stroma, he thought cancer to arise from newly generated cells from a diseased organ and thought the underlying cause to be “amorphous embryonal blastema“.

With this foundation, over the next hundred years, lots of advances were made into the morphology of different tumours and many previously undetected ones, like leukemia, were found and extensively characterised. However, even then, there were researchers, which understood that the heterogeneity of cancers is so vast, that while he was convinced that the microscope will be a mandatory instrument to diagnose cancers, more effort to collect and study specimen is necessary to have a complete picture <span class="citation" cites="Bennett1849">(Bennett 1849)</span>.

As many shared the view of <span class="citation" cites="Bennett1849">Bennett (1849)</span>, the second half of the 19[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5E%7Bth%7D|class=math inline|^{th}]] century was a rich source of surgical pathology and the oncology literature in general. Most outstanding was Rudolf Virchow’s “Die krankhaften Geschwülste“ <span class="citation" cites="Virchow1863">(Virchow 1863)</span> which is a first landmark book on the classification of cancers, and is still a well of knowledge. From his work, the terms “hyperplasia“ and “metaplasia“ we derived, as pre-cancerous states of cells. He also was one of the first to hypothesis the presence of growth stimulating substances around cancers, which lead to their uncontrolled growth. While he also was the first to again oppose the “amorphous embryonal blastema“ theory and instead was convinced that tumour cells were just abnormally changed cells, which he called “chronic irritation theory“ and had a theory that metastasis were seeded by the original lesion (like in this melanoma [[#fig:drawing|[fig:drawing]]]), he also had major scientific impact in a number of other fields like Parasitology, Forensic and Anthropology[[#fn1|<sup>1</sup>]].

[[File:Figures/drawingMelaMeta.jpeg|thumb|none|alt=Drawing of central nervous system metastasis from page 121, Volume 2 of “Die krankhaften Geschwülste“ <span class="citation" cites="Virchow1863">Virchow (1863)</span>; translated original caption: Fig. 128: Multiple melanoma of the Pia mater basilaris, most pronounced around the Medulla oblongata, the Pons, the Fossa Sylvii, Fissura longit (sample No. 256a from 1858); Fig. 129: Lower end of spinal cord of Fig. 128 with multiple melanoma of the soft skin with node like growths at the nerve roots (sample No. 256b from 1858)|Drawing of central nervous system metastasis from page 121, Volume 2 of “Die krankhaften Geschwülste“ <span class="citation" cites="Virchow1863">Virchow (1863)</span>; translated original caption: Fig. 128: Multiple melanoma of the Pia mater basilaris, most pronounced around the Medulla oblongata, the Pons, the Fossa Sylvii, Fissura longit (sample No. 256a from 1858); Fig. 129: Lower end of spinal cord of Fig. 128 with multiple melanoma of the soft skin with node like growths at the nerve roots (sample No. 256b from 1858)]]

While the search of possible cancer causing substances started to get more and more interest, only one real cause was thought to be found in the ore of the central European mountains, where miners would have a higher prevalence of lung cancers. Nevertheless, this was later found to be caused by radio active material and not by the inhaled dust of minerals as expected. Similar, many parasites and bacteria were found as potential causes of cancer, but none of the findings could produce proof.

While all these steps were getting closer together in time up until the beginning of the 20[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5E%7Bth%7D|class=math inline|^{th}]] century, they were still fairly minor in the contrast to the high speed and throughput results that the last hundred years brought with it. While technically Willhelm Röntgen discovered the X-rays just before the change of the century <span class="citation" cites="Roentgen1898">(Röntgen 1898)</span>, both its impact on the body and cancer were only clear a few years into the last century <span class="citation" cites="Frieben1902 Scholtz1902">(Frieben 1902; Scholtz 1902)</span>. However, similar to how X-rays can cause cancers, researcher also found quickly, that it can also treat cancer and thus the field of radiotherapy was created. This then was the first major change in cancer treatment for around five thousand years, which also could treat inoperable cancers.

The next invention, that I want to highlight in the vast amount of advances made in the advent of the 20[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5E%7Bth%7D|class=math inline|^{th}]] century, is the cutting needle aspiration syringe, which allowed a non-traumatic biopsy of internal organs for microscopy study. Which made it possible to not have exploratory surgery and instead allow planning of necessary operations.

The next mayor step in the treatment of cancers comes in the form of chemotherapy, when <span class="citation" cites="Ehrlich1909">Ehrlich (1909)</span> published his work “Beiträge zur experimentellen Pathologie und Chemotherapy“ where he injected animals with different toxins in order to destroy cancer cells. Although, it still took another 30 years till after the second world war when the discovery, that a chemical design for warfare also had potent anti-tumour effect.

In the meantime, the first long term tissue cultures of animal cancer cell lines were established and further insights like the Warburg effect <span class="citation" cites="Warburg1928">(Warburg 1928)</span> found, which showed, that cancer cells use glucose at a higher rate than healthy cells. This effect ultimately to the discovery of the positron emission tomography (PET) scan, which allowed a significantly more granular diagnosis and localisation of cancerous lesions than before.

With the success of growing human cell lines in vitro, the USA embarked on a massive experiment to test any potential source of chemical carcinogenesis. But at the same time, multiple viruses were identified to cause cancers in the 1950s, when electron microscopy was invented <span class="citation" cites="Claude1947">(Claude, Porter, and Pickels 1947)</span>.

Only a few more years later, the biggest advance in the understanding of biology was made, when the structure of DNA was discovered <span class="citation" cites="Watson1953">(Watson and Crick 1953)</span> ([[#intro-sec:DNA|[intro-sec:DNA]]])and subsequently lead to numerous new experiments and breakthroughs. When studying how viruses are able to reverse transcribe their RNA and insert a new gene into a healthy cell, which then transformed into a cancer cell, the term “oncogene“ was coined<span class="citation" cites="Huebner1969 Baltimore1970 Temin1970">(Huebner and Todaro 1969; Baltimore 1970; Temin, Mizutami, et al. 1970)</span> and the foundation for the understanding of how genes influence the emergence of cancers was laid. This also lead to the understanding, that heritable changes in the genome could predispose a person to cancer, which was previously hypothesised <span class="citation" cites="Li1969">(F. P. Li and Fraumeni Jr 1969)</span>. And while the discovery of DNA was a substantial boost for the understanding of cancer, the diagnostic capabilities increased at a similar speed, with urine tests for biomarkers of certain cancers as well as antigen detection.

And this is when we arrive at the “current“ times, when a few years ago next generation sequencing (NGS) ([[#intro-sec:sequencing|[intro-sec:sequencing]]]) was introduced and sped up data generation on genomic and non-genomic diagnostic tests, from targeted amplicon sequencing to whole genome sequencing. These highly specific tests then allowed the application of highly specific drugs, like tyrosine kinase inhibitors (TKI)s, which are tailored to target a specific alteration in the genome of a cancer cell, and genetically engineered antibodies which can be homed in on the cancer. And while the therapeutic world is quickly evolving, many of the questions from previous times are still the same. We still don’t know how and when the heterogeneity in cancers occurs, we just know it is a major source of resistance to treatment. We also still do not have an answer to the “cell of origin“ question that has been asked for so long, but we do know that some cancers can de-differentiate and morph between cell types.

So instead of trying to answer these questions directly, there has been an effort to define fundamental features malignancies have to be considered cancers, very similar to the early pathology descriptions. The original characteristics comprise

<div class="enumerate*">

Sustaining proliferative signalling

Evading growth suppressors

Activating invasion and metastasis

Enabling replicative immortality

Inducing angiogenesis

Resisting cell death


</div>
([[#fig:oldhallmarks|[fig:oldhallmarks]]]).

[[File:Figures/oldHallmarksCancer.jpg|thumb|none|alt=Acquired capabilities of cancer; Functional capabilities acquired by most cancers during their development; Figure adapted from <span class="citation" cites="Hanahan2000">Hanahan and Weinberg (2000)</span><span class="citation" cites="Hanahan2000">(Hanahan and Weinberg 2000)</span>|Acquired capabilities of cancer; Functional capabilities acquired by most cancers during their development; Figure adapted from <span class="citation" cites="Hanahan2000">Hanahan and Weinberg (2000)</span><span class="citation" cites="Hanahan2000">(Hanahan and Weinberg 2000)</span>]]

These hallmarks were for a while considered the core of tumour development and the authors themselves hypothesised, that these core mechanics allow us to condense the complexity that cancer displays, both in the clinic and in labs, with a small set of rules, which all cancers have to obey <span class="citation" cites="Hanahan2000">(Hanahan and Weinberg 2000)</span>. In their exact words: “We foresee cancer research developing into a logical science, where the complexities of the disease, described in the laboratory and clinic, will become understandable in terms of a a few underlying principles“

However, with 11 years of additional research into the topic, more hallmarks have been found, and the original list was revised by the authors to contain additional characteristics, namely

<div class="enumerate*">

Avoiding immune destruction

Tumour-promoting inflammation

Genome instability and mutation

Deregulating cellular energetics


</div>
<span class="citation" cites="Hanahan2011">(Hanahan and Weinberg 2011)</span>. And even then a few years later, even more hallmarks e.g. metabolic rewiring are now considered a part of the characteristics of cancer <span class="citation" cites="Fouad2017">(Fouad and Aanei 2017)</span>.

[[File:Figures/newestHallmarksOfCancer.jpg|thumb|none|alt=Emerging hallmarks and enabling characteristics of cancer; updated version of the hallmarks figure ([[#fig:oldhallmarks|[fig:oldhallmarks]]],<span class="citation" cites="Hanahan2000">(Hanahan and Weinberg 2000)</span>); Figure adapted from <span class="citation" cites="Hanahan2022">Hanahan (2022)</span><span class="citation" cites="Hanahan2022">(Hanahan 2022)</span>; Left, the Hallmarks of Cancer currently embody eight hallmark capabilities and two enabling characteristics. In addition to the six acquired capabilities – Hallmarks of Cancer – proposed in 2000 ([[#fig:oldhallmarks|[fig:oldhallmarks]]]), the two provisional “emerging hallmarks” introduced in 2011 (<span class="citation" cites="Hanahan2011">(Hanahan and Weinberg 2011)</span>) –cellular energetics (now described more broadly as “reprogramming cellular metabolism”) and “avoiding immune destruction” – have been sufficiently validated to be considered part of the core set. Given the growing appreciation that tumors can become sufficiently vascularized either by switching on angiogenesis or by co-opting normal tissue vessels <span class="citation" cites="Kuczynski2019">(Kuczynski et al. 2019)</span>, this hallmark is also more broadly defined as the capability to induce or otherwise access, principally by invasion and metastasis, vasculature that supports tumor growth. The 2011 sequel further incorporated “tumor-promoting inflammation” as a second enabling characteristic, complementing overarching “genome instability and mutation,” which together were fundamentally involved in activating the eight hallmark (functional) capabilities necessary for tumor growth and progression. Right, this review incorporates additional proposed emerging hallmarks and enabling characteristics involving “unlocking phenotypic plasticity,” “nonmutational epigenetic reprogramming,” “polymorphic microbiomes,” and “senescent cells.”|Emerging hallmarks and enabling characteristics of cancer; updated version of the hallmarks figure ([[#fig:oldhallmarks|[fig:oldhallmarks]]],<span class="citation" cites="Hanahan2000">(Hanahan and Weinberg 2000)</span>); Figure adapted from <span class="citation" cites="Hanahan2022">Hanahan (2022)</span><span class="citation" cites="Hanahan2022">(Hanahan 2022)</span>; Left, the Hallmarks of Cancer currently embody eight hallmark capabilities and two enabling characteristics. In addition to the six acquired capabilities – Hallmarks of Cancer – proposed in 2000 ([[#fig:oldhallmarks|[fig:oldhallmarks]]]), the two provisional “emerging hallmarks” introduced in 2011 (<span class="citation" cites="Hanahan2011">(Hanahan and Weinberg 2011)</span>) –cellular energetics (now described more broadly as “reprogramming cellular metabolism”) and “avoiding immune destruction” – have been sufficiently validated to be considered part of the core set. Given the growing appreciation that tumors can become sufficiently vascularized either by switching on angiogenesis or by co-opting normal tissue vessels <span class="citation" cites="Kuczynski2019">(Kuczynski et al. 2019)</span>, this hallmark is also more broadly defined as the capability to induce or otherwise access, principally by invasion and metastasis, vasculature that supports tumor growth. The 2011 sequel further incorporated “tumor-promoting inflammation” as a second enabling characteristic, complementing overarching “genome instability and mutation,” which together were fundamentally involved in activating the eight hallmark (functional) capabilities necessary for tumor growth and progression. Right, this review incorporates additional proposed emerging hallmarks and enabling characteristics involving “unlocking phenotypic plasticity,” “nonmutational epigenetic reprogramming,” “polymorphic microbiomes,” and “senescent cells.”]]

And even during the time of my PhD, further research revealed additional hallmarks, which got characterised by <span class="citation" cites="Hanahan2022">Hanahan (2022)</span>. The newest version adds another two characteristics and hallmarks, specifically:

<div class="enumerate*">

unlocking phenotypic plastisity

nonmutational epigenetic reprogramming

polymorphic microbiomes

senescent cells


</div>
(see [[#fig:newesthallmarks|[fig:newesthallmarks]]]).

These evolution of these hallmarks shows, why even though lots of time and effort was invested into cancer research for multiple centuries, there still is no unifying definition and treatment for cancer. The vast heterogeneity not only between cancer types, but also between patients makes it very hard to study. But even within patient there is third type of heterogeneity, which is the main cause of treatment resistance and relapse <span class="citation" cites="DagogoJack2017">(Dagogo-Jack and Shaw 2017)</span>. And while we know, that this diversity exists and efforts have been made to measure and classify them <span class="citation" cites="Noorbakhsh2018">(Noorbakhsh et al. 2018)</span>, there is still a lack of methods, which deal with the heterogeneity in their models to inform clinical approaches directly.

<span id="intro-sec:overview"></span>
== Overview ==

<div class="savequote">

“It is the main source of our mistakes, when making making decision, that we only look at life piece by piece and not as a whole.“


</div>
<span id="ch:variantcalling"></span>
= Joint somatic variant calling - if germline can do it, so can we =

<span id="variantcalling-sec:intro"></span>
== Introduction ==

When I started exploring the somatic variant calling methods in the beginning of my PhD in 2018, I was surprised about the stark difference between germline and somatic variant calling methods. Where all &quot;modern&quot; germline variant callers, like Strelka2 <span class="citation" cites="Kim2018">(Kim et al. 2018)</span>, HaplotypeCaller <span class="citation" cites="Poplin2017">(Poplin et al. 2017)</span>, DRAGEN <span class="citation" cites="Miller2015">(Miller et al. 2015)</span> and DeepVariant <span class="citation" cites="Poplin2018">(Poplin et al. 2018)</span>, have the built-in capability to joint call multiple related samples, for example from family trios, virtually no somatic variant caller had this function.

The joint analysis of smaller cohorts improves the performance of germline variant calling methods significantly, by allowing to assess technical artefacts, which might be unique for the individual sequencing machine or the researcher handling the DNA <span class="citation" cites="Schirmer2016 Stoler2021">(Schirmer et al. 2016; Stoler and Nekrutenko 2021)</span>. Additionally, as certain parts of the genome are more problematic to sequence ([[#intro-sec:sequencing|[intro-sec:sequencing]]]) and map ([[#intro-sec:mapping|[intro-sec:mapping]]]), a “control“ sample can help to distinguish if a certain observed change occurs commonly is a technical issue or in fact a real change.

For somatic variant calling, this concept has been adopted on in the genome analysis toolkit (GATK) <span class="citation" cites="BrianOConnor2020">(Brian O’Connor 2020)</span> to allow the use of panel of normals (PON), which contains frequently seen changes in healthy (“normal“) individuals analysed with the same sequencing technology <span class="citation" cites="GATKTeam2021">(GATK Team 2021a)</span>. Although, in contrast to the more intricate model for the germline equivalent, this is a post processing step of the analysis. Mutect2, which is the most recent somatic variant calling algorithm provided by the Broad institute, also provides a multi-sample mode, for which all tumour samples need to be from the same patient, either longitudinal or spatial different <span class="citation" cites="GATKTeam2020">(GATK Team 2020)</span>. This mode is hidden quite well and all tutorials published by the developers state that “there is currently no way to perform joint calling for somatic variant discovery“ <span class="citation" cites="GATKTeam2021a">(GATK Team 2021b)</span>, so while all methods in the GATK are considered a beta feature, the multi sample mode needs to be used with care.

There are only two methods currently, which have documented and published capabilities to jointly analyse tumour samples from the same patient to call somatic variants. The first one is a specialised method built on a joint bayesian model for SNVs to occur in multiple samples called multiSNV <span class="citation" cites="Josephidou2015">(Josephidou, Lynch, and Tavaré 2015)</span>. However it has multiple shortcomings, which make it not usable for our data. First, as the name suggests, the method can only jointly evaluate SNVs and completely ignores INDELs and structural variants, which would be acceptable for the superior performance it provides. However, multiSNV was optimised only for WES and not for the very deep WGS that is now available and part of this work. This mismatch of input types means exceptionally high runtimes on our data. Even with custom parallelisation that was attempted in this work, the predicted runtime for just one multi sample patient would have been longer than 3 years. This shows, that while multiSNV was a great step forward at the time, there is a real need for new methods to stem the tide of sequencing data available due to the ever decreasing sequencing cost.

multiSNV has been the only software available for multi sample analysis for almost five years, but during this work, superFreq <span class="citation" cites="Flensburg2020">(Flensburg et al. 2020)</span> was published. It combines all standard analysis steps for tumour analysis, like quality assessment, variant calling, copy number analysis and clonal deconvolution, into one program and is even able to jointly analyse samples. However, similar to multiSNV, its focus during optimisation and development was on WES and RNAseq data, so when applied to our data, we could not find a server node with enough memory to execute the workflow.

This then prompted us to investigate possible workflows to enable the analysis of high depth WGS, which we estimate to become more and more normal, with the ever dropping prices of sequencing. The following sections will show the development and validation of the joint variant calling methods as described in <span class="citation" cites="Hollizeck2021">Hollizeck et al. (2021)</span> ([[#variantcalling-sec:publication|[variantcalling-sec:publication]]]), additional analysis on the impact of the joint variant calling on downstream analysis ([[#variantcalling-sec:downstream|[variantcalling-sec:downstream]]]), longitudinal analysis ([[#variantcalling-sec:longitudinal|[variantcalling-sec:longitudinal]]]) and clonal deconvolution ([[#variantcalling-sec:clonal|[variantcalling-sec:clonal]]]) and lastly information on the usage of the methods by others in the research community ([[#variantcalling-sec:usage|[variantcalling-sec:usage]]]).

<span id="variantcalling-sec:publication"></span>
== Publication ==

The full publication about joint somatic variant calling can be found at [https://doi.org/10.1093/bioinformatics/btab606 <code>https://doi.org/10.1093/bioinformatics/btab606</code>] and non-journal formatted version is also attached as [[#ch:appendixManuscript|[ch:appendixManuscript]]] with all supplementary methods.

References to supplementary data will be prefixed with the letter [[#ch:appendixManuscript|6]] in the text.

<span id="summary"></span>
=== Summary ===

To enable highly sensitive, fast and accurate variant detection from multiple related tumour samples, we have developed joint variant calling extensions to two widely used single-sample algorithms, FreeBayes <span class="citation" cites="Garrison2012">(Garrison and Marth 2012)</span> and Strelka2 <span class="citation" cites="Kim2018">(Kim et al. 2018)</span>. Using both simulated and clinical sequencing data, we show that these workflows are highly accurate and can detect variants at much lower variant allele frequencies than other commonly used methods.

<span id="freebayessomatic-workflow"></span>
=== FreeBayesSomatic workflow ===

The original FreeBayes algorithm can jointly evaluate multiple samples, but routinely it does not perform somatic variant calling on tumour-normal pairs. We introduce FreeBayesSomatic which allows concurrent analysis of multiple tumour samples by adapting concepts from SpeedSeq <span class="citation" cites="Chiang2015">(Chiang et al. 2015)</span> which differentiates the likelihood of a variant between tumour and normal samples instead of imposing an absolute filter for all variants called in the normal. Hence, for each genotype (GT) at SNV sites, FreeBayesSomatic first calculates the difference in likelihoods (LOD) between the normal ([[#eq:01|[eq:01]]]) and the tumour ([[#eq:02|[eq:02]]]) samples genotype likelihoods (GL) with g[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20_%7B0%7D|class=math inline|_{0}]] describing the reference genotype.

[[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cbegin%7Baligned%7D%0A%5Ctext%7BLOD%7D_%7B%5Ctext%7Bnormal%7D%7D%20%26%3D%20%5Cmax_%7Bg_i%20%5Cin%20%5Ctext%7BGT%7D%7D%20%5Cleft%28%20%5Ctext%7BGL%7D%28g_0%29%20-%20%5Ctext%7BGL%7D%28g_i%29%20%5Cright%29%20%5Clabel%7Beq%3A01%7D%5C%5C%0A%5Ctext%7BLOD%7D_%7B%5Ctext%7Btumour%7D%7D%20%26%3D%20%5Cmin_%7Bs%20%5Cin%20%5Ctext%7BSamples%7D%7D%20%5Cleft%28%20%5Cmin_%7Bg_i%20%5Cin%20%5Ctext%7BGT%7D%7D%20%5Cleft%28%20%5Ctext%7BGL%7D_s%28g_i%29%20-%20%5Ctext%7BGL%7D_s%28g_0%29%20%5Cright%29%20%5Cright%29%20%5Clabel%7Beq%3A02%7D%5C%5C%0A%5Ctext%7BsomaticLOD%7D%20%26%20%3A%3D%20%5Cleft%28%20%5Ctext%7BLOD%7D_%7B%5Ctext%7Bnormal%7D%7D%20%5Cgeq%203.5%20%5Cland%20%5Ctext%7BLOD%7D_%7B%5Ctext%7Btumour%7D%7D%20%5Cgeq%203.5%20%5Cright%29%20%5Clabel%7Beq%3A03%7D%5Cend%7Baligned%7D|class=math display|\begin{aligned} \text{LOD}_{\text{normal}} &amp;= \max_{g_i \in \text{GT}} \left( \text{GL}(g_0) - \text{GL}(g_i) \right) \label{eq:01}\\ \text{LOD}_{\text{tumour}} &amp;= \min_{s \in \text{Samples}} \left( \min_{g_i \in \text{GT}} \left( \text{GL}_s(g_i) - \text{GL}_s(g_0) \right) \right) \label{eq:02}\\ \text{somaticLOD} &amp; := \left( \text{LOD}_{\text{normal}} \geq 3.5 \land \text{LOD}_{\text{tumour}} \geq 3.5 \right) \label{eq:03}\end{aligned}]]

Next, the variant allele frequencies (VAF) in both the tumour and the normal samples are compared at each site.

[[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cbegin%7Baligned%7D%0A%5Ctext%7BVAF%7D_%7B%5Ctext%7Btumour%7D%7D%20%26%3D%20%5Cmax_%7Bs%20%5Cin%20%5Ctext%7BSamples%7D%7D%20%28%20%5Ctext%7BVAF%7D_s%29%20%5Clabel%7Beq%3A04%7D%5C%5C%0A%5Ctext%7BsomaticVAF%7D%20%26%20%3A%3D%20%5Cleft%28%20%5Ctext%7BVAF%7D_%7B%5Ctext%7Bnormal%7D%7D%20%5Cleq%200.001%20~%5Clor%20%5Cright.%20%5Cnonumber%20%5C%5C%0A%20%26%20%5Cleft.%20%28%20%5Ctext%7BVAF%7D_%7B%5Ctext%7Btumour%7D%7D%20%5Cgeq%202.7%20%5Ccdot%20%5Ctext%7BVAF%7D_%7B%5Ctext%7Bnormal%7D%7D%29%20%5Cright%29%20%5Clabel%7Beq%3A05%7D%5Cend%7Baligned%7D|class=math display|\begin{aligned} \text{VAF}_{\text{tumour}} &amp;= \max_{s \in \text{Samples}} ( \text{VAF}_s) \label{eq:04}\\ \text{somaticVAF} &amp; := \left( \text{VAF}_{\text{normal}} \leq 0.001 ~\lor \right. \nonumber \\ &amp; \left. ( \text{VAF}_{\text{tumour}} \geq 2.7 \cdot \text{VAF}_{\text{normal}}) \right) \label{eq:05}\end{aligned}]]

A variant is classified as somatic when both somaticLOD as well as somatic VAF pass the criteria somaticLOD ([[#eq:03|[eq:03]]]) and somaticVAF ([[#eq:05|[eq:05]]]).

The thresholds chosen for both LOD and VAF calculations were previously fitted by the blue-collar bioinformatics workflow for the “DREAM synthetic 3“ dataset using the SpeedSeq likelihood difference approach <span class="citation" cites="Chapman2020">(Chapman et al. 2021)</span> and were selected to identify high confidence variants.

<span id="strelka2pass-workflow"></span>
=== Strelka2Pass workflow ===

In contrast to FreeBayes, whilst Strelka2 has a multiple-sample mode for germline analysis and tumour-normal pair somatic variant calling capabilities, it cannot jointly analyse multiple related tumour samples. We enable this feature by adapting a two-pass strategy previously used for RNA-seq data <span class="citation" cites="Veeneman2015">(Veeneman et al. 2015)</span>. First, somatic variants are called from each tumour-normal pair. All detected variants across the cohort are then used as input for the second pass of the analysis, where we re-iterate through each tumour-normal pair but assess allelic information for all input genomic sites.

The method re-evaluates the likelihood of each variant, by integrating every genotype from each tumour-normal pair. This step can &quot;call&quot; a variant ([[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20v|class=math inline|v]]) in a sample that initially did not present enough evidence to pass the Strelka2 internal filtering using two conditions: 1) if this variant was called as a proper &quot;PASS&quot; by Strelka2 in any other tumour sample, or 2) if the integrated evidence for this variant across all tumour-normal pairs reached a sufficiently high level. The second condition was based on the somatic evidence score (SomEVS) reported by Strelka2, which is the logarithm of the probability of the variant [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20v|class=math inline|v]] being an artefact.

[[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20p_%7Berror%7D%28v%29%20%3D%2010%5E%7B%5Cleft%28%20%5Cfrac%7B-%5Ctext%7BSomEVS%7D%28v%29%7D%7B10%7D%20%5Cright%29%7D%20%5Clabel%7Beq%3A06%7D|class=math display|p_{error}(v) = 10^{\left( \frac{-\text{SomEVS}(v)}{10} \right)} \label{eq:06}]]

While the germline sample is shared between all processes, we can approximate these individual probabilities as being independent, since one variant calling process is agnostic of the other. Hence, we derive the following:

[[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20p_%7Berror%7D%28v_%7Bs_1%7D%2Cv_%7Bs_2%7D%2C%5Cldots%2Cv_%7Bs_n%7D%29%20%3D%20%5Cprod_%7Bs%20%5Cin%20%5Ctext%7BSamples%7D%7D%20p_%7Berror%7D%28v_%7Bs%7D%29%20%5Clabel%7Beq%3A07%7D|class=math display|p_{error}(v_{s_1},v_{s_2},\ldots,v_{s_n}) = \prod_{s \in \text{Samples}} p_{error}(v_{s}) \label{eq:07}]]

And therefore:

[[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Ctext%7BSomEVS%7D%28v_%7Bs_1%7D%2Cv_%7Bs_2%7D%2C%5Cldots%2Cv_%7Bs_n%7D%29%20%3D%20%5Csum_%7Bs%20%5Cin%20%5Ctext%7BSamples%7D%7D%20%5Ctext%7BSomEVS%7D%28v_%7Bs%7D%29%20%5Clabel%7Beq%3A08%7D|class=math display|\text{SomEVS}(v_{s_1},v_{s_2},\ldots,v_{s_n}) = \sum_{s \in \text{Samples}} \text{SomEVS}(v_{s}) \label{eq:08}]]

This allows the summation ([[#eq:08|[eq:08]]]) of the SomEVS score across all supporting variants to assign a &quot;PASS&quot; filter, if it reached a joint SomEVS score threshold. This threshold can be set by the user and is 20 by default, which corresponds to an estimated error rate of 1%. These &quot;recovered&quot; variants need to pass a set of additional quality metrics related to depth of coverage, mapping quality and read position rank sum score.

As an additional improvement, we also built multiallelic support into Strelka2 which originally only reports the most prevalent variant at a specific site. Within the two-pass analysis, we reconstruct the available evidence for a multiallelic variant at a called site from the allele-specific read counts and report the minor allele at this site, if there is sufficient support from other samples. This method allows recovery of minor alleles only if another sample has this variant called by Strelka2, as SomEVS scores are not available for minor alleles.

<span id="validation"></span>
=== Validation ===

As new methods are always a good idea, because they challenge previous assumptions and can be a step forward for the field by just showing that simpler models can have the same performance, all methods should be validated against the gold standard methods in the field with data which allows objective measures to be used. For germline variant calling, there have been multiple challenges and specifically designed test datasets, but these predefined datasets do not exist for the somatic equivalent. This issue is even more pronounced, as we do not only need a tumour-normal pair, but we need the multiple tumour samples in the dataset to be related. To allow a fair comparison, I first generated a fully synthetic dataset, where every variant is known and fully defined ([[#variantcalling-sec:simdata|[variantcalling-sec:simdata]]]) to allow a general performance assessment of the methods. Then to ensure that these metrics also hold true in real world data, we then re-analysed previously published datasets which have orthogonal validation in the form of targeted amplicon sequencing (TAS) ([[#variantcalling-sec:realdata|[variantcalling-sec:realdata]]]).

<div class="figure*">



</div>
<span id="variantcalling-sec:simdata"></span>
==== Simulated data ====

We first simulated a phylogeny with somatic and germline variants from ten tumour samples and one normal ([[#fig:varcalling:fig1|[fig:varcalling:fig1]]]A and [[#A:fig:S01|[A:fig:S01]]]A, B). Germline variants were simulated at a uniform allele frequency of [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%200.5|class=math inline|0.5]]. Somatic VAFs were sampled from a custom distribution, modelled to favour low allele frequency variants to closely represent real world data (min VAF: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%200.001|class=math inline|0.001]]; max VAF: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%201|class=math inline|1]]; Fig. S1C, D). Paired-end sequencing reads with realistic error profiles were simulated for WGS data at 160X average coverage using the ART-MountRainier software <span class="citation" cites="Huang2011">(Huang et al. 2011)</span>. The simulated reads were aligned to GRCh38 and both germline and somatic variants from the phylogeny were spiked into the aligned reads using Bamsurgeon <span class="citation" cites="Ewing2015">(Ewing et al. 2015)</span>. We compared the workflows for FreeBayes and Strelka2 with and without our extensions for joint variant calling on the simulated datasets. The performance of Mutect2 joint variant calling was also assessed using its proposed best practice workflow. As both Mutect2 and FreeBayes do not return a verdict for each individual sample, we needed to assign each sample in the multi-sample VCF its own FILTER value. We called a somatic variant as present in a sample, if there were at least two reads supporting it for this sample and the overall FILTER showed a “PASS“, which was the same cut-off used in the refiltering step in the Strelka2-pass workflow.

While the precision of each method without our extensions was greater than [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%2099.8%5C%25|class=math inline|99.8\%]], they all missed at least 25% of all variants in the samples (i.e. recall [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Cleq%2075%5C%25|class=math inline|\leq 75\%]]). In contrast, the recall of the modified workflows increased to [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Capprox%2095%5C%25|class=math inline|\approx 95\%]] with only a minute decrease in the precision for both FreeBayes and Strelka2 ([[#A:fig:S02|[A:fig:S02]]]). Mutect2 had virtually no change in precision, but the recall actually decreased from [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Capprox%2075%5C%25|class=math inline|\approx 75\%]] to [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Capprox%2041%5C%25|class=math inline|\approx 41\%]] when analysing the samples jointly ([[#A:fig:S02|[A:fig:S02]]]B). Additionally, with our modified workflows, true positive variants were called with VAFs as low as 0.008 (median detected VAF [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Cgeq%200.14|class=math inline|\geq 0.14]] for joint sample analysis and [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Cgeq%200.21|class=math inline|\geq 0.21]] for single tumour-normal pair analysis), enabling improved distinction between true variants and technical errors ([[#A:fig:S03|[A:fig:S03]]]). This improvement in performance for Strelka2 is only achieved after the refiltering step and not just a result of the second pass ([[#A:fig:S04|[A:fig:S04]]], [[#A:varcalling:steps|[A:varcalling:steps]]]).

The performance of joint variant calling in Mutect2 was inferior compared to all other methods ([[#A:fig:S02|[A:fig:S02]]]A, B). This was primarily due to the &quot;clustered_events&quot; filter in Mutect2, which excluded the majority of false negative variants, with negligible contribution to the exclusion of true negative variants ([[#A:fig:S05|[A:fig:S05]]]A, B). This result was unexpected as the simulated variants were evenly distributed along the genome and the corresponding allele frequencies were sampled randomly ([[#A:fig:S01|[A:fig:S01]]]D).

Since the extent of the improvement in our joint calling workflows is bound by the number of shared variants between samples, we sub-sampled the simulated dataset, to show the effect of incomplete sampling on our methods, which is more likely in clinical settings. Furthermore, the evolutionary distance between the related samples in addition to the number of samples, has a major impact on the number of shared variants, as only variants acquired between the germline and the most recent common ancestor (MRCA), will benefit from the joint analysis. Therefore, we selected three sample subsets which included two, three and five samples with high evolutionary distance to show the minimum expected improvement ([[#fig:varcalling:fig1|[fig:varcalling:fig1]]]A, B). There was a clear linear improvement for both FreeBayesSomatic and Strelka2Pass when increasing the number of samples, even if they had a distant evolutionary relationship. In contrast, when using only two samples with a small evolutionary distance, the increase in performance was almost as large as when jointly analysing all 10 available samples. This shows that samples with a high number of shared variants will perform better in joint calling workflows ([[#A:fig:S06|[A:fig:S06]]]).

<span id="variantcalling-sec:realdata"></span>
==== Clinical data ====

To validate the performance of our new workflows, we then analysed WGS and whole-exome sequencing (WES) data of multi-region tumour samples from eight patients, with multiple tumour sites (average 7 samples per patient; total number of samples 55), enrolled in a rapid autopsy program conducted at the Peter MacCallum Cancer Centre ([[#A:tab:S1|[A:tab:S1]]] and [[#A:varcalling:clinical|[A:varcalling:clinical]]]) <span class="citation" cites="Solomon2020 Vergara2021">(Solomon et al. 2020; Vergara et al. 2021)</span>. The published studies had multiple somatic variants from the clinical samples orthogonally validated through targeted amplicon sequencing (TAS). We used these TAS-validated variants as the gold standard to evaluate the performance of different workflows, acknowledging that the technical biases inherent to TAS data are different to those present in WGS and WES ([[#A:fig:S07|[A:fig:S07]]]) and that there would be sampling biases depending on different tumour cells analysed in each data type.

In concordance with the results of the simulated data, our improved workflows found additional variants in all but one patient ([[#fig:varcalling:fig1|[fig:varcalling:fig1]]]D, [[#A:fig:S08|[A:fig:S08]]]) (total additional variants Strelka2Pass: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%2064|class=math inline|64]]; FreeBayesSomatic: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%2085|class=math inline|85]]) with only a slight drop in precision for FreeBayesSomatic (mean: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%200.94|class=math inline|0.94]] vs. [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%200.88|class=math inline|0.88]]) and Strelka2Pass (mean: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%200.97|class=math inline|0.97]] vs. [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%200.92|class=math inline|0.92]]). Since the panel of variants validated by TAS was limited ([[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%207108|class=math inline|7108]] bp for patients CA-B through -H), this increase in detected variants suggests that a high number of shared variants in samples are missed with current approaches, which in turn leads to an overestimation of tumour heterogeneity between samples, as these variants are thought to not be present rather than undetected.

Even though the number of shared variants is a major influencing factor when jointly calling variants, low cellularity samples benefit more from the joint calling, as conventional methods cannot reliably distinguish low allele frequency variants from noise. Through a joint analysis approach, the number of recovered variants is higher in low cellularity samples, which indicates, that especially for clinical samples with variable tumour purity, joint analysis can have a major impact on improving performance ([[#fig:varcalling:fig1|[fig:varcalling:fig1]]]E, [[#A:fig:S09|[A:fig:S09]]]).

Mutect2 in contrast, did not show significant improvement in any sample in its joint calling configuration, but showed inferior performance compared to the tumour-normal pairwise approach in two samples ([[#A:fig:S08|[A:fig:S08]]]E), similar to its decreased performance in the simulated data ([[#A:fig:S02|[A:fig:S02]]]). This was due to true variants being removed by the internal filters of the tool ([[#A:fig:S05|[A:fig:S05]]]C, D). This is in stark contrast to our novel workflows, where the joint analysis preserves all called sites from the pairwise method and finds additional variants. Overall, Mutect2 found less validated variants in all patients than both Strelka2Pass (mean: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%202.2|class=math inline|2.2]]) and FreeBayesSomatic (mean: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%202.5|class=math inline|2.5]]) with comparable levels of precision ([[#A:fig:S08|[A:fig:S08]]], [[#A:fig:S10|[A:fig:S10]]]) but longer run times ([[#A:tab:S2|[A:tab:S2]]]).

Our improved workflow also enabled the discovery of multiallelic variants with Strelka2, which led to the discovery of on average [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%2042|class=math inline|42]] additional variants (min: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%201|class=math inline|1]]; max: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20535|class=math inline|535]]) in the analysed WES and [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20987|class=math inline|987]] additional variants in the WGS (min: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%2081|class=math inline|81]]; max [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%202329|class=math inline|2329]]). These variants are strong indicators of sub clonal structure and are invaluable for the study of evolutionary trajectories in cancer, as shown in the following sections.

<span id="variantcalling-sec:downstream"></span>
== Effects on downstream analysis - not quite the missing link, but close ==

The ability to find additional shared variants has significant impact on our understanding of cancer evolution and the timing of initiation and metastatic seeding. Recent work has shown, that similar to the well known genetic heterogeneity, there is heterogeneity when it comes to the timing of metastatic seeding. While traditionally it was thought that tumours only metastasise after they reach a certain size, to escape the restrictions of the niche, like reduced nutrition, recent publications showed, there is also very early metastatic seeding <span class="citation" cites="Hu2019">(Hu et al. 2019)</span>. But all methods analysing heterogeneity and evolutionary timing and history are ultimately based on the somatic variants found in the data, so if we improve on the input of the analysis methods, we can expect a clearer and possibly more granular result.

In the following sections, I will highlight how big the effect can be for methods, like phylogenetic reconstruction and clonal decomposition, which use somatic variants as input.

<span id="variantcalling-sec:phylo"></span>
=== Phylogenetic reconstruction ===

As this work is not about the advantages and shortcomings of different phylogenetic reconstruction tools, I will not show a comprehensive amount of these tools, but rather focus on the results. For this reason, I chose to use neighbour joining (NJ) <span class="citation" cites="Saitou1987">(Saitou and Nei 1987)</span>, because it is fast, readily available in most phylogenetic reconstruction tool kits and if the input distance is correct, the output will be correct. And even, if the distance is not 100% correct, if the distance is “nearly additive“ and the input distances are not far off from the real distance, the tree topology will still be reconstructed correctly <span class="citation" cites="Mihaescu2007">(Mihaescu, Levy, and Pachter 2007)</span>. Lastly, in contrast to many other methods like UPGMA and WPGMA <span class="citation" cites="Sokal1958">(Sokal and Michener 1958)</span>, NJ does not assume an equal mutation rate of each sample, because we know, that the molecular clock hypothesis <span class="citation" cites="Zuckerkandl1962">(Zuckerkandl and Pauling 1962)</span> is not valid for different lineages of cancers <span class="citation" cites="Shibata2010">(Shibata 2010)</span>.

The only thing that NJ requires as an input is a distance matrix of all samples, so the next step was the selection of the right distance metric. While there are lots of distance measures for DNA sequences, which allow accounting for different probabilities of transitions and transversions as well as uneven base composition, models like F81 <span class="citation" cites="Felsenstein1981">(Felsenstein 1981)</span> or HKY85 <span class="citation" cites="Hasegawa1985">(Hasegawa, Kishino, and Yano 1985)</span> are only really designed for germline mutations and are not easily applicable for subclonal somatic mutations, which is why I decided to first transform the variants present in all samples into a binary occurrence vector and then calculating the Hamming distance <span class="citation" cites="Hamming1950">(Hamming 1950)</span> between all samples. This generates a maximum parsimony approach and the branch length of the trees will be directly translatable to the amount of variants which are different between samples.

[[#fig:ca9phylo|[fig:ca9phylo]]] shows both the reconstructed phylogenies of the autopsy samples of the late stage melanoma patient “CA-F“ from the manuscript ([[#ch:appendixManuscript|[ch:appendixManuscript]]], [[#A:tab:S1|[A:tab:S1]]]), using the variants found with the default tumour-normal method on the left and our improved joint method on the right. The exact same reconstruction methodology was used otherwise, such that only the difference inputs lead to the final difference.

Reconstructed phylogenies of a patient with multiple spatially distinct samples; Neighbour joining on Hamming distance on variant occurrence vector. Tip labels describe the location of the sample in the patient. Trees are shown as unrooted with germline as fixated origin point; black line ruler shows the length of an edge with 2000 mutations

There are several obvious changes, first, the longer edge connecting the germline, which we consider as the state of no somatic variants, to all other samples. This shows that there are many more shared mutations in all samples, than what would have been anticipated with the default method, which corresponds to an overestimation of the heterogeneity of the samples. As the accumulation of somatic variants is still used as a proxy for timing and cell divisions, when assuming a high mutation rate for lung cancer ([[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%205.3%20%5Ccdot%2010%5E%7B-8%7D|class=math inline|5.3 \cdot 10^{-8}]] from <span class="citation" cites="Werner2020">Werner et al. (2020)</span> <span class="citation" cites="Werner2020">(Werner et al. 2020)</span>) this difference of [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Capprox%2036000|class=math inline|\approx 36000]] variants is equivalent to [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Capprox%202000|class=math inline|\approx 2000]] cell divisions. While the cell doubling rate of lung cancers is highly dependent on the type <span class="citation" cites="Arai1994">(Arai et al. 1994)</span>, this difference makes a huge difference when assessing the timing of the tumour initiation and further evolution.

Secondly, there have been topological changes, which generate a longer bifuricating edge between the olive coloured “r. liver lobe“ and the “r. pariet. lobe“ showing a bottle neck in cancer evolution, which fits very well with the clinical history, where the patient lived with stable disease for almost ten years, before progressing and dying. The extreme distance of the primary/diagnostic sample from the rest of the samples could be either a difference in sequencing quality, or due to the exposure to FFPE for the ten years between tumour diagnosis and death. However, as this feature is preserved between both the joint and the pairwise analysis, it is no result of our new method.

Side by side view of the reconstructed trees from [[#fig:ca9phylo|[fig:ca9phylo]]]; internal edges, which are distinct between trees are shown as dotted lines; common subtree is shown in red Tree labels have been sorted to minimise distance between labels; Visualisation generated with dendextend <span class="citation" cites="Galili2015">(Galili 2015)</span>

[[#fig:tanglePhyloCA9|[fig:tanglePhyloCA9]]] shows a topology focused view of the two trees, which highlights the breaks which are needed to morph one tree into the other with dotted edges <span class="citation" cites="Vienne2018">(Vienne 2018)</span>. The common subtrees are coloured the same on both sides and connecting lines show identical labels. This format shows that while the trees look quite similar at first glance, they show vastly different topologies.

One example of this is “small bowel“ which was connected to the red common subtree, but is now much closer to the “r. cereb. lobe“ and forms a parallel clade with the “r.liver lobe“. In general, where the pairwise tree shows a very linear topology, which leaves only branching out of the main with no disjunct subclades, which are clearly present in the joint reconstruction. ([[#fig:tanglePhyloCA9|[fig:tanglePhyloCA9]]]).

<span id="variantcalling-sec:longitudinal"></span>
== Longitudinal analysis - something for the ages ==

While the initial motivation for the development of these workflows was the analysis of multi-region, so spatial, samples from the same patient coming from the CASCADE rapid autopsy program, a longitudinal application of these methods for the joint analysis of diagnostic and relapse sample, or even the repeated testing of ctDNA are quite worth thinking about. In this part, I will present work using the published workflows on a longitudinal dataset, which highlights the flexibility and widespread usability of the new methods.

In addition to their autopsy, Patient “CA-F“ also had three longitudinal blood samples taken, from which ctDNA was extracted and WES performed. In a study of late stage melanoma patients, identified ctDNA sequencing as a way to stratify patients into high and low risk of relapse and therefore inform adjuvant therapy <span class="citation" cites="Tan2019">(Tan et al. 2019)</span>, which makes this patient a prime example to show the improvement with joint variant calling. Similar to the spatially related samples, the joint analysis can improve the performance, which then in term enables the detection of lower allele frequency variants, either through lower tumour burden or through the limited availability of DNA fragments from brain lesions due to the blood brain barrier <span class="citation" cites="2014">(<span>“ctDNA Is a Specific and Sensitive Biomarker in Multiple Human Cancers.”</span> 2014)</span>.

To show that even in longitudinal data, the joint analysis can boost the signal, we jointly variant called the diagnostic biopsy with only the three ctDNA samples and compared them with the results from the pairwise analysis. On average, we found 2905 additional variants in each of the ctDNA samples, which is more than double than the average number of variants found with the pairwise analysis (2414). Out of those, we found 534 variants in the ctDNA samples, which were found as a high confidence variant in the diagnostic sample, indicating that these findings are high quality calls.

Improved somatic variant calling in longitudinal data: Variant allele frequency (VAF) of variants found additionally through joint variant calling which were found as high confidence variants in the primary sample; Variants with less than 0.1 VAF in the primary are coloured grey; “T1 recovered“ shows variants, which were high confidence in all ctDNA samples but T1 and were only found through joint calling there; Axis label show the date of blood collection

Exactly like in the spatially different samples, in longitudinal data lower tumour purity samples benefit more from the joint analysis. We see that time point 2 (T2) has the highest amount of recovered variants (377) which are found as high confidence variants in both other time points ([[#fig:longitudinalVAFsctDNA|[fig:longitudinalVAFsctDNA]]] A vs. B vs. C) and T2 also has the lowest tumour purity in the cfDNA recorded (T1: 60%; T2: 20%; T3: 60%) however, there are still 106 variants, which were not found in the ctDNA samples at all with the pairwise analysis at all, even though they were high confidence variants in the primary sample ([[#fig:longitudinalVAFsctDNA|[fig:longitudinalVAFsctDNA]]]F). These variants usually show a lower depth of coverage (dp) in the ctDNA samples, which might indicate a problematic region in the genome, but rather than it not being called a variant, it is just a sign of incomplete data, which can be used with our joint approach.

Longitudinal data informs diagnostic variant calling: Vafs of variants additionally found through joint calling in the primary samples; Primary recovered by PASS shows variants which were high confidence in at least one ctDNA sample; Primary recovered joint shows variant which were low confidence in all samples in the pairwise analysis; Axis label show the date of blood collection

Finally, we can also find 398 additional variants in the primary sample. 398 were discarded due to missing data in the tissue sequencing, but could be found with a high confidence in the longitudinal data and two of the variants were included, as all 4 samples had this variant below the detection threshold ([[#fig:longitudinalVAFsprimary|[fig:longitudinalVAFsprimary]]]). The missing depth in the primary also leads to the occasional very high allele frequency of the variant, as all available reads show the variant, but their numbers are below the threshold normal variant callers will report variants.

This shows that both spatially and longitudinal related samples should be analysed jointly, as it substantially increases the amount of true variants found, which as shown before have a big impact on downstream analysis of the samples.

<span id="variantcalling-sec:clonal"></span>
=== Clonal deconvolution ===

Finally, the holy grail of analysis of multiple related samples from the same patient is the clonal deconvolution, where subclonal reoccurring patterns of mutations (clones) are resolved both spatially and longitudinally. These reoccurring clones can be linked to either parallel evolution through positive selection pressure, like a targeted drug, or to the process of developing Metastases where a piece of the cancer “breaks“ off and grows at a different site. Surprisingly, as it shares the same issue as the joint somatic variant calling of needing deeply sequenced data from multiple samples of the same organism, there is a plethora of algorithms and methods available for clonal deconvolution. Since 2015 PhyloWGS <span class="citation" cites="Deshwar2015">(Deshwar et al. 2015)</span>, Canopy <span class="citation" cites="Jiang2016">(Jiang et al. 2016)</span>, CLOE <span class="citation" cites="Marass2016">(Marass et al. 2016)</span>, CloneFinder <span class="citation" cites="Miura2018">(Miura et al. 2018)</span>, MACHINA <span class="citation" cites="ElKebir2018">(El-Kebir, Satas, and Raphael 2018)</span> and MOBSTER <span class="citation" cites="Caravagna2020">(Caravagna et al. 2020)</span> were published, to name a few. Underlying all these models is a form of clustering variants with similar variant allele frequency together, to reduce the combinatorial space and enhance the confidence in the signal <span class="citation" cites="Tarabichi2021">(Tarabichi et al. 2021)</span>. Due to the high number of tools, the challenge to select the right tool is substantial, especially since all of them have up and downsides <span class="citation" cites="Miura2020">(Miura et al. 2020)</span>. In this work I decided to use PhylogicNDT <span class="citation" cites="Leshchiner2018">(Leshchiner et al. 2018)</span> as it has been shown to work well on clinical samples <span class="citation" cites="Gerstung2020">(Gerstung et al. 2020)</span> and does not have the restriction for the input to be from copy number neutral areas which many of the other tools have.

The analysis was conducted by transforming the variants called with the joint workflows as well as the default pairwise analysis into the required file format without the cancer cell fraction part, in order to let PhylogicNDT calculate those on the fly. The local copy numbers for each variant is generated by intersecting the called segments from sequenza with the position of the variants. Variants which could not be assigned a local copy number change were discarded from the analysis.

Reconstructed clonal trees from PhylogicNDT; Blue circle at top depicts the germline/normal state. The coloured edges with the same coloured circle represents a distinct subclone of the parent from which the edge emerges; The number in braces next to the edge is the number of mutations which define this subclone with an added gene symbol added, if there is a cancer driver gene mutation. The left part shows the result when using the default pairwise method of Strelka2 and the right side uses the results from the Strelka2Pass workflow

[[#fig:clonaldeconv|[fig:clonaldeconv]]] shows the highest parsimony clonal tree reconstructed by PhylogicNDT for the pairwise as well as the joint variant calling. As the copynumber calling information is the same for both inputs, the only difference is in the called variants. While there was no subclonal structure detected at all for the pairwise analysis, there is a highly variable structure detected using the jointly called variants. As this is a clinical sample, we cannot 100% be sure that the more branched model is the actual truth, but its biologically more logical that a late stage cancer has developed several subclones, rather than it being a very homogeneous disease at all of the 10 sites at autopsy with no evolution over ten years of disease <span class="citation" cites="Gerstung2020">(Gerstung et al. 2020)</span>. It is of particular interest, that the ''CDC27'' gene got mutated at different time points in different clones (clone 8 vs. clone 4), which a clear sign of parallel evolution, which would definitely be missed without the joint analysis.

<span id="variantcalling-sec:fullphylo"></span>
=== Longitudinal enriched phylogeny ===

Of course it is finally also possible to build a phylogeny with the spatial tissue samples and the longitudinal ctDNA samples. However, as the ctDNA give a holistic view of all cancer metastases ([[#intro-sec:ctDNA|[intro-sec:ctDNA]]]) the interpretation needs to accommodate for that.

Reconstructed phylogeny with longitudinal ctDNA samples: Tree from [[#fig:ca9phylo|[fig:ca9phylo]]] with three additional ctDNA samples from different time points about one year prior to death. The ruler shows the equivalent of 2000 mutations

The maybe most surprising thing is that the more temporally distant ctDNA samples from 17.09.2012 and 30.04.2013 are in a subclade together, away from the “ctDNA 30.11.2012“ sample. Secondly, the addition of the ctDNA samples also lead to a further bipartition edge, which separates “r. liver lobe“, “small bowel“ and “r. cereb. lobe“ from the rest of the tree ([[#fig:phyloCA9ctDNA|[fig:phyloCA9ctDNA]]]). This was already inferable from the topology of the previous tree in [[#fig:tanglePhyloCA9|[fig:tanglePhyloCA9]]] “joint“, but is even more pronounced with the inclusion of the ctDNA samples.

This shows that the addition of more samples helps to refine and improve the trajectory and history of cancer samples and it is vital to do this analysis jointly to generate the optimal result.

<span id="variantcalling-sec:usage"></span>
== Usage - it’s not just me that thinks it is good ==

As amazing as published open source software is, its real value is in the re-usability and portability. Many published software packages are not maintained or not even functional even though they are published. While I developed these joint somatic variant calling workflows to deal with a challenge I faced, many other people even just at the same institute have already shown interest and some research groups are already using the software to analyse their multi-sample data.

Cumulative download numbers of the “dawsontoolkit“ docker container since publication of the manuscript; Actual counts are shown as dots, with smoothed trajectory depicted as dotted line with the 95% confidence interval shown as a grey background; confidence interval has been adjusted with exponential decay of prediction accuracy with distance from the last data point; Start date 7[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5E%7Bth%7D|class=math inline|^{th}]] September 2021 (publication of method); End point prediction 8[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5E%7Bth%7D|class=math inline|^{th}]] April 2022 (End of candidature); Numbers were recorded daily from the DockerHub API

To have some proxy of the usage statistics of the workflows, I recorded the download numbers of the “dawsontoolkit“ docker container after the publication of the manuscript. The container only consists of software for refiltering and joint analysis of the workflows . Obviously, this is an imperfect measurement, as people can reuse a downloaded container as often as they want, which would not appear in the count and similarly, just because the container was downloaded, the analysis might not have been used. Nevertheless, it still shows an interaction and an interest in the methods. The download numbers show a sustained and stable increase in downloads ([[#fig:usageStats|[fig:usageStats]]]). This suggests, that there is a need in the methods, rather than a simple curiosity after publication, which hopefully will facilitate a higher quality analysis of future projects and therefore lead to a better understanding of cancer evolution and heterogeneity.

<div class="savequote">

“Death is a release from and an end of all pains: beyond it our sufferings cannot extend: it restores us to the peaceful rest in which we lay before we were born“


</div>
<span id="ch:cascade"></span>
= CASCADE - Late stage lung cancer in the spotlight =

<span id="cascade-sec:intro"></span>
== Introduction ==

<span id="intro-sec:lungcancer"></span>
=== Lungcancer ===

With around 1.6 million deaths world-wide each year, lung cancer is the number one cause of cancer death <span class="citation" cites="Siegel2018">(Siegel, Miller, and Jemal 2018)</span>. Every year about twelve thousand Australians get diagnosed with lung cancer. These cases can be generally split into two groups: small cell lung cancers (SCLC) and non-small cell lung cancers (NSCLC), which account for around 15% and 85% of cases, respectively. The majority of NSCLC are either lung adenocarcinoma or lung squamous cell carcinoma <span class="citation" cites="Molina2008">(Molina et al. 2008)</span>. Even though smoking is highly associated with lung cancers, there is a big group of never smokers, with a high risk of lung cancers in East Asia, especially women, which is correlated with outside influences like pollution and occupational carcinogens and paired with genetic susceptibility <span class="citation" cites="Sun2007">(Sun, Schiller, and Gazdar 2007)</span>. This group usually shows ''EGFR'' (epidermal growth factor receptor) driven tumours. EGFR is a transmembrane receptor tyrosine kinase, which is usually only expressed in epithelial, mesenchymal, and neurogenic tissue, but its overexpression in other tissues is a hallmark of many human malignancies, not just NSCLC.

<span id="cascade-sec:publication"></span>
== Publication ==

This chapter includes the data analysis for two two publications. The first publication features the resistance mechanism of small cell transformation ([https://doi.org/10.1016/j.ccell.2019.08.008 <code>https://doi.org/10.1016/j.ccell.2019.08.008</code>]<span class="citation" cites="Burr2019">(Burr et al. 2019)</span>) and the second shows the discovery of resistance to a targeted RET-fusion driven cancer ([https://doi.org/10.1016/j.jtho.2020.01.006 <code>https://doi.org/10.1016/j.jtho.2020.01.006</code>]<span class="citation" cites="Solomon2020">(Solomon et al. 2020)</span>)

<span id="cascade-sec:cohort"></span>
== Cohort analysis ==

<span id="cascade-sec:mitochondria"></span>
== Mitochondrial phylogenetic reconstruction - the power house of the phylogenies ==

<span id="cascade-sec:outlook"></span>
== Outlook ==

<div class="savequote">

“When the sum is already greater than the parts, there is room to make it greater still.“


</div>
<span id="ch:mmf"></span>
= MisMatchFinder - hope springs eternal =

<span id="mmf-sec:intro"></span>
== Introduction ==

While even very early on, researchers realised, that cancers have different morphologies and clinical progression depending on the primary occurrence of the tumour ([[#intro-sec:cancer|[intro-sec:cancer]]]), with the extensive sequencing of cancer specimen over the last decade, the mutational signatures of cancers came into focus. These signatures are specific and characteristic combinations of mutations, which stem from distinct biological processes. These processes include exposure to DNA damaging agents like Chemotherapy treatment, tobacco and UV, as well as biological intrinsic pathways errors in DNA-replication or -repair. As each of those processes has a more or less distinct profile of mutations <span class="citation" cites="Hollstein1991 Kucab2019">(Hollstein et al. 1991; Kucab et al. 2019)</span> the analysis and deconvolution of the signatures involved in a patients mutational landscape can help diagnosing and treating a patient. While many signatures occur at a background level and are related to “normal“ cellular processes like ageing <span class="citation" cites="Alexandrov2013">(Ludmil B. Alexandrov et al. 2013)</span>, others can point to defective mismatch repair or gain of function mutations in specific pathways, which then lead to new avenues of therapy for the patient <span class="citation" cites="OtextquotesingleNeil2017">(ONeil, Bailey, and Hieter 2017)</span>.

Supplementary information and plots for this chapter are attached in the appendix and prepended with [[#ch-mmfSuppMeth|7]].

<span id="mmf-sec:signatureanalysis"></span>
=== Mutational signature analysis ===

Traditionally the cancer mutational signature analysis entails a somatic variant calling process ([[#intro-sec:variantcalling|[intro-sec:variantcalling]]]) followed by a counting and deconstructing step, which assigns weights to the individual signatures. These signatures are precompiled list of mutation count relations ([[#fig:sig7a|[fig:sig7a]]]). While the individual SNP already contains valuable information, there is an improvement in granularity when also counting the base up and downstream of the change. This expands the feature space of counts from the six base classes of SNPs (C&gt;A, C&gt;T, C&gt;G, T&gt;C, T&gt;A, and T&gt;G)to 96 unique trinucleotide contexts <span class="citation" cites="Alexandrov2013">(Ludmil B. Alexandrov et al. 2013)</span>. While there technically are six more base changes and many more trinucleotide contexts combinatorially possible, they can be collapsed into the afore mentioned ones by using the reverse complement.

Trinculeotide count contributions for SBS signature 7a (UV exposure); values taken from <span class="citation" cites="Alexandrov2020">Ludmil B. Alexandrov et al. (2020)</span>

Additionally to the single base substitution (SBS) there now exist doublet base substitution signatures and InDel signatures for somatic mutations of cancers <span class="citation" cites="Alexandrov2020">(Ludmil B. Alexandrov et al. 2020)</span>, which are all based on the same principle and enable a higher precision for stratification of similar cancer subtypes and DNA damaging agents.

<span id="restrictions-and-pitfalls-of-standard-signature-analysis"></span>
=== Restrictions and pitfalls of standard signature analysis ===

Especially for cancer samples, the focus is usually on somatic variants of the sample. This requires a fairly deep sequencing of the tumour sample with at least WES, better WGS, and for optimal results, a germline sample for tumour-normal variant calling is required as well to not have noise from potentially missed germline variants ([[#intro-sec:somaticcalling|[intro-sec:somaticcalling]]]). This means the cost of the data of the analysis is surprisingly high for a fairly diffuse result of signatures that contribute to the variants found. This is especially relevant when it comes to clinical diagnostic tools, where every biopsy of the patient is valuable and a germline sample might not always be available. For an analysis, which is based on the averaged and aggregated somatic variants to require a high quality input seems counter-intuitive. Especially as the analysis will always report signatures, even if there are virtually no variants reported, it will still suggest a mixture of potentially clinically relevant signatures, even if the patient is healthy.

<span id="overview"></span>
=== Overview ===

These reasons make the actual analysis, which should come as a first step to inform both clinicians and pathology what to look out for more of a side arm, which is nice to have but not significant or informative. In this chapter I will describe a newly developed method, which allows the detection of somatic signatures from low coverage WGS of cfDNA. This allows the non-invasive monitoring of patients and possibly screening of at-risk individuals with very little cost.

<span id="mmf-sec:methods"></span>
== Methods ==

With the change from a variant focused approach to a read based method, this new method will call “mismatches“ of a read from the reference genome, rather than a variant. This has the advantage of not requiring a matched normal and its use for virtually any sequencing data source, be it TAS, WES, WGS or even nanopore sequencing[[#fn2|<sup>2</sup>]]. However it also means, that the error suppression method, which are usually used by variant calling methods like read position ranks sum (RPRS) or strand bias are not usable, which leads to a higher degree of background noise. In the following sections I will describe how we filter and curate the found mismatches to retain as much signal as possible.

<span id="mmf-sec:concept"></span>
=== Mathematical concept ===

With the change from site based method, the concept of a mismatch from the reference needs to be introduced. A mismatch in the following is any position in an aligned read, which does not show the same base as the reference at the aligned position. The mismatch will inherit all the metrics of the read such as mapping quality, base quality and read position.

This then means, there are three sources of mismatches in a read, which are somatic variants, germline variants and sequencing errors ([[#mmf-eq:1|[mmf-eq:1]]]). [[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20n%28mismatches%29%20%3D%20n%28somatic~var.%29%20%2B%20n%28germline~var.%29%20%20%2B%20n%28seq.~%20error%29%0A%5Clabel%7Bmmf-eq%3A1%7D|class=math display|n(mismatches) = n(somatic~var.) + n(germline~var.) + n(seq.~ error) \label{mmf-eq:1}]]

With the sequencing error being a function of the sequencing machine and chemistry, the error rate should be a stable almost constant, when using the same sequencing machine and chemistry <span class="citation" cites="Schirmer2016 Stoler2021">(Schirmer et al. 2016; Stoler and Nekrutenko 2021)</span>. We can therefore reduce [[#mmf-eq:1|[mmf-eq:1]]] to [[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20n%28mismatches%29%20%3D%20n%28som.~var.%29%20%2B%20n%28germ.~var.%29%20%20%2B%20c_%7Bseq.~err.%7D%0A%5Clabel%7Bmmf-eq%3A2%7D|class=math display|n(mismatches) = n(som.~var.) + n(germ.~var.) + c_{seq.~err.} \label{mmf-eq:2}]]

Secondly, the number of germline variants is approximately the same between two people <span class="citation" cites="Auton2015">(Auton et al. 2015)</span>, which again simplifies [[#mmf-eq:2|[mmf-eq:2]]] by replacing [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20n%28germline~var.%29|class=math inline|n(germline~var.)]].

[[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20n%28mismatches%29%20%3D%20n%28som.~var.%29%20%2B%20c_%7Bgerm.~var.%7D%20%2B%20c_%7Bseq.%20err.%7D%0A%5Clabel%7Bmmf-eq%3A3%7D|class=math display|n(mismatches) = n(som.~var.) + c_{germ.~var.} + c_{seq. err.} \label{mmf-eq:3}]]

Of course, [[#mmf-eq:3|[mmf-eq:3]]] is a crude approximation and instead the constants are not real constants, but instead are better approximated with Gaussian distributions which leads to the following equation

[[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20n%28mismatches%29%20%3D%20n%28som.~var.%29%20%2B%20%5Cmathcal%7BN%7D%28%5Cmu_%7Bgerm.~var.%7D%2C%20%5Csigma_%7Bgerm.~var.%7D%5E%7B2%7D%29%20%2B%20%5Cmathcal%7BN%7D%28%5Cmu_%7Bseq.~err.%7D%2C%20%5Csigma_%7Bseq.~err.%7D%5E%7B2%7D%29%0A%5Clabel%7Bmmf-eq%3A4%7D|class=math display|n(mismatches) = n(som.~var.) + \mathcal{N}(\mu_{germ.~var.}, \sigma_{germ.~var.}^{2}) + \mathcal{N}(\mu_{seq.~err.}, \sigma_{seq.~err.}^{2}) \label{mmf-eq:4}]]

However, both [[#mmf-eq:3|[mmf-eq:3]]] and [[#mmf-eq:4|[mmf-eq:4]]] allow to make the conclusion, that with small enough values for either [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20c_%7Bgerm.~var%7D%2Fc_%7Bseq.~err.%7D|class=math inline|c_{germ.~var}/c_{seq.~err.}]] or [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Cmu_%7Bgerm.~var%7D%2F%5Cmu_%7Bseq.~err.%7D|class=math inline|\mu_{germ.~var}/\mu_{seq.~err.}]] and [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Csigma_%7Bgerm.~var%7D%2F%5Csigma_%7Bseq.~err.%7D|class=math inline|\sigma_{germ.~var}/\sigma_{seq.~err.}]] respectively, there is a linear correlation between the amount of mismatches on a read and the somatic variants it contains:

[[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20n%28mismatches%29%20%5Csim%20n%28som.~var.%29%0A%5Clabel%7Bmmf-eq%3Afinal%7D|class=math display|n(mismatches) \sim n(som.~var.) \label{mmf-eq:final}]]

With the help of [[#mmf-eq:final|[mmf-eq:final]]] we can approximate tumour mutational burden and signatures from individual reads. This method is therefore independent from read depth and requires no matched normal sample for somatic variant calling.

<span id="data-preprocessing"></span>
=== Data preprocessing ===

As this new method has sophisticated internal measures to filter and process sequencing data, the steps for preprocessing are minimal: The reads only need to be aligned to a reference genome ([[#intro-sec:mapping|[intro-sec:mapping]]]). For optimal mapping and additional noise reduction, paired end sequencing of at least 75 bp is suggested. This ensures a few bases overlap on the standard fragment length of less than 150bp of ctDNA ([[#intro-sec:ctDNA|[intro-sec:ctDNA]]]). Another optional suggested step is the duplication marking of the BAM file.

<span id="mismatch-detection"></span>
=== Mismatch detection ===

In contrast to conventional variant calling approaches, which find regions of interest through pileups (position wise) and then realign reads in the surrounding area, to accurately estimate the most likely event that lead to the observed haplotype ([[#intro-sec:variantcalling|[intro-sec:variantcalling]]]), with this new method, we take every individual read as a separate entity to fully span the heterogeneity of all cells and their genetic background. A sequencing reads “MD“- and “CIGAR“- tag from the preprocessed BAM file are used to reconstruct the sequence of the read and the positions, where the read shows a different base than the reference. These potential mismatch sites will then filtered in multiple steps to reduce the impact of both germline variants as well as sequencing errors

<span id="filtering-steps"></span>
=== Filtering steps ===

Apart from the filters, which most variant callers will employ, like mapping quality (MQ) and base quality (BQ), which are used to ignore reads as well as positions respectively, the method also internally filters out common sequencing errors next to homopolymer regions <span class="citation" cites="Heydari2019">(Heydari et al. 2019)</span>. While these cutoffs were preselected by me for optimal performance on our data (MQ=20, BQ=55, homopolyLength=5), the program allows the user to adjust them to their liking. This is also possible for both the region of interest (ROI) bed-file which was used to restrict the analysis to only highly mappable regions of the genome ([[#ch-mmfAppendix:bedfiles|[ch-mmfAppendix:bedfiles]]]), as well as for multiple other parameters which are unique to our method, like minimum average base quality, minimum and maximum number of mismatches per read and/or fragment, and the minimum and maximum length of a fragment <span class="citation" cites="Hudecova2021">(Hudecova et al. 2021)</span>. If any of these values are not within the specified range a read will be discarded in the analysis. This is also the default for reads which have a secondary alignment position or are considered duplicates of any kind.

<span id="mmf-sec:consensus"></span>
=== Consensus reads - what happens when the sequencer isn’t sure ===

When paired end sequencing of ctDNA is analysed, the fraction of fragments where reads overlap is higher, than with “normal“ tissue based sequencing, due to the shorter fragment length of ctDNA ([[#intro-sec:ctDNA|[intro-sec:ctDNA]]]). This allows an fragment internal consensus generation, by adjusting for differences between forward and reverse read. In many variant calling methods, these differences are used by measuring the “strand bias“ <span class="citation" cites="Guo2012 Saunders2012 GATKTeam2019">(Guo et al. 2012; Saunders et al. 2012; GATK Team 2019)</span> or “strand balance probability“ <span class="citation" cites="Garrison2012">(Garrison and Marth 2012)</span> by looking at a specific locus and evaluating the discrepancy of all forward and all reverse reads. As our method evaluates each read/fragment independently, the bias cannot be calculated, however in the overlapping region of both reads, a consensus can be generated. If both reads agree on the mismatch, the BQ of both reads will be added together to emphasise the increased evidence for this variants. However, if they disagree the base of the higher quality will be used and its quality will be decreased by half of the BQ of the lower quality base ([[#fig:mmf-consensus|[fig:mmf-consensus]]] bottom). To increase the stringency of the method, the user can also enable the ‘''–strictOverlap''’  option, which will only consider a mismatch, if both reads agree with each other and decrease the BQ to zero otherwise. As we are only interested in mismatches from the reference, all positions where both agree with the reference are irrelevant for the analysis and will be discarded ([[#fig:mmf-consensus|[fig:mmf-consensus]]] top). For the most stringent analysis, MisMatchFinder can additionally be configured to only use mismatches in the overlap part of a fragment (‘''–onlyOverlap''’), which significantly reduces the number of sequencing errors which end up in the final analysis ([[#mmf-sec:cleanSim|[mmf-sec:cleanSim]]]).

Schematic of consensus computation method for overlapping reads in MisMatchFinder; Read 1 and Read 2 depict two overlapping paired end reads aligned to the reference sequence; Positions in the overlap are numbered for later referral; Read positions agreeing with the reference are coloured black, positions differing from the reference but agreeing in both reads are coloured purple (position 3) and differences between reads are coloured in the respective read colours (blue and red, position 6); Calculation for the resulting base quality (BQ[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20_%7Bcons%7D|class=math inline|_{cons}]] for each possibility is shown as formulas)

<span id="mmf-sec:germline"></span>
=== Germline filtering - exclusion of normal variation ===

To further enable the [[#mmf-sec:concept|[mmf-sec:concept]]] claim that the germline is a very small constant, we need to remove as many mismatches as possible, which stem from germline variants. For this purpose, I built a zarr <span class="citation" cites="Miles2021">(Miles et al. 2021)</span> based storage system from the gnomAD database (v.3.1) <span class="citation" cites="Karczewski2020">(Karczewski et al. 2020)</span> using scikit-alel <span class="citation" cites="Miles2021a">(Murillo R.; Peter Ralph; Nick Harding; Rahul Pisupati; Summer Rae; Tim Millar 2021)</span>. A in-depth explanation of the generation as well as a script for for an end user can be found in [[#ch-mmfAppendix:germlineFilter|[ch-mmfAppendix:germlineFilter]]].

This then allows very precise filtering of known germline variants sites from the analysis. The method allows the specification of an allele frequency to consider a variant to be filtered, however as baseline, it will filter all sites, which were detected in any sample in gnomAD. This even includes sites with low quality variants, as these are signs for sequencing or mapping complications, which will most likely interfere with our method as well.

<span id="mmf-sec:countNorm"></span>
=== Count normalisation - not everyone has the same chances ===

Finally when having filtered all “noise“ mismatches from the dataset, we can aggregate all mismatches to oligo-nucleotide counts. With this step also comes the classification of directly neighbouring mismatches as DBS, which are counted as separate entities. SBS and DBS both can be used to identify underlying biological mutational processes, but they have very different signatures associated with them <span class="citation" cites="Alexandrov2020">(Ludmil B. Alexandrov et al. 2020)</span>. The counts formed this way are influenced by the background frequency of their reference oligo-nucleotides in the analysed genomic region. As the frequencies of di- and tri-nucleotides are not uniform in the genome, the chance for a mismatch found in an “AAA“ reference contex is almost seven times higher than a mismatch in “CGC“ ([[#A:mmf:tab:tricounts|[A:mmf:tab:tricounts]]], [[#A:mmf:tab:dicounts|[A:mmf:tab:dicounts]]]). To reduce this bias towards high frequency oligo-nucleotides, I implemented a count normalisation step.

First the di- and tri-nucleotides in the analysed regions are counted using the supplied reference without any black-listed and/or only in white-listed regions. These counts are then either used to directly weight the observed mismatch counts, which leads to a more uniform distribution of mismatches, or by building a fraction of observed oligo-nucleotides and the total counts in the genome ([[#A:mmf:tab:tricounts|[A:mmf:tab:tricounts]]], [[#A:mmf:tab:dicounts|[A:mmf:tab:dicounts]]]), the weighting achieves an approximation of how the counts would be distributed over the whole genome. These two options are available with ‘''–normaliseCounts''’  for the approximation to full genome. By also adding ‘''–flatNormalisation''’  only the observed counts are used for normalisation.

<span id="mmf-sec:sigDeconv"></span>
=== Signature deconvolution - find the original signal ===

The deconvolution of the involved signatures from known set of signatures is equivalent to finding the minimal distance between [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20m|class=math inline|m]] as the observed number of mismatches in each oligo-nucleotide context (a vector of length 96) and [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Ctextbf%7BS%7Dw|class=math inline|\textbf{S}w]], where [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Ctextbf%7BS%7D|class=math inline|\textbf{S}]] is the matrix of oligo-nucleotide defined contributions for each signature, resulting in a matrix of [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%2096%20%5Ctimes%20k|class=math inline|96 \times k]] with [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20k|class=math inline|k]] being the number of known signatures. Lastly, [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20w|class=math inline|w]] is the vector of weights of each signature, which we want to estimate.

[[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cbegin%7Baligned%7D%0A%20%5Ctext%7Bminimise%3A%7D%20%26%20%5Cquad%20%28m%20-%20%5Ctextbf%7BS%7Dw%29%5ET%28m%20-%20%5Ctextbf%7BS%7Dw%29%0A%20%3D%20m%5ETm%20-%20w%5ET%5Ctextbf%7BS%7D%5ETm%20-%20m%5ET%5Ctextbf%7BS%7Dw%20%2B%20w%5ET%5Ctextbf%7BS%7D%5ET%5Ctextbf%7BS%7Dw%20%5Clabel%7Bmmf-eq%3Aoptim1%7D%5C%5C%0A%20%5Ctext%7Bwith%3A%7D%20%26%20%5Cquad%20%5Csum_j%20w_j%20%3D%201%20%5Cquad%20%5Ctext%7Band%7D%20%5Cquad%20%5Cboldsymbol%7B%5Cforall%7D%20j%20~%20w_j%20%5Cgeq%200%20%5Clabel%7Bmmf-eq%3Arequirements%7D%5Cend%7Baligned%7D|class=math display|\begin{aligned} \text{minimise:} &amp; \quad (m - \textbf{S}w)^T(m - \textbf{S}w) = m^Tm - w^T\textbf{S}^Tm - m^T\textbf{S}w + w^T\textbf{S}^T\textbf{S}w \label{mmf-eq:optim1}\\ \text{with:} &amp; \quad \sum_j w_j = 1 \quad \text{and} \quad \boldsymbol{\forall} j ~ w_j \geq 0 \label{mmf-eq:requirements}\end{aligned}]]

[[#mmf-eq:optim1|[mmf-eq:optim1]]] can then be written as

[[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Ctext%7Bminimise%3A%7D%20%5Cquad%20-%20m%5ET%5Ctextbf%7BS%7Dw%20%2B%20%5Cfrac%7B1%7D%7B2%7Dw%5ET%5Ctextbf%7BS%7D%5ET%5Ctextbf%7BS%7Dw%0A%5Clabel%7Bmmf-eq%3Aoptim2%7D|class=math display|\text{minimise:} \quad - m^T\textbf{S}w + \frac{1}{2}w^T\textbf{S}^T\textbf{S}w \label{mmf-eq:optim2}]]

With the same restrictions as shown in [[#mmf-eq:requirements|[mmf-eq:requirements]]]. These equations and the idea to solve it with quadratic programming (QP) have been taken from <span class="citation" cites="Lynch2016">Lynch (2016)</span>, the iterative linear models (ILM) solving approach was adapted from deconstructSigs <span class="citation" cites="Rosenthal2016">(Rosenthal 2016)</span>. Both methods are reimplemented in python in MisMatchFinder, using the quadprog package <span class="citation" cites="McGibbon2021">(McGibbon et al. 2021)</span> for QP and a translation of the R code of deconstructSigs for ILM.

MisMatchFinder allows the use of either QP or ILM, as they in many cases produce very similar results <span class="citation" cites="Lynch2016">(Lynch 2016)</span>. The default method is QP however, even though ILM is the more interpretable method and is the more parsimonious method, because with the increased number of signatures, in the latest work by <span class="citation" cites="Alexandrov2020">Ludmil B. Alexandrov et al. (2020)</span>, ILM does not lead to the right signatures if the signal is not strong enough but QP seems to be more stable ([[#fig:mmf-ILMerror|[fig:mmf-ILMerror]]]).

Distances of the estimated weights generated with ILM and QP from the true weight used as input; Truth is a synthetic count sample with (SBS1: 0.25; SBS3: 0.05; SBS5: 0.46; SBS7a: 0.1; SBS19: 0.03; SBS21: 0.01; SBS31: 0.08; SBS57: 0.02;)

The combinatorial problem in ILM, already shown by <span class="citation" cites="Lynch2016">Lynch (2016)</span>, seems to be especially strong with “wide“ signatures like SBS3 ([[#fig:sig7a|[fig:sig7a]]]) and low signature contribution. That makes it less useful for our approach, as we expect low tumour purity and therefore low somatic signature signals in cfDNA, but even with ILM as deconvolution method impacts the detection of SBS7a less than the detection of SBS3 ([[#fig:mmf-qpVSilm|[fig:mmf-qpVSilm]]]).

The deconvolution method might be a spot for further optimisation by creating a custom deconvolution system adjusted for ctDNA detection.

<span id="mmf-sec:results"></span>
== Results ==

In this section I will present the results when applying MisMatchFinder to various different datasets. First the evaluation of the method on simulated data, which allows accurate and definitive insight into the sensitivity and a proof of concept ([[#mmf-sec:simulated%20data|[mmf-sec:simulated data]]]). Then the analysis of real world applications is displayed in [[#mmf-sec:realworld|[mmf-sec:realworld]]] demonstrating that the method does not only work in cleanly simulated data, but find clinically relevant insight in patient samples.

<span id="mmf-sec:simulated data"></span>
=== Simulated Data - the validation promised land ===

Just like in [[#ch:variantcalling|[ch:variantcalling]]], the novelty of the approach leads to the issue of no gold standard dataset, with which to evaluate the performance of a new method. While there are low coverage WGS datasets of cancer patients, none of them have validated signatures associated with them. So again simulated data is the optimal starting point to allow both optimisation of parameters as well as granular detection of artefacts which can originate from any step starting from sequencing over mapping to the signature deconvolution.

<span id="mmf-sec:cleanSim"></span>
==== Sequencing errors - there is always a cleaner data ====

To judge the ability of our approach to filter out sequencing errors, we first simulated “clean“ sequencing reads with neither germline or somatic variants with the ART simulation suite <span class="citation" cites="Huang2011">(Huang et al. 2011)</span>. As current estimates of Illumina sequencing is in the range of 1 in 666 to 1 in 1149 <span class="citation" cites="Stoler2021">(Stoler and Nekrutenko 2021)</span> which is significantly higher than even the highest tumour mutational burdens of cancers (melanoma: 1 in 5k; tobacco smoking lung cancer: 1 in 100k) it is very important to be able to eliminate as much of the background noise of sequencing errors as possible.

Mismatchrate of different filtering methods on sequencing data simulated with ART<span class="citation" cites="Huang2011">(Huang et al. 2011)</span> for both 10x and 3x coverage; Mismatches correspond to simulated sequencing errors; all: no filters, overlap: only use the overlapping parts of paired end reads with consensus building ([[#mmf-sec:consensus|[mmf-sec:consensus]]]), strict OL: overlap but reads ''must'' agree, high BQ strict OL: strict OL with high BQ in both variants; A) Absolute counts B) counts from A normalised by the number of analysed bases all: all aligned bases, other: number of bases in read overlap

By only using high base quality mismatches, where both reads agree on the mismatch 99.98% of all sequencing errors can be eliminated and only 1 in 10M bases will be wrongly counted as a variant ([[#fig:mmf-mismatchrate|[fig:mmf-mismatchrate]]]). This false discovery rate is multiple orders of magnitude lower than before and in a similar range to normal mutationally driven cancers tumour mutational burden <span class="citation" cites="Alexandrov2020 Lawrence2013a">(Ludmil B. Alexandrov et al. 2020; Lawrence et al. 2013)</span>.

<span id="mmf-sec:simSingnatures"></span>
==== Spike-in signature detection ====

With the technical error eliminated in simulated data, the question was would our method work in a real world data, however to establish a baseline for detection limit and sensitivity of the method, we decided to first use a hybrid approach, were we spike-in somatic variants into a genuine low coverage WGS sequencing of a healthy control. That reduces the amount of unknown variability from other published datasets.

While it would be possible simulate the variants completely de novo, without any prior knowledge, we know that somatic mutations follow a certain pattern and there a mutational hotspots <span class="citation" cites="Chen2016 Moore2021">(T. Chen et al. 2016; Moore et al. 2021)</span>, so we decided to instead use the COSMIC database <span class="citation" cites="Tate2018 WSI2021">(Tate et al. 2018; Wellcome Sanger Institute 2021)</span> as the to select mutations from. This allows us to select mutations, which definitely occurred in a specific cancer subtype, which leads to a simulation which closer resembles real data. The in-depth protocol is shown in [[#ch-mmfAppendix:spikein|[ch-mmfAppendix:spikein]]]. The downside of this method is that the spike-in will not predominantly happen on shorter fragments, as it would be the case with ctDNA.

In the following section I will discuss the results for the simulation of the very prominent SBS7a signature (see [[#fig:sig7a|[fig:sig7a]]])which is predominantly present in Melanoma (see [[#mmf-sec:melaSim|[mmf-sec:melaSim]]]) and secondly the much flatter and more uniform SBS3 (see [[#A:fig:sig3|[A:fig:sig3]]]), which is a sign of defective homologous recombination in breast cancers ([[#mmf-sec:mbcSim|[mmf-sec:mbcSim]]]).

Signature analysis results of spiked-in somatic variants; signatures with a weight less than 1% were collated into “unknown“; The original spike-in signature was coloured in green (SBS3) and red (SBS7a), unrelated signatures are coloured white and signatures corresponding to sequencing artifacts are coloured in lightgrey; r0.1 corresponds to approximately 0.1 variants per mega base; Weights were generated with deconstructSigs <span class="citation" cites="Rosenthal2016">(Rosenthal 2016)</span>

The spike-in was done at multiple different ratios, to simulate varying tumour purity. [[#fig:mmf-spikeinsanity|[fig:mmf-spikeinsanity]]] shows the signature analysis result of the lowest spike-in ratio “r0.1“ which corresponds to 0.1 somatic variants per mega base and results in approximately 300 variants for the whole genome. As the spike-in process has to satisfy certain quality measures, not all candidate variants can be used. As such, the final simulated BAM contains 264 additional variants for the SBS3 simulation and 287 for the SBS7a equivalent. That corresponds to 304 and 364 “tumour“ reads respectively within the [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Capprox|class=math inline|\approx]] 261 million reads of the simulated BAM. With increasing ratio, the spike-in signatures show decreasing weights for other signatures, which likely got introduced due to the incomplete spike-in ([[#ch-mmfAppendix:spikein|[ch-mmfAppendix:spikein]]]).

<span id="mmf-sec:melaSim"></span>
===== Melanoma - UV exposure =====

<span id="mmf-sec:mbcSim"></span>
===== BRCA1/2 - Defective homologous recombination-based DNA damage repair =====

<span id="mmf-sec:germlinefiltering"></span>
==== Germline filtering ====

With real patient data, we can evaluate the effect of removing germline variants from the analysis is. For this I used the same simulated samples from above ([[#mmf-sec:simSingnatures|[mmf-sec:simSingnatures]]]), where the reads are original ctDNA reads for a healthy person.

<span id="mmf-sec:germlineArtifacts"></span>
==== Germline artifacts ====

Now that we have shown how important the germline filtering step is to enable the method, we were interested, how many germline variants of the sample were still retained after our filtering with known variants ([[#mmf-sec:germline|[mmf-sec:germline]]]). For this purpose I called germline variants on the original healthy individual using Strelka2 and compared the called variants with the sites which MisMatchFinder found to be somatic (retained after germline filtering)

<span id="mmf-sec:realworld"></span>
=== Real world data - the only things that matters ===

<span id="mmf-sec:healthy"></span>
==== Healthy cohort ====

<span id="mmf-sec:brcapatients"></span>
==== BRCA positive patient samples ====

The first dataset of patients is two previously published BRCA1/2 positive breast cancers. The data contains matched tumour, germline and ctDNA sequencing as high depth WGS for both patients. With the matched normal, we can use the current standard protocol of somatic mutational pattern analysis ([[#mmf-sec:signatureanalysis|[mmf-sec:signatureanalysis]]]) and compare it with our new method.

As the sequencing data of the ctDNA is much higher depth than what is used in standard clinical practice, we down sample the data to 10x. By using numerous different seeds for the sampling, we can generate pseudo technical replicates of the sequencing ([[#ch-mmfAppendix:subsampling|[ch-mmfAppendix:subsampling]]]), which then in term can give an approximation of the stability of the results for both the tissue and the ctDNA samples .

<span id="mmf-sec:melpatients"></span>
==== Melanoma patients ====

<span id="summary-1"></span>
=== Summary ===

<div class="savequote">

“As you think, so you become. Our busy minds are forever jumping to conclusions, manufacturing and interpreting signs that aren’t there.“


</div>
<span id="ch:conclusion"></span>
= Conclusion =

we should have some stuff to write here in the end

<span id="Bibliography" label="Bibliography"></span>

<div class="center">

<span>''''</span>

by

contains:

* published manuscripts
* supplementary method
* supplementary figures


</div>
<span id="ch:appendixManuscript"></span>
= Custom workflows to improve joint variant calling from multiple related tumour samples: FreeBayesSomatic and Strelka2Pass =

This appendix contains the manuscript published at ''Bioinformatics'' in an non journal style format with the supplementary methods and figures. It can also be found at [https://doi.org/10.1093/bioinformatics/btab606/6361543 10.1093/bioinformatics/btab606/6361543] for a paper style version.


-----

<span>'''Hollizeck S.[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5E%7B1%2C2%7D|class=math inline|^{1,2}]], Wong S.Q.[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5E%7B1%2C2%7D|class=math inline|^{1,2}]], Solomon B.[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5E%7B1%2C2%7D|class=math inline|^{1,2}]], Chandrananda D.[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5E%7B1%2C2%2C%2A%7D|class=math inline|^{1,2,*}]], and Dawson S-J.[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5E%7B1%2C2%2C3%2C%2A%7D|class=math inline|^{1,2,3,*}]]'''</span>

<span> [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5E1|class=math inline|^1]] Peter MacCallum Cancer Centre, Melbourne 3000, Victoria, Australia<br />
[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5E2|class=math inline|^2]] Sir Peter MacCallum Department of Oncology, University of Melbourne, Melbourne 3000, Victoria, Australia<br />
[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5E3|class=math inline|^3]] Centre for Cancer Research, University of Melbourne, Melbourne 3000, Victoria, Australia<br />
[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5E%2A|class=math inline|^*]] D.C and S.J.D are co-senior authors and contributed equally to this article </span>

<span> Received on 27-Jan-2021; revised on 13-Jul-2021; accepted on 12-Aug-2021 </span>

<span>'''Abstract'''</span>

<span id="summary-2"></span>
===== '''Summary:''' =====

This work describes two novel workflows for variant calling that extend the widely used algorithms of Strelka2 and FreeBayes to call somatic mutations from multiple related tumour samples and one matched normal sample. We show that these workflows offer higher precision and recall than their single tumour-normal pair equivalents in both simulated and clinical sequencing data.

<span id="availability-and-implementation"></span>
===== '''Availability and Implementation:''' =====

Source code freely available at the following link: [https://atlassian.petermac.org.au/bitbucket/projects/DAW/repos/multisamplevariantcalling <code>https://atlassian.petermac.org.au/bitbucket/projects/DAW/repos/multisamplevariantcalling</code>] and executable through Janis ([https://github.com/PMCC-BioinformaticsCore/janis <code>https://github.com/PMCC-BioinformaticsCore/janis</code>]) under the GPLv3 licence.

<span id="contact"></span>
===== '''Contact:''' =====

[[Dineika.Chandrananda@petermac.org]], [[Sarah-Jane.Dawson@petermac.org]]

<span id="supplementary-information"></span>
===== '''Supplementary information:''' =====

Supplementary data are available at ''Bioinformatics'' online.

<span id="introduction"></span>
== Introduction ==

Joint variant calling methods are routinely used to call germline variants by leveraging population-wide information across multiple related samples <span class="citation" cites="DePristo2011 Toptas2018">(DePristo et al. 2011; Toptaş et al. 2018)</span>. This concept is also advantageous for somatic variant calling to potentially overcome the challenges of spatial heterogeneity and low tumour purity. However, there is a critical lack of robust algorithms that allow multi-sample somatic calling. Most studies still rely on variant calling of separate tumour-normal pairs, subsequently combining the results across a sample cohort <span class="citation" cites="Hu2019 Leong2018 Wang2018">(Hu et al. 2019; Leong et al. 2018; Wang et al. 2018)</span>.

There are two major pitfalls for combining variants called from individual tumour samples. First, it is very difficult to differentiate between a false negative result due to &quot;missing data&quot; versus the true absence of a variant. Second, there is limited sensitivity for low allele frequency variants thus, decreasing the ability to detect minor clones, particularly in samples with low tumour purity.

Currently, only three algorithms claim to have the functionality to jointly analyse multiple samples: multiSNV <span class="citation" cites="Josephidou2015">(Josephidou, Lynch, and Tavaré 2015)</span>, SuperFreq <span class="citation" cites="Flensburg2020">(Flensburg et al. 2020)</span>, and Mutect2 <span class="citation" cites="Benjamin2019">(Benjamin et al. 2019)</span>, each presenting different limitations. For instance, multiSNV cannot call indels and along with SuperFreq, is not optimised for analysis of deep coverage whole-genome sequencing (WGS) data. Mutect2 has previously been shown to be disadvantageously conservative as well as computationally inefficient <span class="citation" cites="Chen2020a">(Z. Chen et al. 2020)</span>.

To enable highly sensitive, fast and accurate variant detection from multiple related tumour samples, we have developed joint variant calling extensions to two widely used single-sample algorithms, FreeBayes <span class="citation" cites="Garrison2012">(Garrison and Marth 2012)</span> and Strelka2 <span class="citation" cites="Kim2018">(Kim et al. 2018)</span>. Using both simulated and clinical sequencing data, we show that these workflows are highly accurate and can detect variants at much lower variant allele frequencies than commonly used methods.

<span id="materials-and-methods"></span>
== Materials and methods ==

<span id="freebayessomatic-workflow-1"></span>
=== FreeBayesSomatic workflow ===

The original FreeBayes algorithm can jointly evaluate multiple samples but routinely it does not perform somatic variant calling on tumour-normal pairs. We introduce FreeBayesSomatic which allows concurrent analysis of multiple tumour samples by adapting concepts from SpeedSeq <span class="citation" cites="Chiang2015">(Chiang et al. 2015)</span> which differentiates the likelihood of a variant between tumour and normal samples instead of imposing an absolute filter for all variants called in the normal. Hence, for each genotype (GT) at SNV sites, FreeBayesSomatic first calculates the difference in likelihoods (LOD) between the normal ([[#A:eq:01|[A:eq:01]]]) and the tumour ([[#A:eq:02|[A:eq:02]]]) samples genotype likelihoods (GL) with g[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20_%7B0%7D|class=math inline|_{0}]] describing the reference genotype.

[[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cbegin%7Baligned%7D%0A%5Ctext%7BLOD%7D_%7B%5Ctext%7Bnormal%7D%7D%20%26%3D%20%5Cmax_%7Bg_i%20%5Cin%20%5Ctext%7BGT%7D%7D%20%5Cleft%28%20%5Ctext%7BGL%7D%28g_0%29%20-%20%5Ctext%7BGL%7D%28g_i%29%20%5Cright%29%20%5Clabel%7BA%3Aeq%3A01%7D%5C%5C%0A%5Ctext%7BLOD%7D_%7B%5Ctext%7Btumour%7D%7D%20%26%3D%20%5Cmin_%7Bs%20%5Cin%20%5Ctext%7BSamples%7D%7D%20%5Cleft%28%20%5Cmin_%7Bg_i%20%5Cin%20%5Ctext%7BGT%7D%7D%20%5Cleft%28%20%5Ctext%7BGL%7D_s%28g_i%29%20-%20%5Ctext%7BGL%7D_s%28g_0%29%20%5Cright%29%20%5Cright%29%20%5Clabel%7BA%3Aeq%3A02%7D%5C%5C%0A%5Ctext%7BsomaticLOD%7D%20%26%20%3A%3D%20%5Cleft%28%20%5Ctext%7BLOD%7D_%7B%5Ctext%7Bnormal%7D%7D%20%5Cgeq%203.5%20%5Cland%20%5Ctext%7BLOD%7D_%7B%5Ctext%7Btumour%7D%7D%20%5Cgeq%203.5%20%5Cright%29%20%5Clabel%7BA%3Aeq%3A03%7D%5Cend%7Baligned%7D|class=math display|\begin{aligned} \text{LOD}_{\text{normal}} &amp;= \max_{g_i \in \text{GT}} \left( \text{GL}(g_0) - \text{GL}(g_i) \right) \label{A:eq:01}\\ \text{LOD}_{\text{tumour}} &amp;= \min_{s \in \text{Samples}} \left( \min_{g_i \in \text{GT}} \left( \text{GL}_s(g_i) - \text{GL}_s(g_0) \right) \right) \label{A:eq:02}\\ \text{somaticLOD} &amp; := \left( \text{LOD}_{\text{normal}} \geq 3.5 \land \text{LOD}_{\text{tumour}} \geq 3.5 \right) \label{A:eq:03}\end{aligned}]]

Next, the variant allele frequencies (VAF) in both the tumour and the normal samples are compared at each site.

[[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cbegin%7Baligned%7D%0A%5Ctext%7BVAF%7D_%7B%5Ctext%7Btumour%7D%7D%20%26%3D%20%5Cmax_%7Bs%20%5Cin%20%5Ctext%7BSamples%7D%7D%20%28%20%5Ctext%7BVAF%7D_s%29%20%5Clabel%7BA%3Aeq%3A04%7D%5C%5C%0A%5Ctext%7BsomaticVAF%7D%20%26%20%3A%3D%20%5Cleft%28%20%5Ctext%7BVAF%7D_%7B%5Ctext%7Bnormal%7D%7D%20%5Cleq%200.001%20~%5Clor%20%5Cright.%20%5Cnonumber%20%5C%5C%0A%20%26%20%5Cleft.%20%28%20%5Ctext%7BVAF%7D_%7B%5Ctext%7Btumour%7D%7D%20%5Cgeq%202.7%20%5Ccdot%20%5Ctext%7BVAF%7D_%7B%5Ctext%7Bnormal%7D%7D%29%20%5Cright%29%20%5Clabel%7BA%3Aeq%3A05%7D%5Cend%7Baligned%7D|class=math display|\begin{aligned} \text{VAF}_{\text{tumour}} &amp;= \max_{s \in \text{Samples}} ( \text{VAF}_s) \label{A:eq:04}\\ \text{somaticVAF} &amp; := \left( \text{VAF}_{\text{normal}} \leq 0.001 ~\lor \right. \nonumber \\ &amp; \left. ( \text{VAF}_{\text{tumour}} \geq 2.7 \cdot \text{VAF}_{\text{normal}}) \right) \label{A:eq:05}\end{aligned}]]

A variant is classified as somatic when both somaticLOD as well as somatic VAF pass the criteria somaticLOD ([[#A:eq:03|[A:eq:03]]]) and somaticVAF ([[#A:eq:05|[A:eq:05]]]).

The thresholds chosen for both LOD and VAF calculations were previously fitted by the blue-collar bioinformatics workflow for the DREAM synthetic 3 dataset using the SpeedSeq likelihood difference approach <span class="citation" cites="Chapman2020">(Chapman et al. 2021)</span> and were selected to identify high confidence variants.

<span id="strelka2pass-workflow-1"></span>
=== Strelka2Pass workflow ===

In contrast to FreeBayes, whilst Strelka2 has a multiple-sample mode for germline analysis and tumour-normal pair somatic variant calling capabilities, it cannot jointly analyse multiple related tumour samples. We enable this feature by adapting a two-pass strategy previously used for RNA-seq data <span class="citation" cites="Veeneman2015">(Veeneman et al. 2015)</span>. First, somatic variants are called from each tumour-normal pair. All detected variants across the cohort are then used as input for the second pass of the analysis where we re-iterate through each tumour-normal pair but assess allelic information for all input genomic sites.

The method re-evaluates the likelihood of each variant, by integrating every genotype from each tumour-normal pair. This step can &quot;call&quot; a variant ([[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20v|class=math inline|v]]) in a sample that initially did not present enough evidence to pass the Strelka2 internal filtering using two conditions: 1) if this variant was called as a proper &quot;PASS&quot; by Strelka2 in any other tumour sample, or 2) if the integrated evidence for this variant across all tumour-normal pairs reached a sufficiently high level. The second condition was based on the somatic evidence score (SomEVS) reported by Strelka2, which is the logarithm of the probability of the variant [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20v|class=math inline|v]] being an artefact.

[[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20p_%7Berror%7D%28v%29%20%3D%2010%5E%7B%5Cleft%28%20%5Cfrac%7B-%5Ctext%7BSomEVS%7D%28v%29%7D%7B10%7D%20%5Cright%29%7D%20%5Clabel%7BA%3Aeq%3A06%7D|class=math display|p_{error}(v) = 10^{\left( \frac{-\text{SomEVS}(v)}{10} \right)} \label{A:eq:06}]]

While the germline sample is shared between all processes, we can approximate these individual probabilities as being independent, since one variant calling process is agnostic of the other. Hence, we derive the following:

[[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20p_%7Berror%7D%28v_%7Bs_1%7D%2Cv_%7Bs_2%7D%2C%5Cldots%2Cv_%7Bs_n%7D%29%20%3D%20%5Cprod_%7Bs%20%5Cin%20%5Ctext%7BSamples%7D%7D%20p_%7Berror%7D%28v_%7Bs%7D%29%20%5Clabel%7BA%3Aeq%3A07%7D|class=math display|p_{error}(v_{s_1},v_{s_2},\ldots,v_{s_n}) = \prod_{s \in \text{Samples}} p_{error}(v_{s}) \label{A:eq:07}]]

And therefore:

[[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Ctext%7BSomEVS%7D%28v_%7Bs_1%7D%2Cv_%7Bs_2%7D%2C%5Cldots%2Cv_%7Bs_n%7D%29%20%3D%20%5Csum_%7Bs%20%5Cin%20%5Ctext%7BSamples%7D%7D%20%5Ctext%7BSomEVS%7D%28v_%7Bs%7D%29%20%5Clabel%7BA%3Aeq%3A08%7D|class=math display|\text{SomEVS}(v_{s_1},v_{s_2},\ldots,v_{s_n}) = \sum_{s \in \text{Samples}} \text{SomEVS}(v_{s}) \label{A:eq:08}]]

This allows the summation ([[#A:eq:08|[A:eq:08]]]) of the SomEVS score across all supporting variants to assign a &quot;PASS&quot; filter, if it reached a joint SomEVS score threshold. This threshold can be set by the user and is 20 by default, which corresponds to an estimated error rate of 1%. These &quot;recovered&quot; variants need to pass a set of additional quality metrics related to depth of coverage, mapping quality and read position rank sum score.

As an additional improvement, we also built multiallelic support into Strelka2 which originally only reports the most prevalent variant at a specific site. Within the two-pass analysis, we reconstruct the available evidence for a multiallelic variant at a called site from the allele-specific read counts and report the minor allele at this site, if there is sufficient support from other samples. This method allows recovery of minor alleles only if another sample has this variant called by Strelka2, as SomEVS scores are not available for minor alleles.

<span id="validation-1"></span>
== Validation ==

<div class="figure*">



</div>
<span id="simulated-data"></span>
=== Simulated data ===

We first simulated a phylogeny with somatic and germline variants from ten tumour samples and one normal ([[#A:fig:01|[A:fig:01]]]A, [[#A:fig:S01|[A:fig:S01]]]A, B) ([[#A:varcalling:supmethods|[A:varcalling:supmethods]]]). Germline variants were simulated at a uniform allele frequency of [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%200.5|class=math inline|0.5]]. Somatic VAFs were sampled from a custom distribution, modelled to favour low allele frequency variants to closely represent real world data (min VAF: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%200.001|class=math inline|0.001]]; max VAF: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%201|class=math inline|1]]; [[#A:fig:S01|[A:fig:S01]]]C, D). Paired-end sequencing reads with realistic error profiles were simulated for WGS data at 160X average coverage using the ART-MountRainier software <span class="citation" cites="Huang2011">(Huang et al. 2011)</span>. The simulated reads were aligned to GRCh38 and both germline and somatic variants from the phylogeny were spiked into the aligned reads using Bamsurgeon <span class="citation" cites="Ewing2015">(Ewing et al. 2015)</span>. We compared the workflows for FreeBayes and Strelka2 with and without our extensions for joint variant calling on the simulated datasets. The performance of Mutect2 joint variant calling was also assessed using its proposed best practice workflow. As both Mutect2 and FreeBayes do not return a verdict for each individual sample, we needed to assign each sample in the multi-sample VCF its own FILTER value. We called a somatic variant as present in a sample, if there were at least two reads supporting it for this sample and the overall FILTER showed a “PASS“, which was the same cut-off used in the refiltering step in the Strelka2-pass workflow.

While the precision of each method without our extensions was greater than [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%2099.8%5C%25|class=math inline|99.8\%]], they all missed at least 25% of all variants in the samples (i.e recall [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Cleq%2075%5C%25|class=math inline|\leq 75\%]]). In contrast, the recall of the modified workflows increased to [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Capprox%2095%5C%25|class=math inline|\approx 95\%]] with only a minute decrease in the precision for both FreeBayes and Strelka2 ([[#A:fig:S02|[A:fig:S02]]]). Mutect2 however, had virtually no change in precision, but the recall actually decreased from [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Capprox%2075%5C%25|class=math inline|\approx 75\%]] to [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Capprox%2041%5C%25|class=math inline|\approx 41\%]] when analysing the samples jointly ([[#A:fig:S02|[A:fig:S02]]]B). Additionally, with our modified workflows, true positive variants were called with VAFs as low as 0.008 (median detected VAF [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Cgeq%200.14|class=math inline|\geq 0.14]] for joint sample analysis and [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Cgeq%200.21|class=math inline|\geq 0.21]] for single tumour-normal pair analysis), enabling improved distinction between true variants and technical errors ([[#A:fig:S03|[A:fig:S03]]]). This improvement in performance for Strelka2 is only achieved after the refiltering step and not just a result of the second pass ([[#A:fig:S04|[A:fig:S04]]]) ([[#A:varcalling:steps|[A:varcalling:steps]]]).

The performance of joint variant calling in Mutect2 was inferior compared to all other methods ([[#A:fig:S02|[A:fig:S02]]]A, B). This was primarily due to the &quot;clustered_events&quot; filter in Mutect2, which excluded the majority of false negative variants, with negligible contribution to the exclusion of true negative variants ([[#A:fig:S05|[A:fig:S05]]]A, B). This result was unexpected as the simulated variants were evenly distributed along the genome and the corresponding allele frequencies were sampled randomly ([[#A:fig:S01|[A:fig:S01]]]D).

Since the extent of the improvement in our joint calling workflows is bound by the number of shared variants between samples, we sub-sampled the simulated dataset, to show the effect of incomplete sampling on our methods, which is more likely in clinical settings. Furthermore, the evolutionary distance between the related samples in addition to the number of samples, has a major impact on the number of shared variants, as only variants acquired between the germline and the most recent common ancestor (MRCA), will benefit from the joint analysis. Therefore, we selected three sample subsets which included two, three and five samples with high evolutionary distance to show the minimum expected improvement ([[#A:fig:01|[A:fig:01]]]A, B). There was a clear linear improvement for both FreeBayesSomatic and Strelka2Pass when increasing the number of samples even if they had a distant evolutionary relationship. In contrast, when using only two samples with a small evolutionary distance, the increase in performance was almost as large as when jointly analysing all 10 available samples. This shows that samples with a high number of shared variants will perform better in joint calling workflows ([[#A:fig:S06|[A:fig:S06]]]).

<span id="clinical-data"></span>
=== Clinical data ===

To validate the performance of our new workflows, we then analysed WGS and whole-exome sequencing (WES) data of multi-region tumour samples from eight patients, with multiple tumour sites (average 7 samples per patient; total number of samples 55), enrolled in a rapid autopsy program conducted at the Peter MacCallum Cancer Centre ([[#A:tab:S1|[A:tab:S1]]] and [[#A:varcalling:supmethods|[A:varcalling:supmethods]]]) <span class="citation" cites="Solomon2020 Vergara2021">(Solomon et al. 2020; Vergara et al. 2021)</span>. The published studies had multiple somatic variants from the clinical samples orthogonally validated through targeted amplicon sequencing (TAS). We used these TAS-validated variants as the gold standard to evaluate the performance of different workflows, acknowledging that the technical biases inherent to TAS data are different to those present in WGS and WES ([[#A:fig:S07|[A:fig:S07]]]) and that there would be sampling biases depending on different tumour cells analysed in each data type.

In concordance with the results of the simulated data, our improved workflows found additional variants in all but one patient ([[#A:fig:01|[A:fig:01]]]D, [[#A:fig:S08|[A:fig:S08]]]) (total additional variants Strelka2Pass: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%2064|class=math inline|64]]; FreeBayesSomatic: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%2085|class=math inline|85]]) with only a slight drop in precision for FreeBayesSomatic (mean: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%200.94|class=math inline|0.94]] vs. [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%200.88|class=math inline|0.88]]) and Strelka2Pass (mean: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%200.97|class=math inline|0.97]] vs. [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%200.92|class=math inline|0.92]]). Since the panel of variants validated by TAS was limited ([[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%207108|class=math inline|7108]] bp for patients CA-B through -H), this increase in detected variants suggests that a high number of shared variants in samples are missed with current approaches, which in turn leads to an overestimation of tumour heterogeneity between samples, as these variants are thought to not be present rather than undetected.

Even though the number of shared variants is a major influencing factor when jointly calling variants, low cellularity samples benefit more from the joint calling, as conventional methods cannot reliably distinguish low allele frequency variants from noise. Through a joint analysis approach, the number of recovered variants is higher in low cellularity samples, which indicates, that especially for clinical samples with variable tumour purity, joint analysis can have a major impact on improving performance ([[#A:fig:01|[A:fig:01]]]E, [[#A:fig:S09|[A:fig:S09]]]).

Mutect2 in contrast, did not show significant improvement in any sample in its joint calling configuration, but showed inferior performance compared to the tumour-normal pairwise approach in two samples ([[#A:fig:S08|[A:fig:S08]]]E), similar to its decreased performance in the simulated data ([[#A:fig:S02|[A:fig:S02]]]). This was due to true variants being removed by the internal filters of the tool ([[#A:fig:S05|[A:fig:S05]]]C, D). This is in stark contrast to our novel workflows, where the joint analysis preserves all called sites from the pairwise method and finds additional variants. Overall, Mutect2 found less validated variants in all patients than both Strelka2Pass (mean: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%202.2|class=math inline|2.2]]) and FreeBayesSomatic (mean: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%202.5|class=math inline|2.5]]) with comparable levels of precision ([[#A:fig:S08|[A:fig:S08]]], [[#A:fig:S10|[A:fig:S10]]]) but longer run times ([[#A:tab:S2|[A:tab:S2]]]).

Our improved workflow also enabled the discovery of multiallelic variants with Strelka2, which led to the discovery of on average [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%2042|class=math inline|42]] additional variants (min: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%201|class=math inline|1]]; max: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20535|class=math inline|535]]) in the analysed WES and [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20987|class=math inline|987]] additional variants in the WGS (min: [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%2081|class=math inline|81]]; max [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%202329|class=math inline|2329]]). These variants are strong indicators of sub clonal structure and could be invaluable for the study of evolutionary trajectories in cancer.

<span id="discussion"></span>
== Discussion ==

Here we present an extension to two widely used variant callers, enabling them to analyse multiple related tumour samples and improve the sensitivity of detecting low allele frequency variants. This is highly relevant in clinical settings where low tumour purities in samples is a common occurrence. These workflows are an important step to satisfy the current unmet need for multi-sample tumour variant calling. While we have showcased their improvements in patient sequencing data, additional validation on larger clinical datasets is warranted to ensure the methodology performs robustly in real world settings. Importantly, these workflows are fully containerised and can be run through Janis <span class="citation" cites="Lupat2021">(Lupat et al. 2021)</span> on almost any high-performance computing environment, as well as cloud services. Each workflow is highly optimised and parallelised to facilitate the analysis of the large amount of data joint variant calling requires. The workflow specification also allows the easy adjustment of parameters to enable customisation for the user’s needs and priorities, whereas building an ensemble workflow using multiple callers is up to the discretion of the user ([[#A:fig:S11|[A:fig:S11]]]).

<span id="acknowledgements"></span>
== Acknowledgements ==

The authors would like to thank all patients who provided tissue samples utilised in this study. The authors acknowledge Dr Lavinia Tan for assistance provided with the collection of patient clinical samples.

<span id="funding"></span>
== Funding ==

This work was supported by the National Health and Medical Research Council [grant numbers 1196755 to S.J.D, 1158345 to S.J.D and B.J.S, 1194783 to S.Q.W, 1173450 to B.J.S]; and CSL Centenary Fellowship to S.J.D; Victorian Cancer Agency [grant numbers 19008 to D.C, 19002 to S.Q.W]

<span id="conflicts-of-interest"></span>
== Conflicts of Interest ==

S.J.D has been a member of advisory boards for AstraZeneca and Inivata. The S.J.D. lab has received funding from Cancer Therapeutics CRC and Roche-Genentech. B.J.S. has been a member of advisory boards for AstraZeneca, Roche-Genentech, Pfizer, Novartis, Amgen, Bristol Myers Squibb and Merk

<span id="data-availability"></span>
== Data availability ==

The simulated data and the respective final variant calling files underlying this article are available from Figshare at [https://melbourne.figshare.com <code>https://melbourne.figshare.com</code>], and can be accessed with [https://doi.org/10.26188/13635186 <code>https://doi.org/10.26188/13635186</code>] for the dataset and [https://doi.org/10.26188/13635187 <code>https://doi.org/10.26188/13635187</code>] for the called variants.<br />
The biological data underlying this article are available at the European Genome-Phenome Archive (EGA) at [https://ega-archive.org <code>https://ega-archive.org</code>], and can be accessed with study id [https://ega-archive.org/studies/EGAS00001004023 EGAS00001004023] and [https://ega-archive.org/studies/EGAS00001004950 EGAS00001004950].

<span id="ch:appendixManuscriptSuppData"></span>
= Supplementary data =

Characteristics of simulated data: A) Simulated phylogeny of samples B) Number of simulated germline and somatic variants per sample C) Variant allele frequency distribution of simulated variants per sample D) Distance to nearest variant in each sample.

Performance of workflows using simulated data: A) Precision and B) Recall of Mutect2, FreeBayes and Strelka2, run in single tumour-normal paired and joint calling configurations.

Variant allele frequencies (VAF) of variants detected by joint sample analysis; A) VAF distribution of true positive variants additionally detected by Strelka2pass B) and FreeBayesSomatic C) VAF distribution of false positive variants additionally detected by FreeBayesSomatic D) and Strelka2pass E) VAF distribution of false negatives not called by FreeBayesSomatic F) and Strelka2pass.

Performance of individual steps in the Strelka2pass workflow using the simulated data: A) Precision and B) Recall of tumour-normal paired analysis, two-pass step without refiltering (supplying variants from all tumour-normal pairs for evaluation) and two-pass step with refiltering (the final workflow)

Summary of variant filters assigned by Mutect2; The counts for each filter type are denoted by black boxplots with white circles depicting the median values. The fitted distribution of variant counts outlines each boxplot; A) Counts of filter assignments for false negative variants and B) true negative variants called by Mutect2 C) Filter assignment for all variants reported for sequenced patient data sequenced with WGS or D) WES.

Assessing the performance of different workflows using tumour samples with different evolutionary relationships in the simulated data; A) Simulated phylogeny highlighting two samples with high evolutionary distance (sim-a and sim-j) where MRCA denotes the most recent common ancestor. B) Precision and C) Recall estimates of FreeBayes and Strelka, run in individual tumour-normal paired and joint calling configurations using two (sim-a and sim-j), three (sim-a, sim-g and sim-j), five (sim-a, sim-c, sim-f, sim-h and sim-j) and all ten tumour samples D) Simulated phylogeny highlighting two samples with low evolutionary distance (sim-a and sim-b). E) Precision and F) Recall estimates for FreeBayes and Strelka run in individual tumour-normal paired and joint calling configurations. The plots compare the performance of these workflows when using two evolutionary distant samples (sim-a and sim-j), two evolutionary close samples (sim-a and sim-b) and all ten tumour samples.

Correlation of variant allele frequencies (VAF) from WES and WGS data against targeted amplicon sequencing VAF values with fitted violin plots of each individual distribution. Grey background shows 95% confidence interval for the fit of the linear model (dotted line).

Performance of the different workflows using clinical samples from eight cancer patients: A) Number of variants called by Strelka2 run in the tumour-normal paired (grey) and joint calling configurations, which have been validated by targeted amplicon sequencing (TAS). The same for C) FreeBayes and E) Mutect2 workflows. Precision of tumour-normal paired and joint analysis of TAS validated clinical data for B) Strelka2, D) FreeBayes and F) Mutect2; Sup. Table 1 provides the sample naming map to the original publications.

Correlation between cellularity and proportion of variants found only with joint calling using FreeBayesSomatic. Grey background shows 95% confidence interval for fit of linear model (dotted line)

Improvement in recall using FreeBayesSomatic and Strelka2pass over Mutect2 in the clinical samples.

Performance of ensemble variant calling strategies. A) Precision and B) Recall of variant detection using the joint multi-sample calling of each tool separately and compared to using Majority-vote ensemble calling (variant is called by at least two callers), Freeka2 (variant is called by both FreeBayesSomatic and Strelka2pass) and Superset (variant is called by either FreeBayesSomatic or Strelka2pass) for the simulated dataset D) Number of TAS validated variants found in the clinical samples with Majority-vote and Superset methods and the corresponding D) Precision estimates.

<div id="A:tab:S1">

{|
|+ Sample naming map relating to previously published datasets. The first column contains sample names as they appear in this work, and the third column denotes how the samples are referred to in the original studies. Forth column shows the type of sequencing WES: whole-exome sequencing; WGS: whole genome sequencing.
!align="center"| '''SAMPLE NAME'''
!align="center"| '''PUBLISHED STUDY'''
! '''ORIGINAL NAME'''
!align="center"| '''SEQUENCING TYPE'''
|-
|align="center"| CA-A-1
|align="center"|
| Case 1 Left liver 1
|align="center"|
|-
|align="center"| CA-A-2
|align="center"|
| Case 1 Right occipital
|align="center"|
|-
|align="center"| CA-A-3
|align="center"|
| Case 1 Right liver 2
|align="center"|
|-
|align="center"| CA-A-4
|align="center"|
| Case 1 Right pleura
|align="center"|
|-
|align="center"| CA-A-5
|align="center"|
| Case 1 Left lower lung lobe
|align="center"|
|-
|align="center"| CA-A-6
|align="center"|
| Case 1 Left liver 5
|align="center"|
|-
|align="center"| CA-A-7
|align="center"|
| Case 1 Right liver 3
|align="center"|
|-
|align="center"| CA-A-8
|align="center"|
| Case 1 Left liver 2
|align="center"|
|-
|align="center"| CA-B-1
|align="center"|
| CAS-B-21-L-LUNG
|align="center"|
|-
|align="center"| CA-B-2
|align="center"|
| CAS-B-22-R-LUNG
|align="center"|
|-
|align="center"| CA-B-3
|align="center"|
| CAS-B-14B37035-1B
|align="center"|
|-
|align="center"| CA-B-4
|align="center"|
| CAS-B-Primary-1
|align="center"|
|-
|align="center"| CA-B-5
|align="center"|
| CAS-B-15B08317-3A
|align="center"|
|-
|align="center"| CA-B-6
|align="center"|
| CAS-B-14B37035-1C
|align="center"|
|-
|align="center"| CA-C-1
|align="center"|
| CAS-A-FR07935894
|align="center"|
|-
|align="center"| CA-C-2
|align="center"|
| CAS-A-FR07935905
|align="center"|
|-
|align="center"| CA-C-3
|align="center"|
| CAS-A-FR07935906
|align="center"|
|-
|align="center"| CA-C-4
|align="center"|
| CAS-A-FR07935907
|align="center"|
|-
|align="center"| CA-C-5
|align="center"|
| CAS-A-FR07935908
|align="center"|
|-
|align="center"| CA-C-6
|align="center"|
| CAS-A-FR07935916
|align="center"|
|-
|align="center"| CA-C-7
|align="center"|
| CAS-A-FR07935918
|align="center"|
|-
|align="center"| CA-D-1
|align="center"|
| CAS-G-91-2
|align="center"|
|-
|align="center"| CA-D-2
|align="center"|
| CAS-G-75
|align="center"|
|-
|align="center"| CA-D-3
|align="center"|
| CAS-G-74
|align="center"|
|-
|align="center"| CA-D-4
|align="center"|
| CAS-G-71
|align="center"|
|-
|align="center"| CA-D-5
|align="center"|
| CAS-G-91
|align="center"|
|-
|align="center"| CA-D-6
|align="center"|
| CAS-G-76
|align="center"|
|-
|align="center"| CA-D-7
|align="center"|
| CAS-G-94
|align="center"|
|-
|align="center"| CA-D-8
|align="center"|
| CAS-G-72
|align="center"|
|-
|align="center"| CA-E-1
|align="center"|
| CAS-D-70
|align="center"|
|-
|align="center"| CA-E-2
|align="center"|
| CAS-D-61-3
|align="center"|
|-
|align="center"| CA-E-3
|align="center"|
| CAS-D-66
|align="center"|
|-
|align="center"| CA-E-4
|align="center"|
| CAS-D-68
|align="center"|
|-
|align="center"| CA-E-5
|align="center"|
| CAS-D-64
|align="center"|
|-
|align="center"| CA-E-6
|align="center"|
| CAS-D-61-2
|align="center"|
|-
|align="center"| CA-E-7
|align="center"|
| CAS-D-62
|align="center"|
|-
|align="center"| CA-F-1
|align="center"|
| CAS-C-41
|align="center"|
|-
|align="center"| CA-F-2
|align="center"|
| CAS-C-40-Fresh
|align="center"|
|-
|align="center"| CA-F-3
|align="center"|
| CAS-C-37
|align="center"|
|-
|align="center"| CA-F-4
|align="center"|
| CAS-C-44
|align="center"|
|-
|align="center"| CA-F-5
|align="center"|
| CAS-C-42-Fresh
|align="center"|
|-
|align="center"| CA-F-6
|align="center"|
| CAS-C-43-Fresh
|align="center"|
|-
|align="center"| CA-F-7
|align="center"|
| CAS-C-46-Primary
|align="center"|
|-
|align="center"| CA-G-1
|align="center"|
| CAS-F-FR07935922
|align="center"|
|-
|align="center"| CA-G-2
|align="center"|
| CAS-F-FR07935915
|align="center"|
|-
|align="center"| CA-G-3
|align="center"|
| CAS-F-FR07935913
|align="center"|
|-
|align="center"| CA-G-4
|align="center"|
| CAS-F-FR07935909
|align="center"|
|-
|align="center"| CA-G-5
|align="center"|
| CAS-F-FR07935904
|align="center"|
|-
|align="center"| CA-G-6
|align="center"|
| CAS-F-FR07935903
|align="center"|
|-
|align="center"| CA-H-1
|align="center"|
| CAS-E-1
|align="center"|
|-
|align="center"| CA-H-2
|align="center"|
| CAS-E-3
|align="center"|
|-
|align="center"| CA-H-3
|align="center"|
| CAS-E-4
|align="center"|
|-
|align="center"| CA-H-4
|align="center"|
| CAS-E-10
|align="center"|
|-
|align="center"| CA-H-5
|align="center"|
| CAS-E-6
|align="center"|
|-
|align="center"| CA-H-6
|align="center"|
| CAS-E-8
|align="center"|
|}


</div>
<div class="tabular">

<span>r | R<span>0.12</span> | R<span>0.12</span> | R<span>0.12</span> | R<span>0.12</span> |</span> &amp;<br />
'''Method''' &amp; 2 &amp; 3 &amp; 5 &amp; 10<br />
FreeBayesSomatic &amp; 562h &amp; 811h &amp; 1185h &amp; 2292h<br />
Strelka2Pass &amp; 310h &amp; 465h &amp; 776h &amp; 1552h<br />
Mutect2 &amp; - &amp; - &amp; - &amp; 28418h<br />



</div>
<span id="A:varcalling:supmethods"></span>
== Supplementary methods ==

<span id="alignment-of-clinical-data"></span>
=== Alignment of clinical data ===

Detailed information on processing of the clinical sequencing datasets was published previously <span class="citation" cites="Solomon2020 Vergara2021">(Solomon et al. 2020; Vergara et al. 2021)</span>. Briefly, reads were aligned to GRCh38 for patient CAS-A and GRCh37 for patients CAS-B through CAS-H using BWA version 0.7.17 <span class="citation" cites="Li2009">(H. Li and Durbin 2009)</span> allowing the use of alternative contigs. Reads were then marked as duplicates with Picard software (v2.17.3).

<span id="A:varcalling:clinical"></span>
=== Validation of clinical data ===

Detailed information on targeted amplicon sequencing of patient samples can be found in the original publications <span class="citation" cites="Solomon2020 Vergara2021">(Solomon et al. 2020; Vergara et al. 2021)</span>. A SNV called in WES with any workflow was considered a true positive when the adjusted p-value calculated through an exact binomial test was lower than 0.05 on the TAS data. The probability of success for this test was estimated as the number of bases different from the reference divided by the total number of sequenced bases (0.001) and the number of trials was the read depth covering the variant. For indels, a variant was considered to be validated if either of the panel variant callers primal (in house) or canary <span class="citation" cites="Doig2017">(Doig et al. 2017)</span> called the same variant.

Only amplicons with an average mapping rate of at least 80% over all samples, as well as an average coverage of more than 300 were considered for further analysis. WES variants were first subsetted to be within the area of the respective amplicons.

<span id="purity-estimation-with-sequenza"></span>
=== Purity estimation with sequenza ===

For CA-A the sequenza-utils python program was used to generate input files for the sequenza R program on the aligned BAM files <span class="citation" cites="Favero2015">(Favero et al. 2015)</span>. Kmin and gamma were set to 100 and 500 respectively to discourage a highly fragmented result. For CA-B through -H the reported tumour purities were used from the publication <span class="citation" cites="Vergara2021">(Vergara et al. 2021)</span>.

<span id="A:varcalling:steps"></span>
=== Performance of individual steps in Strelka2Pass ===

As each of the three steps potentially has implications for the performance, we assessed the improvement provided by each step in the Strelka2pass workflow. [[#A:fig:S04|[A:fig:S04]]] shows, that there is no change in either precision or recall just by supplying variants from all tumour-normal pairs for a second round of evaluation. However, there is a &gt;20% improvement in recall when coupling this to the refiltering step that we have built into the workflow.

<span id="ensemble-workflows-user-suggestions"></span>
=== Ensemble workflows – user suggestions ===

An overall workflow can contain any number of additional variant callers, when not restricted to callers with joint analysis capability. Importantly, there is no benefit of jointly analysing samples with Mutect2, and it may decrease the performance in some cases. Each of our presented workflows outperformed Mutect2 on the data shown here, so when assembling an ensemble method, these methods, should have a higher confidence assigned to them in joint analysis cases, than tumour-normal pair approaches.

Depending on the end needs of the user, an ensemble workflow can be optimised towards precision or recall. In [[#A:fig:S11|[A:fig:S11]]] we show the performance changes improvement that can be achieved by combining Mutect2 in tumour-normal paired analysis with the two new workflows FreeBayesSomatic and Strelka2Pass. First, in a “best of three” majority vote, where the variant needs to be called by two out of three variant callers, we enhance the precision of each of the individual tools, with slightly lower recall. On the other hand, with the super set approach, where any variant called in either FreeBayesSomatic or Strelka2Pass is included in the end result, this improves the recall even further, but slightly reduces the precision. This approach has the additional benefit of not needing to run Mutect2 which is an order of magnitude slower in our tests, than Strelka2Pass and FreeBayesSomatic ([[#A:tab:S2|[A:tab:S2]]]). The usage of these workflows can be easily integrated into existing workflows and can be customised to the needs of the user.

<span id="ch-mmfSuppMeth"></span>
= MisMatchFinder - supplementary methods =

<span id="ch-mmfAppendix:bedfiles"></span>
== ROI bed files generation ==

To ensure optimal mapping rates and no mapping related mismatches, the analysis is restricted to high mappability areas of the genome. These areas were defined as regions, where a k-mer of 100bp has a 85% or higher unique mappability rate. The mappability tracks were first computed with GEM <span class="citation" cites="Derrien2012">(Derrien et al. 2012)</span> and then collated converted to a bed file with R just like in the best practice instructions of QDNAseq <span class="citation" cites="Scheinin2014">(Scheinin et al. 2014)</span> for creating a new bin annotation. This method is only required for GRCh38 <span class="citation" cites="Schneider2017">(Schneider et al. 2017)</span> as so far, the UCSC data track is only available for GRCh37 <span class="citation" cites="Church2011">(D. M. Church et al. 2011)</span>.

<span id="ch-mmfAppendix:oligoNorm"></span>
== Oligo-nucleotide context normalisation ==

The ROI restriction of the analysis from [[#ch-mmfAppendix:bedfiles|[ch-mmfAppendix:bedfiles]]] automatically leads to a different tri- and di-nucleotide context frequency in the analysed regions, than the rest of the genome, which was used to generate the original signatures <span class="citation" cites="Alexandrov2020">(Ludmil B. Alexandrov et al. 2020)</span>. For this reason, MisMatchFinder analyses the oligo-nucleotide composition of the analysed regions and generates weighted counts by adjusting for the differences.

The baseline frequencies of both di- and tri-nucleotides were generated with the function ''oligonucleotideFrequency'' from the “Biostrings“ library <span class="citation" cites="Pages2020">(H. Pagès et al. 2020)</span> using the hg38 BSgenome <span class="citation" cites="Pages2020a">(Hervé Pagès 2020)</span>. The raw counts of the di- and tri-nucleotides can be seen in [[#A:mmf:tab:dicounts|[A:mmf:tab:dicounts]]] and [[#A:mmf:tab:tricounts|[A:mmf:tab:tricounts]]] respectively.

<div class="tabular">

<span>|C<span>0.2</span> | R<span>0.2</span>|</span> '''DINUCLEOTIDE''' &amp; '''COUNT'''<br />
AA &amp; 287025139<br />
AC &amp; 148150331<br />
AG &amp; 205752406<br />
AT &amp; 226225785<br />
CA &amp; 212880749<br />
CC &amp; 151236932<br />
CG &amp; 29401795<br />
CT &amp; 205524144<br />
GA &amp; 175847498<br />
GC &amp; 124732844<br />
GG &amp; 152432158<br />
GT &amp; 148502457<br />
TA &amp; 191400248<br />
TC &amp; 174923630<br />
TG &amp; 213928532<br />
TT &amp; 289690054<br />



</div>
<div class="tabular">

<span>|C<span>0.2</span> | R<span>0.15</span>| C<span>0.04</span> |C<span>0.2</span> | R<span>0.15</span>|</span> '''TRINUCLEOTIDE''' &amp; '''COUNT''' &amp; &amp; '''TRINUCLEOTIDE''' &amp; '''COUNT'''<br />


AAA &amp; 112465943 &amp; &amp; GAA &amp; 58990420<br />
AAC &amp; 43532050 &amp; &amp; GAC &amp; 27737004<br />
AAG &amp; 58439928 &amp; &amp; GAG &amp; 49560877<br />
AAT &amp; 72587151 &amp; &amp; GAT &amp; 39559024<br />
ACA &amp; 59305516 &amp; &amp; GCA &amp; 42481943<br />
ACC &amp; 33784390 &amp; &amp; GCC &amp; 34497599<br />
ACG &amp; 7584302 &amp; &amp; GCG &amp; 7078395<br />
ACT &amp; 47476086 &amp; &amp; GCT &amp; 40674873<br />
AGA &amp; 65552680 &amp; &amp; GGA &amp; 46022042<br />
AGC &amp; 41073623 &amp; &amp;GGC &amp; 34474720<br />
AGG &amp; 51723263 &amp; &amp;GGG &amp; 38148838<br />
AGT &amp; 47402783 &amp; &amp;GGT &amp; 33786518<br />
ATA &amp; 60308591 &amp; &amp;GTA &amp; 33265786<br />
ATC &amp; 39076747 &amp; &amp;GTC &amp; 27466578<br />
ATG &amp; 53548035 &amp; &amp;GTG &amp; 44578403<br />
ATT &amp; 73292370 &amp; &amp;GTT &amp; 43191653<br />
CAA &amp; 55220609 &amp; &amp;TAA &amp; 60348082<br />
CAC &amp; 44001434 &amp; &amp;TAC &amp; 32879810<br />
CAG &amp; 59791771 &amp; &amp;TAG &amp; 37959659<br />
CAT &amp; 53866888 &amp; &amp;TAT &amp; 60212654<br />
CCA &amp; 53293160 &amp; &amp;TCA &amp; 57800075<br />
CCC &amp; 38036593 &amp; &amp;TCC &amp; 44918305<br />
CCG &amp; 8026845 &amp; &amp;TCG &amp; 6712244<br />
CCT &amp; 51880303 &amp; &amp;TCT &amp; 65492835<br />
CGA &amp; 6511692 &amp; &amp;TGA &amp; 57760931<br />
CGC &amp; 7021552 &amp; &amp;TGC &amp; 42162935<br />
CGG &amp; 8229568 &amp; &amp;TGG &amp; 54330453<br />
CGT &amp; 7638969 &amp; &amp;TGT &amp; 59674158<br />
CTA &amp; 37666053 &amp; &amp;TTA &amp; 60159779<br />
CTC &amp; 49481013 &amp; &amp;TTC &amp; 58899235<br />
CTG &amp; 59039769 &amp; &amp;TTG &amp; 56762262<br />
CTT &amp; 59337262 &amp; &amp;TTT &amp; 113868707<br />



</div>
<span id="ch-mmfAppendix:germlineFilter"></span>
== Germline filtering with zarr ==

As shown in [[#fig:mmf-mismatchrate|[fig:mmf-mismatchrate]]]A, the amount of mismatches found in a 10x coverage sample can easily exceed [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%203|class=math inline|3]] million. In addition to that, the current gnomAD database contains [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Capprox%20707|class=math inline|\approx 707]] million variants. This means a normal merge for two datasets based on chromosomal position is not feasible for a normal compute resource in a acceptable time frame. To allow an easy query of mismatch positions against the full database, a zarr <span class="citation" cites="Miles2021">(Miles et al. 2021)</span>representation of the gnomAD VCF was generated. However in contrast to the out of the box indexing function shipped with skikit-allel <span class="citation" cites="Miles2021a">(Murillo R.; Peter Ralph; Nick Harding; Rahul Pisupati; Summer Rae; Tim Millar 2021)</span> which was used to convert the vcf to zarr, the program uses its own index built with ncls, which is available through PyRanges <span class="citation" cites="Stovner2019">(Stovner and Sætrom 2019)</span>. The sections below outline first the conversion process with scikit-allel ([[#ch-mmfAppendix:zarr|[ch-mmfAppendix:zarr]]]) and then details the filtering in the MisMatchFinder program ([[#ch-mmfAppendix:filter|[ch-mmfAppendix:filter]]])

<span id="ch-mmfAppendix:zarr"></span>
=== Zarr conversion with scikit-allel ===

While it is easy to access a zarr archive, both for reading and writing, once it is created, the generation requires time. The time is mostly computational and not so much development, as the scikit-allel package contains the function ‘[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20allel.vcf%5C_to%5C_zarr|class=math inline|allel.vcf\_to\_zarr]]’, which allows the direct conversion of VCF to zarr with only a few prerequisites.

Importantly, tabix <span class="citation" cites="Li2011">(H. Li 2011)</span> can be used to split the conversion into multiple parts by restricting the process to specific regions.

[[#lst-mmfAppendix:zarr|[lst-mmfAppendix:zarr]]] shows the code used to convert chromosome ‘chr1 ’from the downloaded gnomad vcf

<div id="lst-mmfAppendix:zarr" class="sourceCode" data-language="Python" caption="scikit-allel conversion vcf\_to\_zarr" label="lst-mmfAppendix:zarr">

<syntaxhighlight lang="python">import scikit-allel as allel

allel.vcf_to_zarr(input="gnomad.genomes.r3.1.2.sites.vcf.bgz", output="/out/put/folder/",  group="chr1", region="chr1", fields="*")</syntaxhighlight>

</div>
When MisMatchFinder is installed on your system, the function ‘[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20generateZarrStorage|class=math inline|generateZarrStorage]]’is a wrapper, which allows the parallel conversion as well to resume a failed or incomplete attempt. It is equivalent to the above code and has only usability and ease of access as priorities. This automated version will convert all fields, which include fields never used in MisMatchFinder to optimise the memory footprint of the zarr representation, the option fields in [[#lst-mmfAppendix:zarr|[lst-mmfAppendix:zarr]]] can be set to the value shown in [[#lst-mmfAppendix:fields|[lst-mmfAppendix:fields]]].

<div id="lst-mmfAppendix:fields" class="sourceCode" data-language="Python" caption="field options for reduced memory" label="lst-mmfAppendix:fields">

<syntaxhighlight lang="python">fields="['variants/CHROM', 'variants/POS', 'variants/REF', 'variants/ALT', 'variants/AF', 'variants/FILTER_PASS']"</syntaxhighlight>

</div>
Which contains only the information used in MisMatchFinder. The same result can be achieved with adding the option ‘–[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20mandatoryOnly|class=math inline|mandatoryOnly]] ’to the supplied wrapper.

<span id="ch-mmfAppendix:filter"></span>
=== MisMatchFinder filtering - the zarr API ===

<span id="ch-mmfAppendix:simulation"></span>
=== Data simulation ===

This section contains all the additional information required to replicate the simulation of data used in the MisMatchFinder chapter ([[#ch:mmf|[ch:mmf]]])

<span id="ch-mmfAppendix:spikein"></span>
=== Signature simulation - we can spike this punch ===

This section describes the signature spike-in simulation. The full code of the variant selection is available in [[#lst-mmfAppendix:spikeInSelect|[lst-mmfAppendix:spikeInSelect]]] with the bamsurgeon code shown in [[#lst-mmfAppendix:spikeInMut|[lst-mmfAppendix:spikeInMut]]].

For the selection of variants to spike-in with bamsurgeon, I use the fully annotated “CosmicMutantExport.tsv“ from [https://cancer.sanger.ac.uk/cosmic/download <code>https://cancer.sanger.ac.uk/cosmic/download</code>], then restrict the list to SNPs. These are loaded into R and annotated with their tri-nucleotide context. Because the signatures are based on the pyrimidine nucleotides, the reverse complement is generated for variants with a purine in the center position.

The sampling amount is calculated by using the intended signatures percentages (e.g. [[#fig:sig7a|[fig:sig7a]]], [[#A:fig:sig3|[A:fig:sig3]]]) and multiplying with the desired amount of variants, which can be derived from the chosen mutation rate in per million ([[#A:eq:desiredVars|[A:eq:desiredVars]]]).

[[File:https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20n%28variants%29%20%3D%20%5Cfrac%7Bmutation~rate%7D%7B1%5Ccdot10%5E%7B6%7D%20%5Ccdot%20genome~length%7D%0A%5Clabel%7BA%3Aeq%3AdesiredVars%7D|class=math display|n(variants) = \frac{mutation~rate}{1\cdot10^{6} \cdot genome~length} \label{A:eq:desiredVars}]]

For our data, we assume a genome length of [[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%203%20%5Ccdot%2010%5E9|class=math inline|3 \cdot 10^9]] and use four different mutations rates (0.1, 5, 25, 50 and 100). For the final sampling I used “data.table“ and finally variants are assign an allele frequency of 0.1.

<div id="lst-mmfAppendix:spikeInSelect" class="sourceCode" data-language="R" caption="spike-in variant selection" label="lst-mmfAppendix:spikeInSelect">

<syntaxhighlight lang="r">#get the snps
bed <- data.table(read.table("/data/reference/dawson_labs/COSMIC/v92/CosmicMutantSNPs.bed", sep="\t"))
colnames(bed) <- c("chr", "start", "end", "ref", "alt", "cancer", "status")

#get the surrounding variants
varTriNuc <- GRanges(seqnames=bed$chr, IRanges(start=(bed$start-1), end=(bed$end+1)))

#select the right genome
genome <- BSgenome.Hsapiens.UCSC.hg38::BSgenome.Hsapiens.UCSC.hg38

#get trinucs
seq <- Biostrings::getSeq(genome, varTriNuc)

# if we dont have a C or a T as the ref, we build the reverse complement, because thats
# what the signatures are based on
seq[bed$ref %in% c("G", "A")] <- Biostrings::reverseComplement(seq[bed$ref %in% c("G", "A")])

#put the trinucs with the variants
bed[,tri:= as.character(seq) ]
#add in the trinuc alt, so that we know where things are goings
bed[,triAlt:=ifelse(ref %in% c("C", "T"), alt, as.character(Biostrings::complement(Biostrings::DNAStringSet(bed$alt))))]

#now we build the name of the trinuc change as it is used in COSMIC
bed[,cosmicName:=paste(tri,triAlt)]
bed[,cosmicName:=gsub(pattern="(.)(.)(.) (.)", replacement = "\\1[\\2>\\4]\\3", cosmicName)]

#read in the signatures profile
sig7a <- data.table(read.table("/home/shollizeck/workspace/myDawsonRep/TMB/v3.2_SBS7a_PROFILE.txt", header=T, sep="\t"))

# mutations per megabase
rate <- 100

nVars <- rate/1E6*3E9

#get the number of each trinucChange we need
numCols <- colnames(sig7a)[-1]
sig7a[,(numCols):=lapply(.SD, function(x) round(x*nVars)), .SDcols=numCols]

#merge the two tables together to enable sampling
sampleTableSBS7a <- merge(bed, sig7a, by.x="cosmicName", by.y="X")

selectionSBS7a <- sampleTableSBS7a[,.SD[sample(.N,size=SBS7a_GRCh38)], by="cosmicName"]

#add in the frequency (VAF) of the variants which is a uniform 10%
selectionSBS7a[,vaf:=0.1]</syntaxhighlight>

</div>
With the generated bed, bamsurgeon can be used to create the final mutated BAM. As we are using low coverage WGS as input, some parameters need to be adjusted to allow variants to be generated. Mostly, we need to allow bamsurgeon to even mutate regions with very low coverage (‘–[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20mindepth~1|class=math inline|mindepth~1]]’), ignore the pileup of the original (‘–[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20ignorepileup|class=math inline|ignorepileup]]’), allow a higher coverage difference (‘–[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20d~0.7|class=math inline|d~0.7]]’) and lastly allow bamsurgeon to NOT mutate a position (‘–[[File:https://latex.codecogs.com/png.latex?%5Ctextstyle%20minmutreads~0|class=math inline|minmutreads~0]]’). To make the data creation reproducible, we also assign a seed of 1234.

After the BAM generation, the actually spiked-in variants are generated sorted and indexed.

Lastly, the bam needs to be postprocessed to be in line with the SAM specifications ([[#lst-mmfAppendix:spikeInMut|[lst-mmfAppendix:spikeInMut]]]).

<div id="lst-mmfAppendix:spikeInMut" class="sourceCode" data-language="bash" caption="bamsurgeon spike-in" label="lst-mmfAppendix:spikeInMut">

<syntaxhighlight lang="bash">bamsurgeon addsnv.py -d 0.7 --ignorepileup --mindepth 1 --minmutreads 0 -v mutations.bed -r $reference -o mutated.bam --aligner mem --seed 1234 -f input.bam

bamsurgeon makevcf.py addsnv_logs_mutated.bam | vcfstreamsort -a | bcftools view -o variants.vcf.gz -O z && bcftools index -t variants.vcf.gz

bamsurgeon  postprocess.py -f ${reference}.fai mutated.bam</syntaxhighlight>

</div>
<span id="ch-mmfAppendix:subsampling"></span>
=== Patient data subsampling ===

Subsampling of high depth WGS data was done with samtools (v1.13) supplying random seeds, but stable sampling rates. Sampling rates were selected, such that the output file would have an average coverage of 10x to be comparable with other sequencing data.

<span id="supplementary-figures"></span>
= Supplementary Figures =

Trinculeotide count contributions for SBS signature 3 (Defective homologous recombination-based DNA damage repair); values taken from <span class="citation" cites="Alexandrov2020">Ludmil B. Alexandrov et al. (2020)</span>

<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">

<div id="ref-Alexandrov2015" class="csl-entry" role="doc-biblioentry">

Alexandrov, Ludmil B, Philip H Jones, David C Wedge, Julian E Sale, Peter J Campbell, Serena Nik-Zainal, and Michael R Stratton. 2015. <span>“Clock-Like Mutational Processes in Human Somatic Cells.”</span> ''Nature Genetics'' 47 (12): 1402–7. https://doi.org/10.1038/ng.3441.

</div>
<div id="ref-Alexandrov2020" class="csl-entry" role="doc-biblioentry">

Alexandrov, Ludmil B., Jaegil Kim, Nicholas J. Haradhvala, Mi Ni Huang, Alvin Wei Tian Ng, Yang Wu, Arnoud Boot, et al. 2020. <span>“The Repertoire of Mutational Signatures in Human Cancer.”</span> ''Nature'' 578 (7793): 94–101. https://doi.org/10.1038/s41586-020-1943-3.

</div>
<div id="ref-Alexandrov2013" class="csl-entry" role="doc-biblioentry">

Alexandrov, Ludmil B., Serena Nik-Zainal, David C. Wedge, Samuel A. J. R. Aparicio, Sam Behjati, Andrew V. Biankin, Graham R. Bignell, et al. 2013. <span>“Signatures of Mutational Processes in Human Cancer.”</span> ''Nature'' 500 (7463): 415–21. https://doi.org/10.1038/nature12477.

</div>
<div id="ref-Arai1994" class="csl-entry" role="doc-biblioentry">

Arai, T., T. Kuroishi, Y. Saito, Y. Kurita, T. Naruke, and M. Kaneko. 1994. <span>“[https://www.ncbi.nlm.nih.gov/pubmed/8072198 Tumor Doubling Time and Prognosis in Lung Cancer Patients: Evaluation from Chest Films and Clinical Follow-up Study].”</span> ''Japanese Journal of Clinical Oncology'' 24 (August): 199–204.

</div>
<div id="ref-Auton2015" class="csl-entry" role="doc-biblioentry">

Auton, Adam, Gonçalo R. Abecasis, David M. Altshuler, Richard M. Durbin, Gonçalo R. Abecasis, David R. Bentley, Aravinda Chakravarti, et al. 2015. <span>“A Global Reference for Human Genetic Variation.”</span> ''Nature'' 526 (7571): 68–74. https://doi.org/10.1038/nature15393.

</div>
<div id="ref-Baltimore1970" class="csl-entry" role="doc-biblioentry">

Baltimore, David. 1970. <span>“Viral RNA-Dependent DNA Polymerase: RNA-Dependent DNA Polymerase in Virions of RNA Tumour Viruses.”</span> ''Nature'' 226 (5252): 1209–11. https://doi.org/10.1038/2261209a0.

</div>
<div id="ref-Benjamin2019" class="csl-entry" role="doc-biblioentry">

Benjamin, David, Takuto Sato, Kristian Cibulskis, Gad Getz, Chip Stewart, and Lee Lichtenstein. 2019. <span>“Calling Somatic <span>SNVs</span> and Indels with Mutect2.”</span> ''bioRxiv'', December. https://doi.org/10.1101/861054.

</div>
<div id="ref-Bennett1849" class="csl-entry" role="doc-biblioentry">

Bennett, J. H. 1849. ''On Cancerous and Cancroid Growths''. Sutherland; Knox. [[https://books.google.com.au/books?id=VQg\_AAAAcAAJ]].

</div>
<div id="ref-Bonev2016" class="csl-entry" role="doc-biblioentry">

Bonev, Boyan, and Giacomo Cavalli. 2016. <span>“Organization and Function of the 3d Genome.”</span> ''Nature Reviews Genetics'' 17 (11): 661–78. https://doi.org/10.1038/nrg.2016.112.

</div>
<div id="ref-Bray2016" class="csl-entry" role="doc-biblioentry">

Bray, Nicolas L, Harold Pimentel, Páll Melsted, and Lior Pachter. 2016. <span>“Near-Optimal Probabilistic <span>RNA</span>-Seq Quantification.”</span> ''Nature Biotechnology'' 34 (5): 525–27. https://doi.org/10.1038/nbt.3519.

</div>
<div id="ref-Breasted1930" class="csl-entry" role="doc-biblioentry">

Breasted, James Henry. 1930. <span>“The Edwin Smith Surgical Papyrus: Published in Facsimile and Hieroglyphic Transliteration with Translation and Commentary in Two Volumes.”</span>

</div>
<div id="ref-BrianOConnor2020" class="csl-entry" role="doc-biblioentry">

Brian O’Connor, Geraldine van der Auwera. 2020. ''Genomics in the Cloud''. O’Reilly UK Ltd. https://www.oreilly.com/library/view/genomics-in-the/9781491975183/.

</div>
<div id="ref-Browne2012" class="csl-entry" role="doc-biblioentry">

Browne, E. G. 2012. ''Arabian Medicine''. Cambridge University Press. https://doi.org/10.1017/cbo9780511709296.

</div>
<div id="ref-Burr2019" class="csl-entry" role="doc-biblioentry">

Burr, Marian L., Christina E. Sparbier, Kah Lok Chan, Yih-Chih Chan, Ariena Kersbergen, Enid Y. N. Lam, Elizabeth Azidis-Yates, et al. 2019. <span>“An Evolutionarily Conserved Function of Polycomb Silences the <span>MHC</span> Class i Antigen Presentation Pathway and Enables Immune Evasion in Cancer.”</span> ''Cancer Cell'' 36 (4): 385–401.e8. https://doi.org/10.1016/j.ccell.2019.08.008.

</div>
<div id="ref-Caravagna2020" class="csl-entry" role="doc-biblioentry">

Caravagna, Giulio, Guido Sanguinetti, Trevor A. Graham, and Andrea Sottoriva. 2020. <span>“The <span>MOBSTER</span> r Package for Tumour Subclonal Deconvolution from Bulk <span>DNA</span> Whole-Genome Sequencing Data.”</span> ''BMC Bioinformatics'' 21 (1). https://doi.org/10.1186/s12859-020-03863-1.

</div>
<div id="ref-Celsus1939" class="csl-entry" role="doc-biblioentry">

Celsus. 1939. <span>“De Medicina.”</span> ''British Journal of Surgery'' 26 (103): 658–59. https://doi.org/10.1002/bjs.18002610338.

</div>
<div id="ref-Cereda2012" class="csl-entry" role="doc-biblioentry">

Cereda, Anna, and John C Carey. 2012. <span>“Trisomy 18 Syndrome.”</span> In ''Atlas of Genetic Diagnosis and Counseling'', 7:990–96. 1. Humana Press. https://doi.org/10.1186/1750-1172-7-81.

</div>
<div id="ref-Chadwick1950" class="csl-entry" role="doc-biblioentry">

Chadwick, John, and William N Mann. 1950. ''The Medical Works of Hippocrates''. Oxford Blackwell Scientific Publications.

</div>
<div id="ref-Chapman2020" class="csl-entry" role="doc-biblioentry">

Chapman, Brad, Rory Kirchner, Lorena Pantano, Sergey Naumenko, Matthias De Smet, Luca Beltrame, Tetiana Khotiainsteva, et al. 2021. <span>“Bcbio/Bcbio-Nextgen: V1.2.4.”</span> Zenodo. https://doi.org/10.5281/ZENODO.3564938.

</div>
<div id="ref-Chen2016" class="csl-entry" role="doc-biblioentry">

Chen, Tenghui, Zixing Wang, Wanding Zhou, Zechen Chong, Funda Meric-Bernstam, Gordon B. Mills, and Ken Chen. 2016. <span>“Hotspot Mutations Delineating Diverse Mutational Signatures and Biological Utilities Across Cancer Types.”</span> ''<span>BMC</span> Genomics'' 17 (S2). https://doi.org/10.1186/s12864-016-2727-x.

</div>
<div id="ref-Chen2020a" class="csl-entry" role="doc-biblioentry">

Chen, Zixi, Yuchen Yuan, Xiaoshi Chen, Jiayun Chen, Shudai Lin, Xingsong Li, and Hongli Du. 2020. <span>“Systematic Comparison of Somatic Variant Calling Performance Among Different Sequencing Depth and Mutation Frequency.”</span> ''Scientific Reports'' 10 (1). https://doi.org/10.1038/s41598-020-60559-5.

</div>
<div id="ref-Chiang2015" class="csl-entry" role="doc-biblioentry">

Chiang, Colby, Ryan M Layer, Gregory G Faust, Michael R Lindberg, David B Rose, Erik P Garrison, Gabor T Marth, Aaron R Quinlan, and Ira M Hall. 2015. <span>“<span>SpeedSeq</span>: Ultra-Fast Personal Genome Analysis and Interpretation.”</span> ''Nature Methods'' 12 (10): 966–68. https://doi.org/10.1038/nmeth.3505.

</div>
<div id="ref-Church2011" class="csl-entry" role="doc-biblioentry">

Church, Deanna M., Valerie A. Schneider, Tina Graves, Katherine Auger, Fiona Cunningham, Nathan Bouk, Hsiu-Chuan Chen, et al. 2011. <span>“Modernizing Reference Genome Assemblies.”</span> ''<span>PLoS</span> Biology'' 9 (7): e1001091. https://doi.org/10.1371/journal.pbio.1001091.

</div>
<div id="ref-Church1984" class="csl-entry" role="doc-biblioentry">

Church, G. M., and W. Gilbert. 1984. <span>“Genomic Sequencing.”</span> ''Proceedings of the National Academy of Sciences'' 81 (7): 1991–95. https://doi.org/10.1073/pnas.81.7.1991.

</div>
<div id="ref-Church1988" class="csl-entry" role="doc-biblioentry">

Church, G., and S Kieffer-Higgins. 1988. <span>“Multiplex <span>DNA</span> Sequencing.”</span> ''Science'' 240 (April): 185–88. https://doi.org/10.1126/science.3353714.

</div>
<div id="ref-Claude1947" class="csl-entry" role="doc-biblioentry">

Claude, Albert, Keith R. Porter, and Edward G. Pickels. 1947. <span>“Electron Microscope Study of Chicken Tumor Cells.”</span> ''Cancer Research'' 7 (7): 421–30. https://cancerres.aacrjournals.org/content/7/7/421.

</div>
<div id="ref-Cooke2021" class="csl-entry" role="doc-biblioentry">

Cooke, Daniel P., David C. Wedge, and Gerton Lunter. 2021. <span>“A Unified Haplotype-Based Method for Accurate and Comprehensive Variant Calling.”</span> ''Nature Biotechnology'' 39 (7): 885–92. https://doi.org/10.1038/s41587-021-00861-3.

</div>
<div id="ref-2014" class="csl-entry" role="doc-biblioentry">

<span>“ctDNA Is a Specific and Sensitive Biomarker in Multiple Human Cancers.”</span> 2014. ''Cancer Discovery'' 4 (4, 4): OF8. https://doi.org/10.1158/2159-8290.CD-RW2014-051.

</div>
<div id="ref-DagogoJack2017" class="csl-entry" role="doc-biblioentry">

Dagogo-Jack, Ibiayi, and Alice T. Shaw. 2017. <span>“Tumour Heterogeneity and Resistance to Cancer Therapies.”</span> ''Nature Reviews Clinical Oncology'' 15 (2): 81–94. https://doi.org/10.1038/nrclinonc.2017.166.

</div>
<div id="ref-Dan2012" class="csl-entry" role="doc-biblioentry">

Dan, Shan, Wei Wang, Jinghui Ren, Yali Li, Hua Hu, Zhengfeng Xu, Tze Kin Lau, et al. 2012. <span>“Clinical Application of Massively Parallel Sequencing-Based Prenatal Noninvasive Fetal Trisomy Test for Trisomies 21 and 18 in 11<span></span>105 Pregnancies with Mixed Risk Factors.”</span> ''Prenatal Diagnosis'' 32 (13): 1225–32. https://doi.org/10.1002/pd.4002.

</div>
<div id="ref-Darwin2010" class="csl-entry" role="doc-biblioentry">

Darwin, Charles. 2010. <span>“On the Origin of Species by Means of Natural Selection, or the Preservation of Favoured Races in the Struggle for Life.”</span> In ''Evolutionary Writings''. Oxford University Press. https://doi.org/10.1093/owc/9780199580149.003.0005.

</div>
<div id="ref-DePristo2011" class="csl-entry" role="doc-biblioentry">

DePristo, Mark A, Eric Banks, Ryan Poplin, Kiran V Garimella, Jared R Maguire, Christopher Hartl, Anthony A Philippakis, et al. 2011. <span>“A Framework for Variation Discovery and Genotyping Using Next-Generation <span>DNA</span> Sequencing Data.”</span> ''Nature Genetics'' 43 (5): 491–98. https://doi.org/10.1038/ng.806.

</div>
<div id="ref-Derrien2012" class="csl-entry" role="doc-biblioentry">

Derrien, Thomas, Jordi Estellé, Santiago Marco Sola, David G. Knowles, Emanuele Raineri, Roderic Guigó, and Paolo Ribeca. 2012. <span>“Fast Computation and Applications of Genome Mappability.”</span> Edited by Christos A. Ouzounis. ''<span>PLoS</span> <span>ONE</span>'' 7 (1): e30377. https://doi.org/10.1371/journal.pone.0030377.

</div>
<div id="ref-DeshaiesGendron1701" class="csl-entry" role="doc-biblioentry">

Deshaies-Gendron, Claude. 1701. ''Recherches Sur La Nature Et La Guerison Des Cancers''. Print edition. Gale ECCO.

</div>
<div id="ref-Deshwar2015" class="csl-entry" role="doc-biblioentry">

Deshwar, Amit G, Shankar Vembu, Christina K Yung, Gun Ho Jang, Lincoln Stein, and Quaid Morris. 2015. <span>“<span>PhyloWGS</span>: Reconstructing Subclonal Composition and Evolution from Whole-Genome Sequencing of Tumors.”</span> ''Genome Biology'' 16 (1). https://doi.org/10.1186/s13059-015-0602-8.

</div>
<div id="ref-Diehl2008" class="csl-entry" role="doc-biblioentry">

Diehl, Frank, Kerstin Schmidt, Michael A Choti, Katharine Romans, Steven Goodman, Meng Li, Katherine Thornton, et al. 2008. <span>“Circulating Mutant <span>DNA</span> to Assess Tumor Dynamics.”</span> ''Nature Medicine'' 14 (9): 985–90. https://doi.org/10.1038/nm.1789.

</div>
<div id="ref-Doig2017" class="csl-entry" role="doc-biblioentry">

Doig, Kenneth D., Jason Ellul, Andrew Fellowes, Ella R. Thompson, Georgina Ryland, Piers Blombery, Anthony T. Papenfuss, and Stephen B. Fox. 2017. <span>“Canary: An Atomic Pipeline for Clinical Amplicon Assays.”</span> ''BMC Bioinformatics'' 18 (1). https://doi.org/10.1186/s12859-017-1950-z.

</div>
<div id="ref-Ehrlich1909" class="csl-entry" role="doc-biblioentry">

Ehrlich, Paul. 1909. ''Beiträge Zur Experimentellen Pathologie Und Chemotherapie''. Germany, Leipzig: Akademische Verlagsgesellschaft. https://id.lib.harvard.edu/curiosity/contagion/36-990061083080203941.

</div>
<div id="ref-ElKebir2018" class="csl-entry" role="doc-biblioentry">

El-Kebir, Mohammed, Gryte Satas, and Benjamin J. Raphael. 2018. <span>“Inferring Parsimonious Migration Histories for Metastatic Cancers”</span> 50 (5): 718–26. https://doi.org/10.1038/s41588-018-0106-z.

</div>
<div id="ref-Etmueller2018" class="csl-entry" role="doc-biblioentry">

Etmüller, Michael. 2018. ''ETMULLERUS ABRIDG’d : Or, a Compleat System of the Theory and Practice of Physic Being a ... Description of All Diseases Incident to Men, Women''. Gale ECCO.

</div>
<div id="ref-Ewing2015" class="csl-entry" role="doc-biblioentry">

Ewing, Adam D, Kathleen E Houlahan, Yin Hu, Kyle Ellrott, Cristian Caloian, Takafumi N Yamaguchi, J Christopher Bare, et al. 2015. <span>“Combining Tumor Genome Simulation with Crowdsourcing to Benchmark Somatic Single-Nucleotide-Variant Detection.”</span> ''Nature Methods'' 12 (7): 623–30. https://doi.org/10.1038/nmeth.3407.

</div>
<div id="ref-Favero2015" class="csl-entry" role="doc-biblioentry">

Favero, F., T. Joshi, A. M. Marquard, N. J. Birkbak, M. Krzystanek, Q. Li, Z. Szallasi, and A. C. Eklund. 2015. <span>“Sequenza: Allele-Specific Copy Number and Mutation Profiles from Tumor Sequencing Data.”</span> ''Annals of Oncology'' 26 (1): 64–70. https://doi.org/10.1093/annonc/mdu479.

</div>
<div id="ref-Felsenstein1981" class="csl-entry" role="doc-biblioentry">

Felsenstein, Joseph. 1981. <span>“Evolutionary Trees from <span>DNA</span> Sequences: A Maximum Likelihood Approach.”</span> ''Journal of Molecular Evolution'' 17 (6): 368–76. https://doi.org/10.1007/bf01734359.

</div>
<div id="ref-Flensburg2020" class="csl-entry" role="doc-biblioentry">

Flensburg, Christoffer, Tobias Sargeant, Alicia Oshlack, and Ian J. Majewski. 2020. <span>“<span>SuperFreq</span>: Integrated Mutation Detection and Clonal Tracking in Cancer.”</span> Edited by Florian Markowetz. ''PLOS Computational Biology'' 16 (2): e1007603. https://doi.org/10.1371/journal.pcbi.1007603.

</div>
<div id="ref-Fouad2017" class="csl-entry" role="doc-biblioentry">

Fouad, Yousef Ahmed, and Carmen Aanei. 2017. <span>“[https://www.ncbi.nlm.nih.gov/pubmed/28560055 Revisiting the Hallmarks of Cancer.]”</span> ''American Journal of Cancer Research'' 7: 1016–36.

</div>
<div id="ref-Frey2021" class="csl-entry" role="doc-biblioentry">

Frey, Laura, Natalia Ziętara, Marcin Łyszkiewicz, Benjamin Marquardt, Yoko Mizoguchi, Monika I. Linder, Yanshan Liu, et al. 2021. <span>“Mammalian <span>VPS</span>45 Orchestrates Trafficking Through the Endosomal System.”</span> ''Blood'' 137 (14): 1932–44. https://doi.org/10.1182/blood.2020006871.

</div>
<div id="ref-Frieben1902" class="csl-entry" role="doc-biblioentry">

Frieben, EAFA. 1902. <span>“Demonstration Eines Cancroids Des Rechten Handruckens, Das Sich Nach Langdauerner Einwirkung von Roentgenstrahlen Entwickelt Hatte.”</span> ''Forsch Roentgenstr'' 6: 106–11.

</div>
<div id="ref-Galili2015" class="csl-entry" role="doc-biblioentry">

Galili, Tal. 2015. <span>“Dendextend: An r Package for Visualizing, Adjusting and Comparing Trees of Hierarchical Clustering”</span> 31 (22): 3718–20. https://doi.org/10.1093/bioinformatics/btv428.

</div>
<div id="ref-Garrison2012" class="csl-entry" role="doc-biblioentry">

Garrison, Erik, and Gabor Marth. 2012. <span>“Haplotype-Based Variant Detection from Short-Read Sequencing.”</span> ''arXiv Preprint arXiv:1207.3907 [q-Bio.GN]'', July. https://arxiv.org/abs/http://arxiv.org/abs/1207.3907v2.

</div>
<div id="ref-GATKTeam2019" class="csl-entry" role="doc-biblioentry">

GATK Team. 2019. <span>“StrandBiasBySample.”</span> September 18, 2019. https://gatk.broadinstitute.org/hc/en-us/articles/360040096492.

</div>
<div id="ref-GATKTeam2020" class="csl-entry" role="doc-biblioentry">

———. 2020. <span>“Mutect2 Multi-Sample.”</span> September 25, 2020. https://gatk.broadinstitute.org/hc/en-us/community/posts/360062528691.

</div>
<div id="ref-GATKTeam2021" class="csl-entry" role="doc-biblioentry">

———. 2021a. <span>“Panel of Normals (PON).”</span> July 23, 2021. https://gatk.broadinstitute.org/hc/en-us/articles/360035890631.

</div>
<div id="ref-GATKTeam2021a" class="csl-entry" role="doc-biblioentry">

———. 2021b. <span>“Somatic Calling Is NOT Simply a Difference Between Two Callsets.”</span> September 15, 2021. https://gatk.broadinstitute.org/hc/en-us/articles/360035890491.

</div>
<div id="ref-Gerstung2020" class="csl-entry" role="doc-biblioentry">

Gerstung, Moritz, Clemency Jolly, Ignaty Leshchiner, Stefan C. Dentro, Santiago Gonzalez, Daniel Rosebrock, Thomas J. Mitchell, et al. 2020. <span>“The Evolutionary History of 2,658 Cancers.”</span> ''Nature'' 578 (7793): 122–28. https://doi.org/10.1038/s41586-019-1907-7.

</div>
<div id="ref-Gottlieb1962" class="csl-entry" role="doc-biblioentry">

Gottlieb, Marvin I., Kurt Hirschhorn, Herbert L. Cooper, Nevanka Lusskin, Ralph E. Moloshok, and Horace L. Hodes. 1962. <span>“Trisomy-17 Syndrome.”</span> ''The American Journal of Medicine'' 33 (5): 763–73. https://doi.org/10.1016/0002-9343(62)90253-x.

</div>
<div id="ref-Guo2012" class="csl-entry" role="doc-biblioentry">

Guo, Yan, Jiang Li, Chung-I Li, Jirong Long, David C Samuels, and Yu Shyr. 2012. <span>“The Effect of Strand Bias in Illumina Short-Read Sequencing Data.”</span> ''<span>BMC</span> Genomics'' 13 (1). https://doi.org/10.1186/1471-2164-13-666.

</div>
<div id="ref-Hajdu2004" class="csl-entry" role="doc-biblioentry">

Hajdu, Steven I. 2004. <span>“Greco-Roman Thought about Cancer.”</span> ''Cancer'' 100 (10): 2048–51. https://doi.org/10.1002/cncr.20198.

</div>
<div id="ref-Hajdu2010a" class="csl-entry" role="doc-biblioentry">

Hajdu, Steven I. 2010a. <span>“The First Printed Case Reports of Cancer: The First Printed Case Reports of Cancer.”</span> ''Cancer''. https://doi.org/10.1002/cncr.25000.

</div>
<div id="ref-Hajdu2010b" class="csl-entry" role="doc-biblioentry">

———. 2010b. <span>“A Note from History: Landmarks in History of Cancer, Part 2.”</span> ''Cancer'' 117 (12): 2811–20. https://doi.org/10.1002/cncr.25825.

</div>
<div id="ref-Hamming1950" class="csl-entry" role="doc-biblioentry">

Hamming, R. W. 1950. <span>“Error Detecting and Error Correcting Codes.”</span> ''Bell System Technical Journal'' 29 (2): 147–60. https://doi.org/10.1002/j.1538-7305.1950.tb00463.x.

</div>
<div id="ref-Hammond2017" class="csl-entry" role="doc-biblioentry">

Hammond, Colin M., Caroline B. Strømme, Hongda Huang, Dinshaw J. Patel, and Anja Groth. 2017. <span>“Histone Chaperone Networks Shaping Chromatin Function.”</span> ''Nature Reviews Molecular Cell Biology'' 18 (3): 141–58. https://doi.org/10.1038/nrm.2016.159.

</div>
<div id="ref-Hanage2006" class="csl-entry" role="doc-biblioentry">

Hanage, William P., Christophe Fraser, and Brian G. Spratt. 2006. <span>“The Impact of Homologous Recombination on the Generation of Diversity in Bacteria.”</span> ''Journal of Theoretical Biology'' 239 (2): 210–19. https://doi.org/10.1016/j.jtbi.2005.08.035.

</div>
<div id="ref-Hanahan2022" class="csl-entry" role="doc-biblioentry">

Hanahan, Douglas. 2022. <span>“Hallmarks of Cancer: New Dimensions.”</span> ''Cancer Discovery'' 12 (1): 31–46. https://doi.org/10.1158/2159-8290.cd-21-1059.

</div>
<div id="ref-Hanahan2000" class="csl-entry" role="doc-biblioentry">

Hanahan, Douglas, and Robert A Weinberg. 2000. <span>“The Hallmarks of Cancer.”</span> ''Cell'' 100 (1): 57–70. https://doi.org/10.1016/s0092-8674(00)81683-9.

</div>
<div id="ref-Hanahan2011" class="csl-entry" role="doc-biblioentry">

Hanahan, Douglas, and Robert A. Weinberg. 2011. <span>“Hallmarks of Cancer: The Next Generation.”</span> ''Cell'' 144 (5): 646–74. https://doi.org/10.1016/j.cell.2011.02.013.

</div>
<div id="ref-Hasegawa1985" class="csl-entry" role="doc-biblioentry">

Hasegawa, Masami, Hirohisa Kishino, and Taka-aki Yano. 1985. <span>“Dating of the Human-Ape Splitting by a Molecular Clock of Mitochondrial <span>DNA</span>.”</span> ''Journal of Molecular Evolution'' 22 (2): 160–74. https://doi.org/10.1007/bf02101694.

</div>
<div id="ref-Heister1747" class="csl-entry" role="doc-biblioentry">

Heister, Lorenz. 1747. ''Kleine Chirurgie, Oder, Wund-Artzney: In Welcher Ein Kurzer Doch Deutlicher Unterricht Und Begriff Dieser Wissenschafft Gegeben ... Werden''. Nürnberg: Joh. Adam Stein und Gabriel Nicolaus Raspe.

</div>
<div id="ref-Heydari2019" class="csl-entry" role="doc-biblioentry">

Heydari, Mahdi, Giles Miclotte, Yves Van de Peer, and Jan Fostier. 2019. <span>“Illumina Error Correction Near Highly Repetitive <span>DNA</span> Regions Improves de Novo Genome Assembly.”</span> ''<span>BMC</span> Bioinformatics'' 20 (1). https://doi.org/10.1186/s12859-019-2906-2.

</div>
<div id="ref-Hollizeck2021" class="csl-entry" role="doc-biblioentry">

Hollizeck, S, S Q Wong, B Solomon, D Chandranada, and S-J Dawson. 2021. <span>“Custom Workflows to Improve Joint Variant Calling from Multiple Related Tumour Samples: <span>FreeBayesSomatic</span> and Strelka2Pass.”</span> Edited by Can Alkan. ''Bioinformatics'', September. https://doi.org/10.1093/bioinformatics/btab606.

</div>
<div id="ref-Hollstein1991" class="csl-entry" role="doc-biblioentry">

Hollstein, Monica, David Sidransky, Bert Vogelstein, and Curtis C. Harris. 1991. <span>“P53 Mutations in Human Cancers.”</span> ''Science'' 253 (5015): 49–53. https://doi.org/10.1126/science.1905840.

</div>
<div id="ref-Hu2019" class="csl-entry" role="doc-biblioentry">

Hu, Zheng, Jie Ding, Zhicheng Ma, Ruping Sun, Jose A. Seoane, J. Scott Shaffer, Carlos J. Suarez, et al. 2019. <span>“Quantitative Evidence for Early Metastatic Seeding in Colorectal Cancer.”</span> ''Nature Genetics'' 51 (7): 1113–22. https://doi.org/10.1038/s41588-019-0423-x.

</div>
<div id="ref-Huang2011" class="csl-entry" role="doc-biblioentry">

Huang, Weichun, Leping Li, Jason R. Myers, and Gabor T. Marth. 2011. <span>“<span>ART</span>: A Next-Generation Sequencing Read Simulator.”</span> ''Bioinformatics'' 28 (4): 593–94. https://doi.org/10.1093/bioinformatics/btr708.

</div>
<div id="ref-Hudecova2021" class="csl-entry" role="doc-biblioentry">

Hudecova, Irena, Christopher G. Smith, Robert Hänsel-Hertsch, Chandra Chilamakuri, James A. Morris, Aadhitthya Vijayaraghavan, Katrin Heider, et al. 2021. <span>“Characteristics, Origin, and Potential for Cancer Diagnostics of Ultrashort Plasma Cell-Free <span>DNA</span>.”</span> ''Genome Research'', December, gr.275691.121. https://doi.org/10.1101/gr.275691.121.

</div>
<div id="ref-Huebner1969" class="csl-entry" role="doc-biblioentry">

Huebner, Robert J, and George J Todaro. 1969. <span>“Oncogenes of RNA Tumor Viruses as Determinants of Cancer.”</span> ''Proceedings of the National Academy of Sciences'' 64 (3): 1087–94. https://doi.org/10.1073/pnas.64.3.1087.

</div>
<div id="ref-Hulten2008" class="csl-entry" role="doc-biblioentry">

Hultén, Maj A, Suketu D Patel, Maira Tankimanova, Magnus Westgren, Nikos Papadogiannakis, Anna Jonsson, and Erik Iwarsson. 2008. <span>“On the Origin of Trisomy 21 down Syndrome.”</span> ''Molecular Cytogenetics'' 1 (1): 21. https://doi.org/10.1186/1755-8166-1-21.

</div>
<div id="ref-Illumina2020" class="csl-entry" role="doc-biblioentry">

Illumina, Inc. 2020. <span>“How Short Inserts Affect Sequencing Performance.”</span> September 2020. https://sapac.support.illumina.com/bulletins/2020/12/how-short-inserts-affect-sequencing-performance.html.

</div>
<div id="ref-Jiang2016" class="csl-entry" role="doc-biblioentry">

Jiang, Yuchao, Yu Qiu, Andy J. Minn, and Nancy R. Zhang. 2016. <span>“Assessing Intratumor Heterogeneity and Tracking Longitudinal and Spatial Clonal Evolutionary History by Next-Generation Sequencing”</span> 113 (37): E5528–37. https://doi.org/10.1073/pnas.1522203113.

</div>
<div id="ref-Josephidou2015" class="csl-entry" role="doc-biblioentry">

Josephidou, Malvina, Andy G. Lynch, and Simon Tavaré. 2015. <span>“<span class="nocase">multiSNV</span>: A Probabilistic Approach for Improving Detection of Somatic Point Mutations from Multiple Related Tumour Samples.”</span> ''Nucleic Acids Research'' 43 (9): e61–61. https://doi.org/10.1093/nar/gkv135.

</div>
<div id="ref-Karczewski2020" class="csl-entry" role="doc-biblioentry">

Karczewski, Konrad J., Laurent C. Francioli, Grace Tiao, Beryl B. Cummings, Jessica Alföldi, Qingbo Wang, Ryan L. Collins, et al. 2020. <span>“The Mutational Constraint Spectrum Quantified from Variation in 141,456 Humans.”</span> ''Nature'' 581 (7809): 434–43. https://doi.org/10.1038/s41586-020-2308-7.

</div>
<div id="ref-Karimnezhad2020" class="csl-entry" role="doc-biblioentry">

Karimnezhad, Ali, Gareth A. Palidwor, Kednapa Thavorn, David J. Stewart, Pearl A. Campbell, Bryan Lo, and Theodore J. Perkins. 2020. <span>“Accuracy and Reproducibility of Somatic Point Mutation Calling in Clinical-Type Targeted Sequencing Data.”</span> ''BMC Med Genomics'' 13 (1). https://doi.org/10.1186/s12920-020-00803-z.

</div>
<div id="ref-Kim2018" class="csl-entry" role="doc-biblioentry">

Kim, Sangtae, Konrad Scheffler, Aaron L. Halpern, Mitchell A. Bekritsky, Eunho Noh, Morten Källberg, Xiaoyu Chen, et al. 2018. <span>“Strelka2: Fast and Accurate Calling of Germline and Somatic Variants.”</span> ''Nature Methods'' 15 (8): 591–94. https://doi.org/10.1038/s41592-018-0051-x.

</div>
<div id="ref-Kong2013" class="csl-entry" role="doc-biblioentry">

Kong, Ying, Jennifer H. Ma, Keisha Warren, Raymond S. W. Tsang, Donald E. Low, Frances B. Jamieson, David C. Alexander, and Weilong Hao. 2013. <span>“Homologous Recombination Drives Both Sequence Diversity and Gene Content Variation in Neisseria Meningitidis.”</span> ''Genome Biology and Evolution'' 5 (9): 1611–27. https://doi.org/10.1093/gbe/evt116.

</div>
<div id="ref-Kucab2019" class="csl-entry" role="doc-biblioentry">

Kucab, Jill E., Xueqing Zou, Sandro Morganella, Madeleine Joel, A. Scott Nanda, Eszter Nagy, Celine Gomez, et al. 2019. <span>“A Compendium of Mutational Signatures of Environmental Agents.”</span> ''Cell'' 177 (4): 821–836.e16. https://doi.org/10.1016/j.cell.2019.03.001.

</div>
<div id="ref-Kuczynski2019" class="csl-entry" role="doc-biblioentry">

Kuczynski, Elizabeth A., Peter B. Vermeulen, Francesco Pezzella, Robert S. Kerbel, and Andrew R. Reynolds. 2019. <span>“Vessel Co-Option in Cancer.”</span> ''Nature Reviews Clinical Oncology'' 16 (8): 469–93. https://doi.org/10.1038/s41571-019-0181-9.

</div>
<div id="ref-Lai2016" class="csl-entry" role="doc-biblioentry">

Lai, Zhongwu, Aleksandra Markovets, Miika Ahdesmaki, Brad Chapman, Oliver Hofmann, Robert McEwen, Justin Johnson, Brian Dougherty, J. Carl Barrett, and Jonathan R. Dry. 2016. <span>“<span>VarDict</span>: A Novel and Versatile Variant Caller for Next-Generation Sequencing in Cancer Research.”</span> ''Nucleic Acids Research'' 44 (11): e108–8. https://doi.org/10.1093/nar/gkw227.

</div>
<div id="ref-Lander2001" class="csl-entry" role="doc-biblioentry">

Lander, Eric S., Lauren M. Linton, Bruce Birren, Chad Nusbaum, Michael C. Zody, Jennifer Baldwin, Keri Devon, et al. 2001. <span>“Initial Sequencing and Analysis of the Human Genome.”</span> ''Nature'' 409 (6822): 860–921. https://doi.org/10.1038/35057062.

</div>
<div id="ref-Langmead2018" class="csl-entry" role="doc-biblioentry">

Langmead, Ben, Christopher Wilks, Valentin Antonescu, and Rone Charles. 2018. <span>“Scaling Read Aligners to Hundreds of Threads on General-Purpose Processors.”</span> Edited by John Hancock. ''Bioinformatics'' 35 (3): 421–32. https://doi.org/10.1093/bioinformatics/bty648.

</div>
<div id="ref-Lawrence2013a" class="csl-entry" role="doc-biblioentry">

Lawrence, Michael S., Petar Stojanov, Paz Polak, Gregory V. Kryukov, Kristian Cibulskis, Andrey Sivachenko, Scott L. Carter, et al. 2013. <span>“Mutational Heterogeneity in Cancer and the Search for New Cancer-Associated Genes.”</span> ''Nature'' 499 (7457): 214–18. https://doi.org/10.1038/nature12213.

</div>
<div id="ref-Leong2018" class="csl-entry" role="doc-biblioentry">

Leong, Tracy L., Velimir Gayevskiy, Daniel P. Steinfort, Marc R. De Massy, Alvaro Gonzalez-Rajal, Kieren D. Marini, Emily Stone, et al. 2018. <span>“Deep Multi-Region Whole-Genome Sequencing Reveals Heterogeneity and Gene-by-Environment Interactions in Treatment-Naive, Metastatic Lung Cancer.”</span> ''Oncogene'' 38 (10): 1661–75. https://doi.org/10.1038/s41388-018-0536-1.

</div>
<div id="ref-Leshchiner2018" class="csl-entry" role="doc-biblioentry">

Leshchiner, Ignaty, Dimitri Livitz, Justin F. Gainor, Daniel Rosebrock, Oliver Spiro, Aina Martinez, Edmund Mroz, et al. 2018. <span>“Comprehensive Analysis of Tumour Initiation, Spatial and Temporal Progression Under Multiple Lines of Treatment.”</span> ''bioRxiv'', December. https://doi.org/10.1101/508127.

</div>
<div id="ref-Li1969" class="csl-entry" role="doc-biblioentry">

Li, Frederick P, and Joseph F Fraumeni Jr. 1969. <span>“Rhabdomyosarcoma in Children: Epidemiologic Study and Identification of a Familial Caneer Syndrome.”</span> ''Journal of the National Cancer Institute'' 43 (6): 1365–73.

</div>
<div id="ref-Li2011" class="csl-entry" role="doc-biblioentry">

Li, H. 2011. <span>“Tabix: Fast Retrieval of Sequence Features from Generic <span>TAB</span>-Delimited Files.”</span> ''Bioinformatics'' 27 (5): 718–19. https://doi.org/10.1093/bioinformatics/btq671.

</div>
<div id="ref-Li2009" class="csl-entry" role="doc-biblioentry">

Li, H., and R. Durbin. 2009. <span>“Fast and Accurate Short Read Alignment with Burrows-Wheeler Transform.”</span> ''Bioinformatics'' 25 (14): 1754–60. https://doi.org/10.1093/bioinformatics/btp324.

</div>
<div id="ref-Li2013" class="csl-entry" role="doc-biblioentry">

Li, Heng. 2013. <span>“Aligning Sequence Reads, Clone Sequences and Assembly Contigs with BWA-MEM,”</span> March. https://arxiv.org/abs/1303.3997.

</div>
<div id="ref-Liang1998" class="csl-entry" role="doc-biblioentry">

Liang, F., M. Han, P. J. Romanienko, and M. Jasin. 1998. <span>“Homology-Directed Repair Is a Major Double-Strand Break Repair Pathway in Mammalian Cells.”</span> ''Proceedings of the National Academy of Sciences'' 95 (9): 5172–77. https://doi.org/10.1073/pnas.95.9.5172.

</div>
<div id="ref-Lilley2000" class="csl-entry" role="doc-biblioentry">

Lilley, David M. J. 2000. <span>“Structures of Helical Junctions in Nucleic Acids.”</span> ''Quarterly Reviews of Biophysics'' 33 (2): 109–59. https://doi.org/10.1017/s0033583500003590.

</div>
<div id="ref-Luczak2017" class="csl-entry" role="doc-biblioentry">

Luczak, Brian B, Benjamin T James, and Hani Z Girgis. 2017. <span>“A Survey and Evaluations of Histogram-Based Statistics in Alignment-Free Sequence Comparison.”</span> ''Briefings in Bioinformatics'' 20 (4): 1222–37. https://doi.org/10.1093/bib/bbx161.

</div>
<div id="ref-Lupat2021" class="csl-entry" role="doc-biblioentry">

Lupat, Richard, Michael Franklin, Evan Thomas, Juny Kesumadewi, Jiaan Yu, Mohammad Bhuyan, Tony Papenfuss, Daniel Park, Bernard Pope, and Jason Li. 2021. <span>“Janis: A Python Framework for Portable Pipelines.”</span> Zenodo. https://doi.org/10.5281/ZENODO.4427231.

</div>
<div id="ref-Lusitani1649" class="csl-entry" role="doc-biblioentry">

Lusitani, Zacutus. 1649. <span>“Praxis Medical Admiranda.”</span> ''Lugduni: J. Hugvetan''.

</div>
<div id="ref-Lynch2016" class="csl-entry" role="doc-biblioentry">

Lynch, Andy G. 2016. <span>“Decomposition of Mutational Context Signatures Using Quadratic Programming Methods.”</span> ''F1000Research'' 5 (June): 1253. https://doi.org/10.12688/f1000research.8918.1.

</div>
<div id="ref-Marass2016" class="csl-entry" role="doc-biblioentry">

Marass, Francesco, Florent Mouliere, Ke Yuan, Nitzan Rosenfeld, and Florian Markowetz. 2016. <span>“A Phylogenetic Latent Feature Model for Clonal Deconvolution.”</span> ''The Annals of Applied Statistics'' 10 (4). https://doi.org/10.1214/16-aoas986.

</div>
<div id="ref-Mardis2008" class="csl-entry" role="doc-biblioentry">

Mardis, Elaine R. 2008. <span>“Next-Generation <span>DNA</span> Sequencing Methods.”</span> ''Annual Review of Genomics and Human Genetics'' 9 (1): 387–402. https://doi.org/10.1146/annurev.genom.9.081307.164359.

</div>
<div id="ref-Mayer2014" class="csl-entry" role="doc-biblioentry">

Mayer, Klaus F. X., Jane Rogers, Jaroslav Doležel, Curtis Pozniak, Kellye Eversole, Catherine Feuillet, Bikram Gill, et al. 2014. <span>“A Chromosome-Based Draft Sequence of the Hexaploid Bread Wheat (Triticum Aestivum) Genome.”</span> ''Science'' 345 (6194): 1251788–88. https://doi.org/10.1126/science.1251788.

</div>
<div id="ref-McGibbon2021" class="csl-entry" role="doc-biblioentry">

McGibbon, Robert T. et al. 2021. <span>“Quadprog: Quadratic Programming Solver (Python) V0.1.10.”</span> October 1, 2021. https://github.com/quadprog/quadprog.

</div>
<div id="ref-Mihaescu2007" class="csl-entry" role="doc-biblioentry">

Mihaescu, Radu, Dan Levy, and Lior Pachter. 2007. <span>“Why Neighbor-Joining Works.”</span> ''Algorithmica'' 54 (1): 1–24. https://doi.org/10.1007/s00453-007-9116-4.

</div>
<div id="ref-Miles2021" class="csl-entry" role="doc-biblioentry">

Miles, Alistair, Jakirkham, Matthias Bussonnier, Josh Moore, Andrew Fulton, James Bourbeau, Tarik Onalan, et al. 2021. <span>“Zarr-Developers/Zarr-Python: V2.10.2.”</span> Zenodo. https://doi.org/10.5281/ZENODO.5579625.

</div>
<div id="ref-Miller2015" class="csl-entry" role="doc-biblioentry">

Miller, Neil A., Emily G. Farrow, Margaret Gibson, Laurel K. Willig, Greyson Twist, Byunggil Yoo, Tyler Marrs, et al. 2015. <span>“A 26-Hour System of Highly Sensitive Whole Genome Sequencing for Emergency Management of Genetic Diseases.”</span> ''Genome Medicine'' 7 (1). https://doi.org/10.1186/s13073-015-0221-8.

</div>
<div id="ref-Miura2018" class="csl-entry" role="doc-biblioentry">

Miura, Sayaka, Karen Gomez, Oscar Murillo, Louise A Huuki, Tracy Vu, Tiffany Buturla, and Sudhir Kumar. 2018. <span>“Predicting Clone Genotypes from Tumor Bulk Sequencing of Multiple Samples.”</span> Edited by John Hancock, June. https://doi.org/10.1093/bioinformatics/bty469.

</div>
<div id="ref-Miura2020" class="csl-entry" role="doc-biblioentry">

Miura, Sayaka, Tracy Vu, Jiamin Deng, Tiffany Buturla, Olumide Oladeinde, Jiyeong Choi, and Sudhir Kumar. 2020. <span>“Power and Pitfalls of Computational Methods for Inferring Clone Phylogenies and Mutation Orders from Bulk Sequencing Data.”</span> ''Scientific Reports'' 10 (1). https://doi.org/10.1038/s41598-020-59006-2.

</div>
<div id="ref-Molina2008" class="csl-entry" role="doc-biblioentry">

Molina, Julian R., Ping Yang, Stephen D. Cassivi, Steven E. Schild, and Alex A. Adjei. 2008. <span>“Non-Small Cell Lung Cancer: Epidemiology, Risk Factors, Treatment, and Survivorship.”</span> ''Mayo Clinic Proceedings'' 83 (5): 584–94. https://doi.org/10.4065/83.5.584.

</div>
<div id="ref-Moore2021" class="csl-entry" role="doc-biblioentry">

Moore, Luiza, Alex Cagan, Tim H. H. Coorens, Matthew D. C. Neville, Rashesh Sanghvi, Mathijs A. Sanders, Thomas R. W. Oliver, et al. 2021. <span>“The Mutational Landscape of Human Somatic and Germline Cells.”</span> ''Nature'', August. https://doi.org/10.1038/s41586-021-03822-7.

</div>
<div id="ref-Mueller1838" class="csl-entry" role="doc-biblioentry">

Müller, Johannes. 1838. ''Über Den Feinern Bau Und Die Formen Der Krankhaften Geschwülste : In Zwei Lieferungen''. Reimer. https://echo.mpiwg-berlin.mpg.de/ECHOdocuView?url=/permanent/library/84U9MMK0/pageimg&start=61&mode=imagepath&pn=66.

</div>
<div id="ref-Miles2021a" class="csl-entry" role="doc-biblioentry">

Murillo R.; Peter Ralph; Nick Harding; Rahul Pisupati; Summer Rae; Tim Millar, Alistair Miles; pyup.io bot; 2021. <span>“Scikit-Allel: A Python Package for Exploring and Analysing Genetic Variation Data.”</span> Zenodo. https://doi.org/10.5281/zenodo.4759368.

</div>
<div id="ref-Nicolaides2013" class="csl-entry" role="doc-biblioentry">

Nicolaides, Kypros H., Argyro Syngelaki, Ghalia Ashoor, Cahit Birdir, and Gisele Touzet. 2013. <span>“Noninvasive Prenatal Testing for Fetal Trisomies in a Routinely Screened First-Trimester Population.”</span> ''Obstetrical &amp; Gynecological Survey'' 68 (3): 173–75. https://doi.org/10.1097/ogx.0b013e318285bf66.

</div>
<div id="ref-Noorbakhsh2018" class="csl-entry" role="doc-biblioentry">

Noorbakhsh, Javad, Hyunsoo Kim, Sandeep Namburi, and Jeffrey H. Chuang. 2018. <span>“Distribution-Based Measures of Tumor Heterogeneity Are Sensitive to Mutation Calling and Lack Strong Clinical Predictive Power.”</span> ''Scientific Reports'' 8 (1). https://doi.org/10.1038/s41598-018-29154-7.

</div>
<div id="ref-Nooth1804" class="csl-entry" role="doc-biblioentry">

Nooth, James. 1804. ''Observations on the Treatment of Scirrhous Tumours, and Cancers of the Breast''. G.; J. Robinson.

</div>
<div id="ref-Ondov2016" class="csl-entry" role="doc-biblioentry">

Ondov, Brian D., Todd J. Treangen, Páll Melsted, Adam B. Mallonee, Nicholas H. Bergman, Sergey Koren, and Adam M. Phillippy. 2016. <span>“Mash: Fast Genome and Metagenome Distance Estimation Using <span>MinHash</span>.”</span> ''Genome Biology'' 17 (1). https://doi.org/10.1186/s13059-016-0997-x.

</div>
<div id="ref-OtextquotesingleNeil2017" class="csl-entry" role="doc-biblioentry">

ONeil, Nigel J., Melanie L. Bailey, and Philip Hieter. 2017. <span>“Synthetic Lethality and Cancer.”</span> ''Nature Reviews Genetics'' 18 (10): 613–23. https://doi.org/10.1038/nrg.2017.47.

</div>
<div id="ref-Otto2007" class="csl-entry" role="doc-biblioentry">

Otto, Sarah P. 2007. <span>“The Evolutionary Consequences of Polyploidy.”</span> ''Cell'' 131 (3): 452–62. https://doi.org/10.1016/j.cell.2007.10.022.

</div>
<div id="ref-Padmanabhan1974" class="csl-entry" role="doc-biblioentry">

Padmanabhan, R., E. Jay, and R. Wu. 1974. <span>“Chemical Synthesis of a Primer and Its Use in the Sequence Analysis of the Lysozyme Gene of Bacteriophage T4.”</span> ''Proceedings of the National Academy of Sciences'' 71 (6): 2510–14. https://doi.org/10.1073/pnas.71.6.2510.

</div>
<div id="ref-Pages2020" class="csl-entry" role="doc-biblioentry">

Pagès, H., P. Aboyoun, R. Gentleman, and S. DebRoy. 2020. ''Biostrings: Efficient Manipulation of Biological Strings''. https://bioconductor.org/packages/Biostrings.

</div>
<div id="ref-Pages2020a" class="csl-entry" role="doc-biblioentry">

Pagès, Hervé. 2020. ''BSgenome: Software Infrastructure for Efficient Representation of Full Genomes and Their SNPs''. https://bioconductor.org/packages/BSgenome.

</div>
<div id="ref-PHT1562" class="csl-entry" role="doc-biblioentry">

Paracelsus (Bombastus von Hohenheim TPA). 1562. <span>“De Grandibus, de Compositionibus, Et Dosibus Receptorum Ac Naturalium (Libri Septem.”</span>

</div>
<div id="ref-Patro2017" class="csl-entry" role="doc-biblioentry">

Patro, Rob, Geet Duggal, Michael I Love, Rafael A Irizarry, and Carl Kingsford. 2017. <span>“Salmon Provides Fast and Bias-Aware Quantification of Transcript Expression.”</span> ''Nature Methods'' 14 (4): 417–19. https://doi.org/10.1038/nmeth.4197.

</div>
<div id="ref-Payne2018" class="csl-entry" role="doc-biblioentry">

Payne, Alexander, Nadine Holmes, Vardhman Rakyan, and Matthew Loose. 2018. <span>“<span>BulkVis</span>: A Graphical Viewer for Oxford Nanopore Bulk <span>FAST</span>5 Files.”</span> Edited by Inanc Birol. ''Bioinformatics'' 35 (13): 2193–98. https://doi.org/10.1093/bioinformatics/bty841.

</div>
<div id="ref-Pilcher1895" class="csl-entry" role="doc-biblioentry">

Pilcher, J. E. 1895. <span>“[https://www.ncbi.nlm.nih.gov/pubmed/17860128 Guy de Chauliac and Henri de Mondeville,-a Surgical Retrospect.]”</span> ''Annals of Surgery'' 21 (January): 84–102.

</div>
<div id="ref-Poplin2018" class="csl-entry" role="doc-biblioentry">

Poplin, Ryan, Pi-Chuan Chang, David Alexander, Scott Schwartz, Thomas Colthurst, Alexander Ku, Dan Newburger, et al. 2018. <span>“A Universal <span>SNP</span> and Small-Indel Variant Caller Using Deep Neural Networks.”</span> ''Nature Biotechnology'' 36 (10): 983–87. https://doi.org/10.1038/nbt.4235.

</div>
<div id="ref-Poplin2017" class="csl-entry" role="doc-biblioentry">

Poplin, Ryan, Valentin Ruano-Rubio, Mark A. DePristo, Tim J. Fennell, Mauricio O. Carneiro, Geraldine A. Van der Auwera, David E. Kling, et al. 2017. <span>“Scaling Accurate Genetic Variant Discovery to Tens of Thousands of Samples.”</span> ''bioRxiv'', November. https://doi.org/10.1101/201178.

</div>
<div id="ref-Pratanwanich2021" class="csl-entry" role="doc-biblioentry">

Pratanwanich, Ploy N., Fei Yao, Ying Chen, Casslynn W. Q. Koh, Yuk Kei Wan, Christopher Hendra, Polly Poon, et al. 2021. <span>“Identification of Differential <span>RNA</span> Modifications from Nanopore Direct <span>RNA</span> Sequencing with <span class="nocase">xPore</span>.”</span> ''Nature Biotechnology'', July. https://doi.org/10.1038/s41587-021-00949-w.

</div>
<div id="ref-Roentgen1898" class="csl-entry" role="doc-biblioentry">

Röntgen, W. C. 1898. <span>“Ueber Eine Neue Art von Strahlen.”</span> ''Annalen Der Physik'' 300 (1): 12–17. https://doi.org/10.1002/andp.18983000103.

</div>
<div id="ref-Rosenthal2016" class="csl-entry" role="doc-biblioentry">

Rosenthal, Rachel. 2016. ''deconstructSigs: Identifies Signatures Present in a Tumor Sample''. https://CRAN.R-project.org/package=deconstructSigs.

</div>
<div id="ref-Saitou1987" class="csl-entry" role="doc-biblioentry">

Saitou, N, and M Nei. 1987. <span>“The Neighbor-Joining Method: A New Method for Reconstructing Phylogenetic Trees.”</span> ''Molecular Biology and Evolution'', July. https://doi.org/10.1093/oxfordjournals.molbev.a040454.

</div>
<div id="ref-Sanger1975" class="csl-entry" role="doc-biblioentry">

Sanger, F., and A. R. Coulson. 1975. <span>“A Rapid Method for Determining Sequences in <span>DNA</span> by Primed Synthesis with <span>DNA</span> Polymerase.”</span> ''Journal of Molecular Biology'' 94 (3): 441–48. https://doi.org/10.1016/0022-2836(75)90213-2.

</div>
<div id="ref-Sanger1977" class="csl-entry" role="doc-biblioentry">

Sanger, F., S. Nicklen, and A. R. Coulson. 1977. <span>“<span>DNA</span> Sequencing with Chain-Terminating Inhibitors.”</span> ''Proceedings of the National Academy of Sciences'' 74 (12): 5463–67. https://doi.org/10.1073/pnas.74.12.5463.

</div>
<div id="ref-Saunders2012" class="csl-entry" role="doc-biblioentry">

Saunders, Christopher T., Wendy S. W. Wong, Sajani Swamy, Jennifer Becq, Lisa J. Murray, and R. Keira Cheetham. 2012. <span>“Strelka: Accurate Somatic Small-Variant Calling from Sequenced Tumor<span></span>normal Sample Pairs.”</span> ''Bioinformatics'' 28 (14): 1811–17. https://doi.org/10.1093/bioinformatics/bts271.

</div>
<div id="ref-Scheinin2014" class="csl-entry" role="doc-biblioentry">

Scheinin, Ilari, Daoud Sie, Henrik Bengtsson, Mark A van de Wiel, Adam B Olshen, Hinke F van Thuijl, Hendrik F van Essen, et al. 2014. <span>“DNA Copy Number Analysis of Fresh and Formalin-Fixed Specimens by Shallow Whole-Genome Sequencing with Identification and Exclusion of Problematic Regions in the Genome Assembly.”</span> ''Genome Research'' 24 (12): 2022–32. https://doi.org/10.1101/gr.175141.114.

</div>
<div id="ref-Schirmer2016" class="csl-entry" role="doc-biblioentry">

Schirmer, Melanie, Rosalinda D’Amore, Umer Z. Ijaz, Neil Hall, and Christopher Quince. 2016. <span>“Illumina Error Profiles: Resolving Fine-Scale Variation in Metagenomic Sequencing Data.”</span> ''<span>BMC</span> Bioinformatics'' 17 (1). https://doi.org/10.1186/s12859-016-0976-y.

</div>
<div id="ref-Schneider2017" class="csl-entry" role="doc-biblioentry">

Schneider, Valerie A., Tina Graves-Lindsay, Kerstin Howe, Nathan Bouk, Hsiu-Chuan Chen, Paul A. Kitts, Terence D. Murphy, et al. 2017. <span>“Evaluation of <span>GRCh</span>38 and de Novo Haploid Genome Assemblies Demonstrates the Enduring Quality of the Reference Assembly.”</span> ''Genome Research'' 27 (5): 849–64. https://doi.org/10.1101/gr.213611.116.

</div>
<div id="ref-Scholtz1902" class="csl-entry" role="doc-biblioentry">

Scholtz, W. 1902. <span>“Ueber Den Einfluss Der r<span>ö</span>ntgenstrahlen Auf Die Haut in Gesundem Und Krankem Zustande.”</span> ''Archiv f<span>ü</span>r Dermatologie Und Syphilis'' 59 (3): 421–46.

</div>
<div id="ref-Schwarzenbach2011" class="csl-entry" role="doc-biblioentry">

Schwarzenbach, Heidi, Dave S. B. Hoon, and Klaus Pantel. 2011. <span>“Cell-Free Nucleic Acids as Biomarkers in Cancer Patients.”</span> ''Nature Reviews Cancer'' 11 (6): 426–37. https://doi.org/10.1038/nrc3066.

</div>
<div id="ref-Severino1632" class="csl-entry" role="doc-biblioentry">

Severino, Marco Aurelio 1580-1656. 1632. ''De Recondita Abscessuum Natura Libri VII''. Apud Octavium Beltranum.

</div>
<div id="ref-Shamseldin2015" class="csl-entry" role="doc-biblioentry">

Shamseldin, Hanan E., Maha Tulbah, Wesam Kurdi, Maha Nemer, Nada Alsahan, Elham Al Mardawi, Ola Khalifa, et al. 2015. <span>“Identification of Embryonic Lethal Genes in Humans by Autozygosity Mapping and Exome Sequencing in Consanguineous Families.”</span> ''Genome Biology'' 16 (1). https://doi.org/10.1186/s13059-015-0681-6.

</div>
<div id="ref-Shibata2010" class="csl-entry" role="doc-biblioentry">

Shibata, D. 2010. <span>“Mutation and Epigenetic Molecular Clocks in Cancer.”</span> ''Carcinogenesis'' 32 (2): 123–28. https://doi.org/10.1093/carcin/bgq239.

</div>
<div id="ref-Siegel2018" class="csl-entry" role="doc-biblioentry">

Siegel, Rebecca L., Kimberly D. Miller, and Ahmedin Jemal. 2018. <span>“Cancer Statistics, 2018.”</span> ''<span>CA</span>: A Cancer Journal for Clinicians'' 68 (1): 7–30. https://doi.org/10.3322/caac.21442.

</div>
<div id="ref-Sinden1994" class="csl-entry" role="doc-biblioentry">

Sinden, Richard R. 1994. <span>“Introduction to the Structure, Properties, and Reactions of <span>DNA</span>.”</span> In ''<span>DNA</span> Structure and Function'', 1–57. Elsevier. https://doi.org/10.1016/b978-0-08-057173-7.50006-7.

</div>
<div id="ref-Sokal1958" class="csl-entry" role="doc-biblioentry">

Sokal, Robert Reuven, and Charles Duncan Michener. 1958. ''A Statistical Method for Evaluating Systematic Relationships''. Vol. 38.2. University of Kansas Science Bulletin 22. University of Kansas.

</div>
<div id="ref-Solomon2020" class="csl-entry" role="doc-biblioentry">

Solomon, Benjamin J., Lavinia Tan, Jessica J. Lin, Stephen Q. Wong, Sebastian Hollizeck, Kevin Ebata, Brian B. Tuch, et al. 2020. <span>“<span>RET</span> Solvent Front Mutations Mediate Acquired Resistance to Selective <span>RET</span> Inhibition in <span>RET</span>-Driven Malignancies.”</span> ''Journal of Thoracic Oncology'' 15 (4): 541–49. https://doi.org/10.1016/j.jtho.2020.01.006.

</div>
<div id="ref-Sprouffske2018" class="csl-entry" role="doc-biblioentry">

Sprouffske, Kathleen, José Aguilar-Rodrı́guez, Paul Sniegowski, and Andreas Wagner. 2018. <span>“High Mutation Rates Limit Evolutionary Adaptation in Escherichia Coli.”</span> Edited by Ivan Matic. ''<span>PLOS</span> Genetics'' 14 (4): e1007324. https://doi.org/10.1371/journal.pgen.1007324.

</div>
<div id="ref-Stoler2021" class="csl-entry" role="doc-biblioentry">

Stoler, Nicholas, and Anton Nekrutenko. 2021. <span>“Sequencing Error Profiles of Illumina Sequencing Instruments.”</span> ''<span>NAR</span> Genomics and Bioinformatics'' 3 (1). https://doi.org/10.1093/nargab/lqab019.

</div>
<div id="ref-Stovner2019" class="csl-entry" role="doc-biblioentry">

Stovner, Endre Bakken, and Pål Sætrom. 2019. <span>“<span>PyRanges</span>: Efficient Comparison of Genomic Intervals in Python.”</span> Edited by John Hancock. ''Bioinformatics'', August. https://doi.org/10.1093/bioinformatics/btz615.

</div>
<div id="ref-Straiton2019" class="csl-entry" role="doc-biblioentry">

Straiton, Jenny, Tristan Free, Abigail Sawyer, and Joseph Martin. 2019. <span>“From Sanger Sequencing to Genome Databases and Beyond.”</span> ''<span>BioTechniques</span>'' 66 (2): 60–63. https://doi.org/10.2144/btn-2019-0011.

</div>
<div id="ref-Sun2007" class="csl-entry" role="doc-biblioentry">

Sun, Sophie, Joan H. Schiller, and Adi F. Gazdar. 2007. <span>“Lung Cancer in Never Smokers <span></span> a Different Disease.”</span> ''Nature Reviews Cancer'' 7 (10): 778–90. https://doi.org/10.1038/nrc2190.

</div>
<div id="ref-Tan2019" class="csl-entry" role="doc-biblioentry">

Tan, L., S. Sandhu, R. J. Lee, J. Li, J. Callahan, S. Ftouni, N. Dhomen, et al. 2019. <span>“Prediction and Monitoring of Relapse in Stage <span>III</span> Melanoma Using Circulating Tumor <span>DNA</span>.”</span> ''Annals of Oncology'' 30 (5): 804–14. https://doi.org/10.1093/annonc/mdz048.

</div>
<div id="ref-Tarabichi2021" class="csl-entry" role="doc-biblioentry">

Tarabichi, Maxime, Adriana Salcedo, Amit G. Deshwar, Máire Ni Leathlobhair, Jeff Wintersinger, David C. Wedge, Peter Van Loo, Quaid D. Morris, and Paul C. Boutros. 2021. <span>“A Practical Guide to Cancer Subclonal Reconstruction from DNA Sequencing.”</span> ''Nature Methods'' 18 (2, 2): 144–55. https://doi.org/10.1038/s41592-020-01013-2.

</div>
<div id="ref-Tate2018" class="csl-entry" role="doc-biblioentry">

Tate, John G, Sally Bamford, Harry C Jubb, Zbyslaw Sondka, David M Beare, Nidhi Bindal, Harry Boutselakis, et al. 2018. <span>“<span>COSMIC</span>: The Catalogue of Somatic Mutations in Cancer.”</span> ''Nucleic Acids Research'' 47 (D1): D941–47. https://doi.org/10.1093/nar/gky1015.

</div>
<div id="ref-Tateoka1975" class="csl-entry" role="doc-biblioentry">

Tateoka, Tuguo. 1975. <span>“A Contribution to the Taxonomy of <span class="nocase">theAgrostis</span> Mertensii-Flaccida Complex (Poaceae) in Japan.”</span> ''The Botanical Magazine Tokyo'' 88 (2): 65–87. https://doi.org/10.1007/bf02491243.

</div>
<div id="ref-TaylorWeiner2018" class="csl-entry" role="doc-biblioentry">

Taylor-Weiner, Amaro, Chip Stewart, Thomas Giordano, Mendy Miller, Mara Rosenberg, Alyssa Macbeth, Niall Lennon, et al. 2018. <span>“<span>DeTiN</span>: Overcoming Tumor-in-Normal Contamination.”</span> ''Nature Methods'' 15 (7): 531–34. https://doi.org/10.1038/s41592-018-0036-9.

</div>
<div id="ref-Temin1970" class="csl-entry" role="doc-biblioentry">

Temin, Howard M, S Mizutami, et al. 1970. <span>“RNA-Dependent DNA Polymerase in Virions of Rous Sarcoma Virus.”</span> ''Cold Spring Harbor Symposia on Quantitative Biology'' 226 (0): 1211–13. https://doi.org/10.1101/sqb.1970.035.01.100.

</div>
<div id="ref-Toptas2018" class="csl-entry" role="doc-biblioentry">

Toptaş, Berke Ç, Goran Rakocevic, Péter Kómár, and Deniz Kural. 2018. <span>“Comparing Complex Variants in Family Trios.”</span> Edited by Oliver Stegle. ''Bioinformatics'', June. https://doi.org/10.1093/bioinformatics/bty443.

</div>
<div id="ref-Trivers1976" class="csl-entry" role="doc-biblioentry">

Trivers, R., and H Hare. 1976. <span>“Haploidploidy and the Evolution of the Social Insect.”</span> ''Science'' 191 (4224): 249–63. https://doi.org/10.1126/science.1108197.

</div>
<div id="ref-Tulpii1652" class="csl-entry" role="doc-biblioentry">

Tulpii, Nicolai. 1652. ''Observationes Medicae''. Amstelredami.

</div>
<div id="ref-Veeneman2015" class="csl-entry" role="doc-biblioentry">

Veeneman, Brendan A., Sudhanshu Shukla, Saravana M. Dhanasekaran, Arul M. Chinnaiyan, and Alexey I. Nesvizhskii. 2015. <span>“Two-Pass Alignment Improves Novel Splice Junction Quantification.”</span> ''Bioinformatics'' 32 (October): 43–49. https://doi.org/10.1093/bioinformatics/btv642.

</div>
<div id="ref-Venter2001" class="csl-entry" role="doc-biblioentry">

Venter, J. Craig, Mark D. Adams, Eugene W. Myers, Peter W. Li, Richard J. Mural, Granger G. Sutton, Hamilton O. Smith, et al. 2001. <span>“The Sequence of the Human Genome.”</span> ''Science'' 291 (5507): 1304–51. https://doi.org/10.1126/science.1058040.

</div>
<div id="ref-Vergara2021" class="csl-entry" role="doc-biblioentry">

Vergara, Ismael A., Christopher P. Mintoff, Shahneen Sandhu, Lachlan McIntosh, Richard J. Young, Stephen Q. Wong, Andrew Colebatch, et al. 2021. <span>“Evolution of Late-Stage Metastatic Melanoma Is Dominated by Aneuploidy and Whole Genome Doubling.”</span> ''Nature Communications'' 12 (1). https://doi.org/10.1038/s41467-021-21576-8.

</div>
<div id="ref-Vienne2018" class="csl-entry" role="doc-biblioentry">

Vienne, Damien M de. 2018. <span>“Tanglegrams Are Misleading for Visual Evaluation of Tree Congruence.”</span> Edited by Jeffrey Townsend 36 (1): 174–76. https://doi.org/10.1093/molbev/msy196.

</div>
<div id="ref-Virchow1863" class="csl-entry" role="doc-biblioentry">

Virchow, Rudolf ludwig Carl10.1002/andp.18983000103. 1863. ''Die Krankhaften Geschwülste: Dreissig Vorlesungen, Gehalten Während Des Wintersemesters 1862-1863 an Der Universität Zu Berlin''. 3 vols. Berlin: Verlag von August Hirschwald. http://resource.nlm.nih.gov/62231840R.

</div>
<div id="ref-Wang2018" class="csl-entry" role="doc-biblioentry">

Wang, Di, Xiaohui Niu, Zhijie Wang, Cheng-Li Song, Zhen Huang, Ke-Neng Chen, Jianchun Duan, et al. 2018. <span>“Multiregion Sequencing Reveals the Genetic Heterogeneity and Evolutionary History of Osteosarcoma and Matched Pulmonary Metastases.”</span> ''Cancer Research'' 79 (1): 7–20. https://doi.org/10.1158/0008-5472.can-18-1086.

</div>
<div id="ref-Warburg1928" class="csl-entry" role="doc-biblioentry">

Warburg, Otto. 1928. <span>“Photochemie Der Eisencarbonylverbindungen Und Das Absolute Absorptionsspektrum Des Atmungsferments.”</span> ''Naturwissenschaften'' 16 (45-47): 856–61.

</div>
<div id="ref-Watson1953" class="csl-entry" role="doc-biblioentry">

Watson, J. D., and F. H. C. Crick. 1953. <span>“Molecular Structure of Nucleic Acids: A Structure for Deoxyribose Nucleic Acid.”</span> ''Nature'' 171 (4356): 737–38. https://doi.org/10.1038/171737a0.

</div>
<div id="ref-WSI2021" class="csl-entry" role="doc-biblioentry">

Wellcome Sanger Institute. 2021. <span>“COSMIC Database V95.”</span> November 14, 2021. https://cancer.sanger.ac.uk/.

</div>
<div id="ref-Werner2020" class="csl-entry" role="doc-biblioentry">

Werner, Benjamin, Jack Case, Marc J. Williams, Ketevan Chkhaidze, Daniel Temko, Javier Fernández-Mateos, George D. Cresswell, et al. 2020. <span>“Measuring Single Cell Divisions in Human Tissues from Multi-Region Sequencing Data.”</span> ''Nature Communications'' 11 (1). https://doi.org/10.1038/s41467-020-14844-6.

</div>
<div id="ref-Zuckerkandl1962" class="csl-entry" role="doc-biblioentry">

Zuckerkandl, Emile, and Linus Pauling. 1962. <span>“Molecular Disease, Evolution, and Genic Heterogeneity.”</span> ''Horizons in Biochemistry'', 189--225.

</div>

</div>
<div class="section footnotes footnotes-end-of-document" role="doc-endnotes">


-----

<ol>
<li><div id="fn1">

<p>Maybe surprising to hear, that he was strongly opposed to Darwin’s theory of evolution. In his own words: “The intermediate form is unimaginable save in a dream... We cannot teach or consent that it is an achievement that man descended from the ape or other animal.“[[#fnref1|↩︎]]</p>

</div></li>
<li><div id="fn2">

<p>however nanopore is not really usefull due to the short fragments naturally occurring in cfDNA[[#fnref2|↩︎]]</p>

</div></li></ol>


</div>
